<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="无心是一首歌" type="application/atom+xml" />






<meta name="description" content="大数据|动漫迷|科技控">
<meta property="og:type" content="website">
<meta property="og:title" content="无心是一首歌">
<meta property="og:url" content="http://erichunn.github.io/page/3/index.html">
<meta property="og:site_name" content="无心是一首歌">
<meta property="og:description" content="大数据|动漫迷|科技控">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="无心是一首歌">
<meta name="twitter:description" content="大数据|动漫迷|科技控">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: 'undefined',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://erichunn.github.io/page/3/"/>





  <title>无心是一首歌</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?02fe19ac065353167cab1b453f2909ec";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">无心是一首歌</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-首页">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-关于我">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于我
          </a>
        </li>
      
        
        <li class="menu-item menu-item-标签">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-分类">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-归档">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-站点地图">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-腾讯公益">
          <a href="/404/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            腾讯公益
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2018/12/10/Java视频中的面试题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/10/Java视频中的面试题/" itemprop="url">Java视频中的面试题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-12-10T23:53:38+08:00">
                2018-12-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="集合中的面试题"><a href="#集合中的面试题" class="headerlink" title="集合中的面试题"></a>集合中的面试题</h1><h2 id="ArrayList和LinkList的区别"><a href="#ArrayList和LinkList的区别" class="headerlink" title="ArrayList和LinkList的区别"></a>ArrayList和LinkList的区别</h2><p>1、ArrayList和LinkedList可想从名字分析，它们一个是Array(动态数组)的数据结构，一个是Link(链表)的数据结构，此外，它们两个都是对List接口的实现。</p>
<p>前者是数组队列，相当于动态数组；后者为双向链表结构，也可当作堆栈、队列、双端队列</p>
<p>2、当随机访问List时（get和set操作），ArrayList比LinkedList的效率更高，因为LinkedList是线性的数据存储方式，所以需要移动指针从前往后依次查找。</p>
<p>3、当对数据进行增加和删除的操作时(add和remove操作)，LinkedList比ArrayList的效率更高，因为ArrayList是数组，所以在其中进行增删操作时，会对操作点之后所有数据的下标索引造成影响，需要进行数据的移动。</p>
<p>4、从利用效率来看，ArrayList自由性较低，因为它需要手动的设置固定大小的容量，但是它的使用比较方便，只需要创建，然后添加数据，通过调用下标进行使用；而LinkedList自由性较高，能够动态的随数据量的变化而变化，但是它不便于使用。</p>
<p>5、ArrayList主要控件开销在于需要在lList列表预留一定空间；而LinkList主要控件开销在于需要存储结点信息以及结点指针信息。</p>
<h2 id="Java对象的创建过程"><a href="#Java对象的创建过程" class="headerlink" title="Java对象的创建过程"></a>Java对象的创建过程</h2><p>从new指令(我说的是JVM的层面)开始的(具体请看图1)，JVM首先对<strong>符号引用进行解析</strong>，如果找不到对应的符号引用，那么这个类还没有被加载，因此JVM便会进行<strong>类加载过程</strong>（具体加载过程可参见我的另一篇博文）。符号引用解析完毕之后，JVM会为对象在堆中<strong>分配内存</strong>，HotSpot虚拟机实现的JAVA对象包括三个部分：<strong>对象头、实例字段和对齐填充字段</strong>，其中要注意的是，实例字段包括自身定义的和从父类继承下来的（即使父类的实例字段被子类覆盖或者被private修饰，都照样为其分配内存）。相信很多人在刚接触面向对象语言时，总把继承看成简单的“复制”，这其实是完全错误的。JAVA中的继承仅仅是类之间的一种逻辑关系（具体如何保存记录这种逻辑关系，则设计到Class文件格式的知识，具体请看我的另一篇博文），唯有创建对象时的实例字段，可以简单的看成“复制”。</p>
<p>为对象分配完堆内存之后，JVM会将该内存（除了对象头区域）进行<strong>零值初始化</strong>，这也就解释了为什么JAVA的属性字段无需显示初始化就可以被使用，而方法的局部变量却必须要显示初始化后才可以访问。最后，JVM会<strong>调用对象的构造函数</strong>，当然，调用顺序会一直上溯到Object类。</p>
<p>至此，一个对象就被创建完毕，此时，一般会有一个引用指向这个对象。在JAVA中，存在两种数据类型，一种就是诸如int、double等基本类型，另一种就是引用类型，比如类、接口、内部类、枚举类、数组类型的引用等。引用的实现方式一般有两种，具体请看图3。</p>
<p><img src="https://i.imgur.com/MT1d3Sd.png" alt=""></p>
<p><img src="https://i.imgur.com/3hstOCV.png" alt=""></p>
<p><img src="https://i.imgur.com/wvA2E0S.png" alt=""></p>
<p><img src="https://i.imgur.com/1ptUYtl.png" alt=""></p>
<h2 id="接口类和抽象类"><a href="#接口类和抽象类" class="headerlink" title="接口类和抽象类"></a>接口类和抽象类</h2><h3 id="抽象类"><a href="#抽象类" class="headerlink" title="抽象类"></a>抽象类</h3><p>在了解抽象类之前，先来了解一下抽象方法。抽象方法是一种特殊的方法：它只有声明，而没有具体的实现。抽象方法的声明格式为：</p>
<pre><code>abstract void fun();
</code></pre><p>抽象方法必须用abstract关键字进行修饰。如果一个类含有抽象方法，则称这个类为抽象类，抽象类必须在类前用abstract关键字修饰。<strong>因为抽象类中含有无具体实现的方法，所以不能用抽象类创建对象</strong>。</p>
<p>下面要注意一个问题：在《JAVA编程思想》一书中，将抽象类定义为“包含抽象方法的类”，但是后面发现如果一个类不包含抽象方法，只是用abstract修饰的话也是抽象类。也就是说抽象类不一定必须含有抽象方法。个人觉得这个属于钻牛角尖的问题吧，因为如果一个抽象类不包含任何抽象方法，为何还要设计为抽象类？所以暂且记住这个概念吧，不必去深究为什么。</p>
<pre><code>[public] abstract class ClassName {
    abstract void fun();
    }
</code></pre><p>从这里可以看出，抽象类就是为了继承而存在的，如果你定义了一个抽象类，却不去继承它，那么等于白白创建了这个抽象类，因为你不能用它来做任何事情。对于一个父类，如果它的某个方法在父类中实现出来没有任何意义，必须根据子类的实际需求来进行不同的实现，那么就可以将这个方法声明为abstract方法，此时这个类也就成为abstract类了。</p>
<p>包含抽象方法的类称为抽象类，但并不意味着抽象类中只能有抽象方法，它和普通类一样，同样可以拥有成员变量和普通的成员方法。注意，<strong>抽象类和普通类的主要有三点区别</strong>：</p>
<p>　　1）抽象方法必须为public或者protected（因为如果为private，则不能被子类继承，子类便无法实现该方法），缺省情况下默认为public。</p>
<p>　　2）抽象类不能用来创建对象；</p>
<p>　　3）如果一个类继承于一个抽象类，则子类必须实现父类的抽象方法。如果子类没有实现父类的抽象方法，则必须将子类也定义为为abstract类。</p>
<p>在其他方面，抽象类和普通的类并没有区别。</p>
<h3 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h3><p>接口，英文称作interface，在软件工程中，接口泛指供别人调用的方法或者函数。从这里，我们可以体会到Java语言设计者的初衷，它是对行为的抽象。在Java中，定一个接口的形式如下：</p>
<pre><code>[public] interface InterfaceName {
}
</code></pre><p><strong>接口中可以含有 变量和方法</strong>。但是要注意，接口中的<strong>变量会被隐式地指定为public static final变量</strong>（并且只能是public static final变量，用private修饰会报编译错误），而方法会被隐式地指定为public abstract方法且只能是public abstract方法（用其他关键字，比如private、protected、static、 final等修饰会报编译错误），并且<strong>接口中所有的方法不能有具体的实现，也就是说，接口中的方法必须都是抽象方法</strong>。从这里可以隐约看出接口和抽象类的区别，接口是一种极度抽象的类型，它比抽象类更加“抽象”，并且一般情况下不在接口中定义变量。</p>
<p>要让一个类遵循某组特地的接口需要使用implements关键字，具体格式如下：</p>
<pre><code>class ClassName implements Interface1,Interface2,[....]{
}
</code></pre><p>可以看出，允许一个类遵循多个特定的接口。如果一个<strong>非抽象类遵循了某个接口，就必须实现该接口中的所有方法</strong>。对于遵循某个接口的抽象类，可以不实现该接口中的抽象方法。</p>
<h3 id="抽象类和接口的区别"><a href="#抽象类和接口的区别" class="headerlink" title="抽象类和接口的区别"></a>抽象类和接口的区别</h3><p>1.语法层面上的区别</p>
<p>　　1）抽象类可以提供成员方法的实现细节，而接口中只能存在public abstract 方法；</p>
<p>　　2）抽象类中的成员变量可以是各种类型的，而接口中的成员变量只能是public static final类型的；</p>
<p>　　3）接口中不能含有静态代码块以及静态方法，而抽象类可以有静态代码块和静态方法；</p>
<p>　　4）一个类只能继承一个抽象类，而一个类却可以实现多个接口。</p>
<p>2.设计层面上的区别</p>
<p>1）<strong>抽象类是对一种事物的抽象，即对类抽象，而接口是对行为的抽象。抽象类是对整个类整体进行抽象，包括属性、行为，但是接口却是对类局部（行为）进行抽象</strong>。举个简单的例子，飞机和鸟是不同类的事物，但是它们都有一个共性，就是都会飞。那么在设计的时候，可以将飞机设计为一个类Airplane，将鸟设计为一个类Bird，但是不能将 飞行 这个特性也设计为类，因此它只是一个行为特性，并不是对一类事物的抽象描述。此时可以将 飞行 设计为一个接口Fly，包含方法fly( )，然后Airplane和Bird分别根据自己的需要实现Fly这个接口。然后至于有不同种类的飞机，比如战斗机、民用飞机等直接继承Airplane即可，对于鸟也是类似的，不同种类的鸟直接继承Bird类即可。从这里可以看出，继承是一个 “是不是”的关系，而 接口 实现则是 “有没有”的关系。如果一个类继承了某个抽象类，则子类必定是抽象类的种类，而接口实现则是有没有、具备不具备的关系，比如鸟是否能飞（或者是否具备飞行这个特点），能飞行则可以实现这个接口，不能飞行就不实现这个接口。</p>
<p>2）<strong>设计层面不同，抽象类作为很多子类的父类，它是一种模板式设计。而接口是一种行为规范，它是一种辐射式设计</strong>。什么是模板式设计？最简单例子，大家都用过ppt里面的模板，如果用模板A设计了ppt B和ppt C，ppt B和ppt C公共的部分就是模板A了，如果它们的公共部分需要改动，则只需要改动模板A就可以了，不需要重新对ppt B和ppt C进行改动。而辐射式设计，比如某个电梯都装了某种报警器，一旦要更新报警器，就必须全部更新。也就是说对于抽象类，如果需要添加新的方法，可以直接在抽象类中添加具体的实现，子类可以不进行变更；而对于接口则不行，如果接口进行了变更，则所有实现这个接口的类都必须进行相应的改动。</p>
<p>　　下面看一个网上流传最广泛的例子：门和警报的例子：门都有open( )和close( )两个动作，此时我们可以定义通过抽象类和接口来定义这个抽象概念：</p>
<pre><code>abstract class Door {
    public abstract void open();
    public abstract void close();
}
</code></pre><p>或者：</p>
<pre><code>interface Door {
    public abstract void open();
    public abstract void close();
}
</code></pre><p>　　但是现在如果我们需要门具有报警alarm( )的功能，那么该如何实现？下面提供两种思路：</p>
<p>　　1）将这三个功能都放在抽象类里面，但是这样一来所有继承于这个抽象类的子类都具备了报警功能，但是有的门并不一定具备报警功能；</p>
<p>　　2）将这三个功能都放在接口里面，需要用到报警功能的类就需要实现这个接口中的open( )和close( )，也许这个类根本就不具备open( )和close( )这两个功能，比如火灾报警器。</p>
<p>　　从这里可以看出， Door的open() 、close()和alarm()根本就属于两个不同范畴内的行为，open()和close()属于门本身固有的行为特性，而alarm()属于延伸的附加行为。因此最好的解决办法是单独将报警设计为一个接口，包含alarm()行为,Door设计为单独的一个抽象类，包含open和close两种行为。再设计一个报警门继承Door类和实现Alarm接口。</p>
<pre><code>interface Alram {
    void alarm();
        }

abstract class Door {
        void open();
        void close();
        }

class AlarmDoor extends Door implements Alarm {
        void oepn() {
          //....
        }
    void close() {
          //....
        }
    void alarm() {
          //....
        }
}
</code></pre><h2 id="重写和重载的区别"><a href="#重写和重载的区别" class="headerlink" title="重写和重载的区别"></a>重写和重载的区别</h2><h3 id="1-重写-Override"><a href="#1-重写-Override" class="headerlink" title="1.重写(Override)"></a>1.重写(Override)</h3><p>从字面上看，重写就是 重新写一遍的意思。其实就是在子类中把父类本身有的方法重新写一遍。子类继承了父类原有的方法，但有时子类并不想原封不动的继承父类中的某个方法，所以在方法名，参数列表，返回类型(除过子类中方法的返回值是父类中方法返回值的子类时)都相同的情况下， 对方法体进行修改或重写，这就是重写。但要注意子类函数的访问修饰权限不能少于父类的。<br>例如：</p>
<pre><code>public class Father {

    public static void main(String[] args) {
        // TODO Auto-generated method stub
        Son s = new Son();
        s.sayHello();
    }

    public void sayHello() {
        System.out.println(&quot;Hello&quot;);
    }
}

class Son extends Father{

    @Override
    public void sayHello() {
        // TODO Auto-generated method stub
        System.out.println(&quot;hello by &quot;);
    }

}
</code></pre><p><strong>重写 总结：</strong><br>1.发生在父类与子类之间 </p>
<p>2.方法名，参数列表，返回类型（除过子类中方法的返回类型是父类中返回类型的子类）必须相同 </p>
<p>3.访问修饰符的限制一定要大于被重写方法的访问修饰符（public&gt;protected&gt;default&gt;private) </p>
<p>4.重写方法一定不能抛出新的检查异常或者比被重写方法申明更加宽泛的检查型异常</p>
<h3 id="2-重载-Overload"><a href="#2-重载-Overload" class="headerlink" title="2.重载(Overload)"></a>2.重载(Overload)</h3><p>在一个类中，同名的方法如果有不同的参数列表（参数类型不同、参数个数不同甚至是参数顺序不同）则视为重载。同时，重载对返回类型没有要求，可以相同也可以不同，但不能通过返回类型是否相同来判断重载。<br>例如：</p>
<pre><code>public class Father {

public static void main(String[] args) {
    // TODO Auto-generated method stub
    Father s = new Father();
    s.sayHello();
    s.sayHello(&quot;wintershii&quot;);

    }    

public void sayHello() {
    System.out.println(&quot;Hello&quot;);
    }

public void sayHello(String name) {
    System.out.println(&quot;Hello&quot; + &quot; &quot; + name);
    }
}
</code></pre><p><strong>重载 总结：</strong><br>1.重载Overload是一个类中多态性的一种表现<br>2.重载要求同名方法的参数列表不同(参数类型，参数个数甚至是参数顺序)<br>3.重载的时候，返回值类型可以相同也可以不相同。无法以返回型别作为重载函数的区分标准</p>
<h2 id="面试时，问：重载（Overload）和重写（Override）的区别？-（这部分吴锦峰大数据数讲解好）"><a href="#面试时，问：重载（Overload）和重写（Override）的区别？-（这部分吴锦峰大数据数讲解好）" class="headerlink" title="面试时，问：重载（Overload）和重写（Override）的区别？ （这部分吴锦峰大数据数讲解好）"></a>面试时，问：重载（Overload）和重写（Override）的区别？ （这部分吴锦峰大数据数讲解好）</h2><p>答：方法的重载和重写都是实现多态的方式，区别在于前者实现的是编译时的多态性，而后者实现的是运行时的多态性。</p>
<p>重载发生在一个类中，同名的方法如果有不同的参数列表（参数类型不同、参数个数不同或者二者都不同）则视为重载；重写发生在子类与父类之间，重写要求子类被重写方法与父类被重写方法有相同的参数列表，有兼容的返回类型，比父类被重写方法更好访问，不能比父类被重写方法声明更多的异常（里氏代换原则）。重载对返回类型没有特殊的要求，不能根据返回类型进行区分。</p>
<h2 id="为什么要使用内部类？"><a href="#为什么要使用内部类？" class="headerlink" title="为什么要使用内部类？"></a>为什么要使用内部类？</h2><h2 id="HashMap与HashSet的区别"><a href="#HashMap与HashSet的区别" class="headerlink" title="HashMap与HashSet的区别"></a>HashMap与HashSet的区别</h2><p>　　先了解一下HashMap跟HashSet</p>
<p> HashSet：</p>
<p>HashSet实现了Set接口，它不允许集合中出现重复元素。当我们提到HashSet时，第一件事就是在将对象存储在</p>
<p>HashSet之前，要确保重写hashCode（）方法和equals（）方法，这样才能比较对象的值是否相等，确保集合中没有</p>
<p>储存相同的对象。如果不重写上述两个方法，那么将使用下面方法默认实现：</p>
<p>　public boolean add(Object obj)方法用在Set添加元素时，如果元素值重复时返回 “false”，如果添加成功则返回”true”</p>
<p>HashMap：</p>
<p>　　HashMap实现了Map接口，Map接口对键值对进行映射。Map中不允许出现重复的键（Key）。Map接口有两个基本的实现</p>
<p>TreeMap和HashMap。TreeMap保存了对象的排列次序，而HashMap不能。HashMap可以有空的键值对（Key（null）-Value（null））</p>
<p>HashMap是非线程安全的（非Synchronize），要想实现线程安全，那么需要调用collections类的静态方法synchronizeMap（）实现。</p>
<p>public Object put(Object Key,Object value)方法用来将元素添加到map中。</p>
<p>HashSet与HashMap的区别：</p>
<p><img src="https://i.imgur.com/ufx3vZv.png" alt=""></p>
<h2 id="一个字节的数据大小范围为什么是-128-127"><a href="#一个字节的数据大小范围为什么是-128-127" class="headerlink" title="一个字节的数据大小范围为什么是-128~127"></a>一个字节的数据大小范围为什么是-128~127</h2><p>一个字节是8位，最高位是符号位，最高位为0则是正数。最高位为1则是负数</p>
<p>如果一个数是正数，最大数则为：01111111，转为十进制为127，</p>
<p>如果一个数是负数，按照一般人都会觉得是11111111，转为十进制为-127，</p>
<p>但是：一个+0表示为：00000000，一个-0表示为：1000000，因为符号位不算在里面，所以就会有两个0，所以从一开始发明二进制的时候，就把-0规定为-128，如此二进制的补码就刚好在计算机中运作中吻合。</p>
<p>公式：计算一个数据类型的数据大小范围：-2^（字节数<em>8-1）~2^(字节数</em>8-1)-1</p>
<h2 id="异或运算符"><a href="#异或运算符" class="headerlink" title="异或运算符"></a>异或运算符</h2><p>异或运算符（^）</p>
<p>参加运算的两个数据，按二进制位进行“异或”运算。</p>
<p>运算规则：0^0=0；  0^1=1；  1^0=1；   1^1=0；</p>
<p>   即：参加运算的两个对象，如果两个相应位为“异”（值不同），则该位结果为1，否则为0。</p>
<h2 id="关于Treeset和Treemap"><a href="#关于Treeset和Treemap" class="headerlink" title="关于Treeset和Treemap:"></a>关于Treeset和Treemap:</h2><p>这两个方法其实是通过二叉树进行比较的，也就是说通过二叉树来存储，时间复杂度为0(logn)</p>
<p>二叉树是小的放在左边，打的放在右边子叶</p>
<p>然后，每次添加的时候都要通过一个一个比较大小来进行选择添加的位置。那么这时候，就出现一个问题，怎么比较大小</p>
<p>正常情况下如果泛型是Integer的时候Integer实现了Comparable方法，所以在添加的时候就可以通过自带的比较直接比较添加。但是如果泛型是其他自定义的类的时候就需要重写compare方法。</p>
<p>treeset和treeset就像hashmap和hashset是一个道理的。都是本质上是一样的。treeset也是通过通过treemap的键值对里面的其中一个存放present一个垃圾值来计算的</p>
<p>在实现Comparator的时候本来要重写2个方法一个是equlas一个是compare方法，但是由于Comparator的父类是Object已经给重写好了，所以只需要重写Compar的方法即可</p>
<pre><code>public void testAddDog(){
    Set&lt;Dog&gt; set = new Treeeset&lt;Dog&gt;(new DogComparator());
    set.add(new Dog(&quot;大黄“));
}
//需要重写的对比器
Class DogComparator implements Comparator&lt;Dog&gt;{
......
}
Class Dog{
    private Sring name;
    publi void DOg(String name){
    super;
    this.name =name}
}
</code></pre><h2 id="关于hashmap和hashset"><a href="#关于hashmap和hashset" class="headerlink" title="关于hashmap和hashset"></a>关于hashmap和hashset</h2><p>hashmap和hashset都采用hash方法来添加内容里面的结构是桶+链表的形式，桶类似于arraylist是内存连续的。</p>
<p>put方法的流程，拿到E之后先做一个判断判断e在不在这个桶里面，看下桶是不是空的，如果是空的直接放里面，如果是空的，还需要判断是不是跟桶里面的元素相等。</p>
<p>因为Hashset不能相等，通过三个步骤判断。1看hashcode判断判断x和y的哈希码是否相同，相同不能说明是相等的，但是不同肯定是不等的，以为哈希码可能通过同一个算法计算出同一个值，但是不同的肯定是不等的，2如果是相同的哈希码则再去判断是不是同一个对象，3如果是同一个对象，则是相同的，就不往里放了，同时判断equals方法，这地方考虑equals是否重写没重写还是比较内存地址。</p>
<p>这个时候equals方法和hashcode方法并没有重写， 所以说，equals方法比较的还是内存地址。hashcode默认取得是内存地址。一般重写equals方法的时候都要重写hashcode方法。</p>
<h2 id="并发编程有哪些缺点"><a href="#并发编程有哪些缺点" class="headerlink" title="并发编程有哪些缺点"></a>并发编程有哪些缺点</h2><h4 id="1-频繁的上下文切换"><a href="#1-频繁的上下文切换" class="headerlink" title="1 频繁的上下文切换"></a>1 频繁的上下文切换</h4><p>时间片是CPU分配给各个线程的时间，因为时间非常短，所以CPU不断通过切换线程，让我们觉得多个线程是同时执行的，时间片一般是几十毫秒。而每次切换时，需要保存当前的状态起来，以便能够进行恢复先前状态，而这个切换时非常损耗性能，过于频繁反而无法发挥出多线程编程的优势。通常减少上下文切换可以采用无锁并发编程，CAS算法，使用最少的线程和使用协程。</p>
<p>无锁并发编程：可以参照concurrentHashMap锁分段的思想，不同的线程处理不同段的数据，这样在多线程竞争的条件下，可以减少上下文切换的时间。<br>CAS算法，利用Atomic下使用CAS算法来更新数据，使用了乐观锁，可以有效的减少一部分不必要的锁竞争带来的上下文切换<br>使用最少线程：避免创建不需要的线程，比如任务很少，但是创建了很多的线程，这样会造成大量的线程都处于等待状态<br>协程：在单线程里实现多任务的调度，并在单线程里维持多个任务间的切换</p>
<h4 id="2-线程安全"><a href="#2-线程安全" class="headerlink" title="2 线程安全"></a>2 线程安全</h4><p>那么，通常可以用如下方式避免死锁的情况：</p>
<p>避免一个线程同时获得多个锁；<br>避免一个线程在锁内部占有多个资源，尽量保证每个锁只占用一个资源；<br>尝试使用定时锁，使用lock.tryLock(timeOut)，当超时等待时当前线程不会阻塞；<br>对于数据库锁，加锁和解锁必须在一个数据库连接里，否则会出现解锁失败的情况</p>
<h2 id="需要了解的概念"><a href="#需要了解的概念" class="headerlink" title="需要了解的概念"></a>需要了解的概念</h2><h3 id="3-1-同步VS异步"><a href="#3-1-同步VS异步" class="headerlink" title="3.1 同步VS异步"></a>3.1 同步VS异步</h3><p>同步和异步通常用来形容一次方法调用。同步方法调用一开始，调用者必须等待被调用的方法结束后，调用者后面的代码才能执行。而异步调用，指的是，调用者不用管被调用方法是否完成，都会继续执行后面的代码，当被调用的方法完成后会通知调用者。比如，在超时购物，如果一件物品没了，你得等仓库人员跟你调货，直到仓库人员跟你把货物送过来，你才能继续去收银台付款，这就类似同步调用。而异步调用了，就像网购，你在网上付款下单后，什么事就不用管了，该干嘛就干嘛去了，当货物到达后你收到通知去取就好。</p>
<h3 id="3-2-并发与并行"><a href="#3-2-并发与并行" class="headerlink" title="3.2 并发与并行"></a>3.2 并发与并行</h3><p>并发和并行是十分容易混淆的概念。并发指的是多个任务交替进行，而并行则是指真正意义上的“同时进行”。实际上，如果系统内只有一个CPU，而使用多线程时，那么真实系统环境下不能并行，只能通过切换时间片的方式交替进行，而成为并发执行任务。真正的并行也只能出现在拥有多个CPU的系统中。</p>
<h3 id="3-3-阻塞和非阻塞"><a href="#3-3-阻塞和非阻塞" class="headerlink" title="3.3 阻塞和非阻塞"></a>3.3 阻塞和非阻塞</h3><p>阻塞和非阻塞通常用来形容多线程间的相互影响，比如一个线程占有了临界区资源，那么其他线程需要这个资源就必须进行等待该资源的释放，会导致等待的线程挂起，这种情况就是阻塞，而非阻塞就恰好相反，它强调没有一个线程可以阻塞其他线程，所有的线程都会尝试地往前运行。</p>
<h3 id="3-4-临界区"><a href="#3-4-临界区" class="headerlink" title="3.4 临界区"></a>3.4 临界区</h3><p>临界区用来表示一种公共资源或者说是共享数据，可以被多个线程使用。但是每个线程使用时，一旦临界区资源被一个线程占有，那么其他线程必须等待。</p>
<p><img src="https://i.imgur.com/kNOJ5Hs.png" alt=""></p>
<h2 id="volatile讲解"><a href="#volatile讲解" class="headerlink" title="volatile讲解"></a>volatile讲解</h2><p>更详细地说是要符合以下两个规则：</p>
<p>线程对变量进行修改之后，要立刻回写到主内存。</p>
<p>线程对变量读取的时候，要从主内存中读，而不是缓存。</p>
<p>上面提到volatile的两条语义保证了线程间共享变量的及时可见性，但整个过程并没有保证同步</p>
<p>对于共享普通变量来说，约定了变量在工作内存中发生变化了之后，必须要回写到工作内存(迟早要回写但并非马上回写)，但对于volatile变量则要求工作内存中发生变化之后，必须马上回写到工作内存，而线程读取volatile变量的时候，必须马上到工作内存中去取最新值而不是读取本地工作内存的副本，此规则保证了前面所说的“当线程A对变量X进行了修改后，在线程A后面执行的其他线程能看到变量X的变动”。</p>
<p>大部分网上的文章对于volatile的解释都是到此为止，但我觉得还是有遗漏的，提出来探讨。工作内存可以说是主内存的一份缓存，为了避免缓存的不一致性，所以volatile需要废弃此缓存。但除了内存缓存之外，在CPU硬件级别也是有缓存的，即寄存器。假如线程A将变量X由0修改为1的时候，CPU是在其缓存内操作，没有及时回写到内存，那么JVM是无法X=1是能及时被之后执行的线程B看到的，所以我觉得JVM在处理volatile变量的时候，也同样用了硬件级别的缓存一致性原则(CPU的缓存一致性原则参见《Java的多线程机制系列：(二）缓存一致性和CAS》。</p>
<p>如本文开头时只有在while死循环时才体现出volatile的作用，哪怕只是加了System.out.println(1)这么一小段，普通变量也能达到volatile的效果，这是什么原因呢？原来只有在对变量读取频率很高的情况下，虚拟机才不会及时回写主内存，而当频率没有达到虚拟机认为的高频率时，普通变量和volatile是同样的处理逻辑。如在每个循环中执行System.out.println(1)加大了读取变量的时间间隔，使虚拟机认为读取频率并不那么高，所以实现了和volatile的效果(本文开头的例子只在HotSpot24上测试过，没有在JRockit之类其余版本JDK上测过)。volatile的效果在jdk1.2及之前很容易重现，但随着虚拟机的不断优化，如今的普通变量的可见性已经不是那么严重的问题了</p>
<h2 id="为什么volatile不能保证原子性？"><a href="#为什么volatile不能保证原子性？" class="headerlink" title="为什么volatile不能保证原子性？"></a>为什么volatile不能保证原子性？</h2><h3 id="原子性"><a href="#原子性" class="headerlink" title="原子性"></a>原子性</h3><p>锁提供了两种主要特性：原子性和可见性。</p>
<blockquote>
<p>原子性即一次只允许一个线程持有某个特定的锁，一次就只有一个线程能够使用共享数据。可见性是必须确保释放锁之前对共享数据做出的更改对于随后获得该锁的另一个线程是可见的 。</p>
</blockquote>
<p>Volatile 变量具有 synchronized 的可见性特性，但是不具备原子特性。<br>当一个变量定义为 volatile 之后，将具备：</p>
<blockquote>
<p>1.保证此变量对所有的线程的可见性，当一个线程修改了这个变量的值，volatile 保证了新值能立即同步到主内存，其它线程每次使用前立即从主内存刷新。但普通变量做不到这点，普通变量的值在线程间传递均需要通过主内存来完成。<br>2.禁止指令重排序优化。有volatile修饰的变量，赋值后多执行了一个“load addl $0x0, (%esp)”操作，这个操作相当于一个内存屏障（指令重排序时不能把后面的指令重排序到内存屏障之前的位置）</p>
</blockquote>
<p><img src="https://i.imgur.com/qfs2pVf.png" alt=""></p>
<p>假如说线程A在做了i+1，但未赋值的时候，线程B就开始读取i，那么当线程A赋值i=1，并回写到主内存，而此时线程B已经不再需要i的值了，而是直接交给处理器去做+1的操作，于是当线程B执行完并回写到主内存，i的值仍然是1，而不是预期的2。也就是说，volatile缩短了普通变量在不同线程之间执行的时间差，但仍然存有漏洞，依然不能保证原子性。</p>
<h2 id="什么是指令重排序？"><a href="#什么是指令重排序？" class="headerlink" title="什么是指令重排序？"></a>什么是指令重排序？</h2><p>有两个层面：</p>
<h3 id="在虚拟机层面"><a href="#在虚拟机层面" class="headerlink" title="在虚拟机层面"></a>在虚拟机层面</h3><p>为了尽可能减少内存操作速度远慢于CPU运行速度所带来的CPU空置的影响，虚拟机会按照自己的一些规则(这规则后面再叙述)将程序编写顺序打乱——即写在后面的代码在时间顺序上可能会先执行，而写在前面的代码会后执行——以尽可能充分地利用CPU。拿上面的例子来说：假如不是a=1的操作，而是a=new byte<a href="分配1M空间">1024*1024</a>，那么它会运行地很慢，此时CPU是等待其执行结束呢，还是先执行下面那句flag=true呢？显然，先执行flag=true可以提前使用CPU，加快整体效率，当然这样的前提是不会产生错误(什么样的错误后面再说)。虽然这里有两种情况：后面的代码先于前面的代码开始执行；前面的代码先开始执行，但当效率较慢的时候，后面的代码开始执行并先于前面的代码执行结束。不管谁先开始，总之后面的代码在一些情况下存在先结束的可能。</p>
<h3 id="在硬件层面"><a href="#在硬件层面" class="headerlink" title="在硬件层面"></a>在硬件层面</h3><p>CPU会将接收到的一批指令按照其规则重排序，同样是基于CPU速度比缓存速度快的原因，和上一点的目的类似，只是硬件处理的话，每次只能在接收到的有限指令范围内重排序，而虚拟机可以在更大层面、更多指令范围内重排序。硬件的重排序机制参见《从JVM并发看CPU内存指令重排序(Memory Reordering)》</p>
<h2 id="内存屏障"><a href="#内存屏障" class="headerlink" title="内存屏障"></a>内存屏障</h2><p>内存屏障分为两种：<strong>Load Barrier</strong> 和 <strong>Store Barrier</strong>即读屏障和写屏障。</p>
<p>内存屏障有两个作用：</p>
<blockquote>
<p>1.阻止屏障两侧的指令重排序；<br>2.强制把写缓冲区/高速缓存中的脏数据等写回主内存，让缓存中相应的数据失效。</p>
</blockquote>
<blockquote>
<p>对于Load Barrier来说，在指令前插入Load Barrier，可以让高速缓存中的数据失效，强制从新从主内存加载数据；<br>对于Store Barrier来说，在指令后插入Store Barrier，能让写入缓存中的最新数据更新写入主内存，让其他线程可见。</p>
</blockquote>
<p>java的内存屏障通常所谓的四种即LoadLoad,StoreStore,LoadStore,StoreLoad实际上也是上述两种的组合，完成一系列的屏障和数据同步功能。</p>
<blockquote>
<p><strong>LoadLoad屏障</strong>：对于这样的语句Load1; LoadLoad; Load2，在Load2及后续读取操作要读取的数据被访问前，保证Load1要读取的数据被读取完毕。<br><strong>StoreStore屏障</strong>：对于这样的语句Store1; StoreStore; Store2，在Store2及后续写入操作执行前，保证Store1的写入操作对其它处理器可见。<br><strong>LoadStore屏障</strong>：对于这样的语句Load1; LoadStore; Store2，在Store2及后续写入操作被刷出前，保证Load1要读取的数据被读取完毕。<br><strong>StoreLoad屏障</strong>：对于这样的语句Store1; StoreLoad; Load2，在Load2及后续所有读取操作执行前，保证Store1的写入对所有处理器可见。它的开销是四种屏障中最大的。在大多数处理器的实现中，这个屏障是个万能屏障，兼具其它三种内存屏障的功能</p>
</blockquote>
<p>volatile的内存屏障策略非常严格保守，非常悲观且毫无安全感的心态：</p>
<blockquote>
<p>在每个volatile写操作前插入StoreStore屏障，在写操作后插入StoreLoad屏障；</p>
</blockquote>
<blockquote>
<p>在每个volatile读操作前插入LoadLoad屏障，在读操作后插入LoadStore屏障；</p>
</blockquote>
<p>由于内存屏障的作用，避免了volatile变量和其它指令重排序、线程之间实现了通信，使得volatile表现出了锁的特性。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2018/12/01/剑指offer面试题Java版(一)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/01/剑指offer面试题Java版(一)/" itemprop="url">剑指offer面试题Java版(一)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-12-01T16:56:56+08:00">
                2018-12-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/面试/" itemprop="url" rel="index">
                    <span itemprop="name">面试</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/面试/剑指offer/" itemprop="url" rel="index">
                    <span itemprop="name">剑指offer</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>数组基础：</p>
<pre><code>import java.util.Arrays;
import java.util.Scanner;
public class jichu {

public static void main(String args[]) {
    int[][] array = {{1, 3, 4,}, {123, 23, 4}};
    int target = 3;
    jichu offer = new jichu();
    boolean b = offer.find(array, target);
    System.out.println(b);
    System.out.println(array[0][0]);
    System.out.println(array[0][1]);
    System.out.println(array[0][2]);
    System.out.println(array[1][0]);
    System.out.println(array[1][1]);
    System.out.println(array[1][2]);

    System.out.println(&quot;一维数组转换成String,一维数组按大小排序，以为数组取最大值最小值&quot;);
    offer.chaxun();
    System.out.println(&quot;遍历数组的几种方式==================&quot;);
    offer.bianli1(array);
    offer.bianli2(array);
    offer.bianli3(array);
    System.out.println(&quot;实现数组交换----------------&quot;);
    offer.jiaohuan(array);
    System.out.println(&quot;打印杨辉三角=========================&quot;);
    offer.yanghhui();

}

public void chaxun() {
    int[] a = new int[]{80, 23, 46, 26};
    System.out.println(Arrays.toString(a));
    Arrays.sort(a);
    System.out.println(Arrays.toString(a));
    System.out.println(&quot;最小值：&quot; + a[0] + &quot;, 最大值&quot; + a[a.length - 1]);
    System.out.println(Arrays.binarySearch(a, 450));
}

//遍历二维数组
public void bianli1(int[][] arr) {

    for (int i = 0; i &lt; arr.length; i++) {
        for (int j = 0; j &lt; arr[i].length; j++) {
            System.out.print(arr[i][j] + &quot; &quot;);
        }
        System.out.println();    //换行
    }
}

public void bianli2(int[][] arr) {
    for (int[] a : arr) {
        for (int b : a) {
            System.out.print(b + &quot; &quot;);
        }
        System.out.println();
    }
}

public void bianli3(int[][] arr) {
    System.out.println(Arrays.toString(arr[0]));

    for (int i = 0; i &lt; arr.length; i++)
        System.out.println(Arrays.toString(arr[i]));
}


//二维数组所有的都头尾交换
public void jiaohuan(int[][] arr) {
    for (int i = 0; i &lt; arr.length; i++) {
        for (int j = 0; j &lt; arr[i].length; j++) {
            System.out.print(arr[i][j] + &quot; &quot;);
        }
        System.out.println();    //换行
    }
    for (int start = 0, end = arr.length - 1; start &lt; end; start++, end--) {
        int[] temp = arr[start];
        arr[start] = arr[end];
        arr[end] = temp;
    }
    for (int i = 0; i &lt; arr.length; i++) {
        for (int j = 0; j &lt; arr[i].length; j++) {
            System.out.print(arr[i][j] + &quot; &quot;);
        }
        System.out.println();    //换行
    }
}


public void yanghhui() {
    //从控制台获取行数
    Scanner s = new Scanner(System.in);
    int row = s.nextInt();
    //根据行数定义好二维数组，由于每一行的元素个数不同，所以不定义每一行的个数
    int[][] arr = new int[row][];
    //遍历二维数组

    for (int i = 0; i &lt; row; i++) {
        //初始化每一行的这个一维数组
        arr[i] = new int[i + 1];
        //遍历这个一维数组，添加元素
        for (int j = 0; j &lt;= i; j++) {
            //每一列的开头和结尾元素为1，开头的时候，j=0，结尾的时候，j=i
            if (j == 0 || j == i) {
                arr[i][j] = 1;
            } else {//每一个元素是它上一行的元素和斜对角元素之和
                arr[i][j] = arr[i - 1][j] + arr[i - 1][j - 1];
            }
            System.out.print(arr[i][j] + &quot;\t&quot;);
        }
        System.out.println(&quot;&quot;);
    }
}

public void yanghuipra() {
    Scanner scanner = new Scanner(System.in);
    int row = scanner.nextInt();

    int[][] arr = new int[row][];


    for (int i = 0; i &lt; row; i++) {
        arr[i] = new int[i + 1];
        for (int j = 0; j &lt; row; j++) {
            if (j == 0 || j == i) {
                arr[i][j] = 1;
            } else {
                arr[i][j] = arr[i - 1][j - 1] + arr[i - 1][j];
            }
            System.out.println(arr[i][j] + &quot;\n&quot;);
        }
    }
}
</code></pre><p>}</p>
<hr>
<pre><code>public static void main(String[] args) {
//// write your code here
    int[][] A=new  int[][]{{1,2},{4,5},{7,8,10,11,12},{}};
    System.out.println(A.length);//4,表示数组的行数
    System.out.println(A[0].length);//2，表示对应行的长度
    System.out.println(A[1].length);//2
    System.out.println(A[2].length);//5
}
</code></pre><hr>
<p>if语句基础：</p>
<p><img src="https://i.imgur.com/OxiJEES.png" alt=""></p>
<hr>
<p>第一个个算法</p>
<p>在一个二维数组中，每一行都按照从左到右递增的顺序排序，每一列都按照从上到下递增的顺序排序。请完<br>成一个函数，输入这样的一个二维数组和一个整数，判断数组中是否含有该整数</p>
<pre><code> public static void main(String args[]) {
    int[][] array = {{1, 3, 4,}, {123, 23, 4}};
    int target = 3;
    jichu offer = new jichu();

    offer.find();

}

public boolean find(int[][] array, int target) {
    if (array == null) {
        return false;
    }
    int row = 0;
    int column = array[0].length - 1;
    while (row &lt; array.length &amp;&amp; column &gt;= 0) {
        if (array[row][column] == target) {
            return true;
        }
        if (array[row][column] &gt; target) {
            column--;
        } else {
            row++;
        }
    }
    return false;
}
</code></pre><p>第二个算法：<br>将一个字符串中的空格替换成“%20”。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2018/12/01/剑指offer面试题Java版/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/01/剑指offer面试题Java版/" itemprop="url">剑指offer面试题Java版</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-12-01T16:56:56+08:00">
                2018-12-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/算法/" itemprop="url" rel="index">
                    <span itemprop="name">算法</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/算法/面试/" itemprop="url" rel="index">
                    <span itemprop="name">面试</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/算法/面试/剑指offer/" itemprop="url" rel="index">
                    <span itemprop="name">剑指offer</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2018/11/29/SSM第三天/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/29/SSM第三天/" itemprop="url">SSM第三天</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-29T21:16:19+08:00">
                2018-11-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="部署tomcat服务器"><a href="#部署tomcat服务器" class="headerlink" title="部署tomcat服务器"></a>部署tomcat服务器</h2><pre><code>1.下载apache-tomcat-7.0.70-windows-x64.zip
2.解压文件，不要放到中文或者空格目录下。
3.进入加压目录.
    cmd&gt;cd {tomcat_home}/bin

4.执行命令
    cmd&gt;startup.bat
5.通过浏览器访问页面，查看是否启动成功。
    http://localhost:8080/
</code></pre><h2 id="tomcat目录结构"><a href="#tomcat目录结构" class="headerlink" title="tomcat目录结构"></a>tomcat目录结构</h2><pre><code>bin        //执行文件
conf    //配置文件目录,server.xml,修改8080.

webapps    //项目部署目录,项目打成war包，运行期间自行解压。

work    //临时目录
logs    //日志目录
</code></pre><h2 id="在idea中开发web项目"><a href="#在idea中开发web项目" class="headerlink" title="在idea中开发web项目"></a>在idea中开发web项目</h2><pre><code>1.在idea中配置tomcat服务器
    settings &gt; applications server -&gt; + --&gt; 定位到tomcat解压目录 -&gt;ok
2.创建java模块 + javaEE支持 + maven支持.
3.运行web程序
</code></pre><h2 id="配置idea中tomcat热部署"><a href="#配置idea中tomcat热部署" class="headerlink" title="配置idea中tomcat热部署"></a>配置idea中tomcat热部署</h2><pre><code>0.关闭tomcat服务器
1.run --&gt; edit configuration
2.Server选项卡--&gt; VM options部分
    on &quot;Update&quot; action : update Classes and resources
    on Frame deactivation : update Classes and resources

3.启动服务器要选择&quot;debug&quot;模式.
</code></pre><h2 id="在web模块中添加mvn支持"><a href="#在web模块中添加mvn支持" class="headerlink" title="在web模块中添加mvn支持"></a>在web模块中添加mvn支持</h2><p>这个地方controller返回的是modelandview然后在返回给分发器程序的。返回的是模型视图的逻辑名。而且还需要配置一个视图解析器。</p>
<p><img src="https://i.imgur.com/kxi323W.png" alt=""></p>
<p>handlemapping controller viewresolve需要配置到beans.xml里面，这个文件可以随意配置名字。</p>
<pre><code>1.在pom.xml引入springmvc的依赖
    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
    &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
             xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
             xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
        &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

        &lt;groupId&gt;com.it18zhang&lt;/groupId&gt;
        &lt;artifactId&gt;myspringmvc&lt;/artifactId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
        &lt;dependencies&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
                &lt;version&gt;4.3.3.RELEASE&lt;/version&gt;
            &lt;/dependency&gt;
        &lt;/dependencies&gt;
    &lt;/project&gt;

2.在web/WEB-INF/web.xml文件中配置DispatcherServlet分发器.
    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
    &lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;
             xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
             xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;
             version=&quot;3.1&quot;&gt;
        &lt;!-- 配置分发器Servlet --&gt;
        &lt;servlet&gt;
            &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;
            &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
        &lt;/servlet&gt;
        &lt;servlet-mapping&gt;
            &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;
            &lt;url-pattern&gt;/&lt;/url-pattern&gt;
        &lt;/servlet-mapping&gt;
    &lt;/web-app&gt;

3.配置springmvc配置文件，使用注解驱动配置项(默认名称就是dispatcher-servlet.xml)
    [web/WEB-INF/dispatcher-servlet.xml]
    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
    &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
           xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
           xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;
           xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
                            http://www.springframework.org/schema/beans/spring-beans.xsd
                            http://www.springframework.org/schema/mvc
                            http://www.springframework.org/schema/mvc/spring-mvc-4.3.xsd&quot;&gt;
        &lt;!-- 使用注解驱动 --&gt;
        &lt;mvc:annotation-driven  /&gt;
    &lt;/beans&gt;

4.编写控制器类
    [HomeController.java]
    package com.it18zhang.springmvc.web.controller;

    import org.springframework.stereotype.Controller;
    import org.springframework.web.bind.annotation.RequestMapping;

    /**
     * HomeController
     */
    @Controller
    public class HomeController {

        /**
         * 打开主页
         */
        @RequestMapping(&quot;/home&quot;)
        public String openHome(){
            System.out.println(&quot;hello world&quot;);
            return null ;
        }
    }

5.配置dispatcher-servlet.xml文件，增加扫描路径配置。
    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
    &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
           xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
           xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;
           xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
           xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
                            http://www.springframework.org/schema/beans/spring-beans.xsd
                            http://www.springframework.org/schema/mvc
                            http://www.springframework.org/schema/mvc/spring-mvc-4.3.xsd
                            http://www.springframework.org/schema/context
                            http://www.springframework.org/schema/context/spring-context-4.3.xsd&quot;&gt;
        &lt;!-- 配置扫描路径 --&gt;
        &lt;context:component-scan base-package=&quot;com.it18zhang.springmvc.web.controller&quot; /&gt;
        &lt;!-- 使用注解驱动 --&gt;
        &lt;mvc:annotation-driven  /&gt;
    &lt;/beans&gt;

6.启动程序，访问地址
    http://localhost:9090/


7.出现类找不到的原因。
    idea的web项目默认不会将依赖类库放置到web-inf/lib下，需要手动设置详情见PPT。
    project structure -&gt; artifacts -&gt; myspringmvc:war exploded -&gt; 选择 output layout选项卡 -&gt;
    选择右侧的available elements下myspringmvc条目的所有类库 -&gt;右键 -&gt; put into WEB-INF/lib即可。

8.运行程序。

9.配置Spring MVC是视图解析器.
    [web/WEB-INF/dispatcher-servlet.xml]
    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
    &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
           xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
           xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;
           xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
           xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
                            http://www.springframework.org/schema/beans/spring-beans.xsd
                            http://www.springframework.org/schema/mvc
                            http://www.springframework.org/schema/mvc/spring-mvc-4.3.xsd
                            http://www.springframework.org/schema/context
                            http://www.springframework.org/schema/context/spring-context-4.3.xsd&quot;&gt;
        &lt;!-- 配置扫描路径 --&gt;
        &lt;context:component-scan base-package=&quot;com.it18zhang.springmvc.web.controller&quot; /&gt;
        &lt;!-- 使用注解驱动 --&gt;
        &lt;mvc:annotation-driven  /&gt;

        &lt;!-- 内部资源视图解析器 --&gt;
        &lt;bean class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;
            &lt;property name=&quot;prefix&quot; value=&quot;/&quot; /&gt;
            &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt;
        &lt;/bean&gt;
    &lt;/beans&gt;

10.添加jsp页面和控制代码
    [HomeController.java]
    package com.it18zhang.springmvc.web.controller;

    import org.springframework.stereotype.Controller;
    import org.springframework.web.bind.annotation.RequestMapping;

    /**
     * HomeController
     */
    @Controller
    public class HomeController {
        /**
         * 打开主页
         */
        @RequestMapping(&quot;/home&quot;)
        public String openHome(){
            System.out.println(&quot;hello world&quot;);
            return &quot;index&quot;;
        }
        /**
         * 打开主页
         */
        @RequestMapping(&quot;/home2&quot;)
        public String home2(){
            System.out.println(&quot;how are you???&quot;);
            return &quot;index2&quot;;
        }
    }

11./web/index.jsp + /web/index2.jsp
    [/web/index2.jsp]
    &lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
    &lt;html&gt;
      &lt;head&gt;
        &lt;title&gt;index2.jsp&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;
        welcome to spring mvc !!!
      &lt;/body&gt;
    &lt;/html&gt;
</code></pre><h2 id="html"><a href="#html" class="headerlink" title="html:"></a>html:</h2><pre><code>标签类型
inline            //行内标签,自己不占一行,和其他标签可以在一行.&lt;br&gt;
block            //块标签,自己占一行。

&lt;a href=&quot;&quot;&gt;百度&lt;/a&gt;
</code></pre><h2 id="模拟注册行为"><a href="#模拟注册行为" class="headerlink" title="模拟注册行为"></a>模拟注册行为</h2><pre><code>1.创建/web/reg.jsp
    &lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
    &lt;html&gt;
    &lt;head&gt;
      &lt;title&gt;reg.jsp&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
    &lt;form action=&quot;/doReg2&quot; method=&quot;post&quot;&gt;
      UserName : &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;br&gt;
      Password : &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;br&gt;
      &lt;input type=&quot;submit&quot;/&gt;
    &lt;/form&gt;
    &lt;/body&gt;
    &lt;/html&gt;

2&apos;.引入Servlet API类库
    [pom.xml]
    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
    &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
             xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
             xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
        &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

        &lt;groupId&gt;com.it18zhang&lt;/groupId&gt;
        &lt;artifactId&gt;myspringmvc&lt;/artifactId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
        &lt;dependencies&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
                &lt;version&gt;4.3.3.RELEASE&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
                &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;
                &lt;version&gt;2.5&lt;/version&gt;
            &lt;/dependency&gt;
        &lt;/dependencies&gt;
    &lt;/project&gt;

2.创建RegController.java
    package com.it18zhang.springmvc.web.controller;

    import org.springframework.stereotype.Controller;
    import org.springframework.web.bind.annotation.RequestMapping;
    import org.springframework.web.bind.annotation.RequestParam;

    import javax.servlet.http.HttpServletRequest;

    /**
     *
     */
    @Controller
    public class RegController {

        @RequestMapping(&quot;/toReg&quot;)
        public String toRegView(){
            return &quot;reg&quot; ;
        }

        @RequestMapping(&quot;/doReg&quot;)
        public String doReg(@RequestParam(&quot;username&quot;) String username, @RequestParam(&quot;password&quot;) String password){
            System.out.println(&quot;插入数据&quot;);
            System.out.println(username + &quot;,&quot; + password);
            return &quot;index&quot; ;
        }

        @RequestMapping(&quot;/doReg2&quot;)
        public String doReg(HttpServletRequest req) {
            System.out.println(&quot;插入数据222&quot;);
            String user = req.getParameter(&quot;username&quot;);
            System.out.println(user);
            return &quot;index&quot;;
        }
    }
</code></pre><h2 id="引入jstl标签库-jee标准标签库。"><a href="#引入jstl标签库-jee标准标签库。" class="headerlink" title="引入jstl标签库,jee标准标签库。"></a>引入jstl标签库,jee标准标签库。</h2><pre><code>1.添加pom.xml依赖
    &lt;dependency&gt;
        &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
        &lt;artifactId&gt;jstl&lt;/artifactId&gt;
        &lt;version&gt;1.2&lt;/version&gt;
    &lt;/dependency&gt;

2.修改jsp页面,声明标签库并使用标签
    &lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
    &lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot; %&gt;
    &lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;reg.jsp&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
    &lt;form action=&apos;&lt;c:url value=&quot;/reg.jsp&quot; /&gt;&apos; method=&quot;post&quot;&gt;
        UserName : &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;br&gt;
        Password : &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;br&gt;
        &lt;input type=&quot;submit&quot;/&gt;
    &lt;/form&gt;
    &lt;/body&gt;
    &lt;/html&gt;
3.修改上下文名称
    project structure --&gt; artifacts --&gt; edit
4.
5.
</code></pre><h2 id="模拟查询-查询一个User对象"><a href="#模拟查询-查询一个User对象" class="headerlink" title="模拟查询-查询一个User对象"></a>模拟查询-查询一个User对象</h2><pre><code>1.添加方法
    class RegController{

        ...

        /*****从请求中提取uid参数******/
        @RequestMapping(&quot;/selectOne&quot;)
        public String selectOne(Model model , @RequestParam(&quot;uid&quot;) int uid){
            System.out.println(&quot;接受到了参数 : uid = &quot; + uid);
            String username =&quot;tomson&quot; ;
            //将数据存放到model中，向jsp传递.
            model.addAttribute(&quot;myusername&quot;, username);
            return &quot;selectOne&quot; ;
        }
    }

2.创建selectOne.jsp
    [selectOne.jsp]
    &lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
    &lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot; %&gt;
    &lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;selectOne.jsp&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        username : &lt;c:out value=&quot;${myusername}&quot; /&gt;
    &lt;/body&gt;
    &lt;/html&gt;

3.打开浏览器输入地址;
    http://localhost:9090/selectOne?uid=100
</code></pre><h2 id="模拟查询-查询全部信息"><a href="#模拟查询-查询全部信息" class="headerlink" title="模拟查询-查询全部信息"></a>模拟查询-查询全部信息</h2><pre><code>1.定义User类。
    public class User {
        private Integer id;
        private String name;
        private int age;
        ...
        //get/set
    }

2.在RegController中添加方法
    class RegController{
        ...
    @RequestMapping(&quot;/selectAll&quot;)
    public String selectAll(Model m){
        List&lt;User&gt; list = new ArrayList&lt;User&gt;();
        for(int i = 1  ; i &lt;= 50 ; i ++){
            User u = new User();
            u.setId(i);
            u.setName(&quot;tom&quot; + i);
            u.setAge(i % 20);
            list.add(u) ;
        }
        //
        m.addAttribute(&quot;allUsers&quot;,list);
        return &quot;userList&quot; ;
    }

3.创建userList.jsp
    &lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
    &lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot; %&gt;
    &lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;selectOne.jsp&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;table border=&quot;1px&quot;&gt;
            &lt;tr&gt;
                &lt;td&gt;ID&lt;/td&gt;
                &lt;td&gt;NAME&lt;/td&gt;
                &lt;td&gt;AGE&lt;/td&gt;
            &lt;/tr&gt;
            &lt;c:forEach items=&quot;${allUsers}&quot; var=&quot;u&quot;&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;c:out value=&quot;${u.id}&quot;/&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;c:out value=&quot;${u.name}&quot;/&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;c:out value=&quot;${u.age}&quot;/&gt;&lt;/td&gt;
                &lt;/tr&gt;
            &lt;/c:forEach&gt;
        &lt;/table&gt;
    &lt;/body&gt;
    &lt;/html&gt;

4.启动服务器,输入地址
    http://localhost:9090/selectAll
</code></pre><h2 id="forward"><a href="#forward" class="headerlink" title="forward:"></a>forward:</h2><pre><code>请求转发，在服务器内部完成。客户端不参与，地址栏不改变。
而且只能转发到本应用的其他路径上。共享请求参数。
</code></pre><p>redirect<br>    重定向，客户端参与，地址栏变，可以重定向到任意url地址。<br>    不能共享变量。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2018/11/28/Java基础（关于面试）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/28/Java基础（关于面试）/" itemprop="url">Java基础（关于面试）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-28T15:27:38+08:00">
                2018-11-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java基础/" itemprop="url" rel="index">
                    <span itemprop="name">Java基础</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java基础/面试/" itemprop="url" rel="index">
                    <span itemprop="name">面试</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>bit意为“位”或“比特”，是电子计算机中最小的数据单位，是计算机存储设备的最小单位，每一位的状态只能是0或1。</p>
<p>Byte意为“字节”，8个二进制位构成1个”字节(Byte)”，即1Byte=8bit,两者换算是1：8的关系，字节是计算机处理数据的基本单位，即以字节为单位解释信息。1个字节可以储存1个英文字母或者半个汉字，换句话说，1个汉字占据2个字节的存储空间。</p>
<p>发现 数据类型占内存的位数实际上与<strong><em>操作系统的位数和编译器</em></strong>（不同编译器支持的位数可能有所不同）都有关，具体某种数据类型占字节数得编译器根据操作系统位数两者之间进行协调好后分配内存大小。具体在使用的时候如想知道具体占内存的位数通过sizeof(int)可以得到准确的答案。</p>
<hr>
<h1 id="int-和byte-之间的转换"><a href="#int-和byte-之间的转换" class="headerlink" title="int 和byte[]之间的转换"></a>int 和byte[]之间的转换</h1><hr>
<h1 id="ArrayList和LinkedList的区别-完整总结"><a href="#ArrayList和LinkedList的区别-完整总结" class="headerlink" title="ArrayList和LinkedList的区别-完整总结"></a>ArrayList和LinkedList的区别-完整总结</h1><p>1.ArrayList是实现了基于动态数组的数据结构，每个元素在内存中存储地址是连续的；LinkedList基于链表的数据结构，每个元素内容包扩previous, next, element（其中，previous是该节点的上一个节点，next是该节点的下一个节点，element是该节点所包含的值），也是由于这一性质支持了每个元素在内存中分布存储。</p>
<p>2.为了使得突破动态长度数组而衍生的ArrayList初始容量为10，每次扩容会固定为之前的1.5倍，所以当你ArrayList达到一定量之后会是一种很大的浪费，并且每次扩容的过程是内部复制数组到新数组；LinkedList的每一个元素都需要消耗一定的空间</p>
<p>3.对于每个元素的检索，ArrayList要优于LinkedList。因为ArrayList从一定意义上来说，就是复杂的数组，所以基于数组index的  检索性能显然高于通过for循环来查找每个元素的LinkedList。</p>
<p>4.元素插入删除的效率对比，要视插入删除的位置来分析，各有优劣</p>
<p>在列表首位添加（删除）元素，LnkedList性能远远优于ArrayList,原因在于ArrayList要后移（前移）每个元素的索引和数组扩容（删除元素时则不需要扩容）。（测试的时候当然插入一次是看不出来什么的，我自己测试插入十万次，就会有数组扩容arraycopy的因素）而LinkedList则直接增加元素，修改原第一元素该节点的上一个节点即可，删除同理</p>
<p>在列表中间位置添加（删除）元素，总的来说位置靠前则LnkedList性能优于ArrayList，靠后则相反。出现这种情况的原因在于ArrayList性能主要损耗在后移（前移）该位置之后的元素索引，而LinkedList损耗在for循环从第一位检索该位置的元素。这个性能反转的临界点不固定，我自己测试插入十万次，在15000次左右损耗时间相比出现变化</p>
<p>在列表末尾位置添加（删除）元素，性能相差不大。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2018/11/25/Kafka/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/25/Kafka/" itemprop="url">Kafka</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-25T15:37:41+08:00">
                2018-11-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="flume"><a href="#flume" class="headerlink" title="flume"></a>flume</h2><pre><code>收集日志、移动、聚合框架。
基于事件。
</code></pre><h2 id="agent"><a href="#agent" class="headerlink" title="agent"></a>agent</h2><pre><code>source        //接收数据,生产者
            //put()
            //NetcatSource
            //ExecSource,实时收集 tail -F xxx.txt
            //spooldir
            //seq
            //Stress
            //avroSource

channel        //暂存数据，缓冲区,
            //非永久性:MemoryChannel
            //永久性  :FileChannel,磁盘. 
            //SpillableMemoryChannel :Mem + FileChannel.Capacity

sink        //输出数据,消费者
            //从channel提取take()数据,write()destination.
            //HdfsSink
            //HbaseSink
            //avroSink
</code></pre><p>看一下一边都是存储到哪里，如果是电信的那种需要经常查询的就需要放到Hbase里面，如果是放到hdfs里面就只能是全表扫描了。hbase可以随机定位。瞬间定位。  </p>
<h2 id="JMS"><a href="#JMS" class="headerlink" title="JMS"></a>JMS</h2><pre><code>java message service,java消息服务。

queue        //只有能有一个消费者。P2P模式(点对点).
            //发布订阅(publish-subscribe,主题模式)，
</code></pre><h2 id="kafka"><a href="#kafka" class="headerlink" title="kafka"></a>kafka</h2><pre><code>分布式流处理平台。
在系统之间构建实时数据流管道。
以topic分类对记录进行存储
每个记录包含key-value+timestamp
每秒钟百万消息吞吐量。


producer            //消息生产者
consumer            //消息消费者
consumer group        //消费者组
kafka server        //broker,kafka服务器也叫broker    
topic                //主题,副本数,分区.
zookeeper            //hadoop namenoade + RM HA | hbase | kafka
</code></pre><h2 id="安装kafka"><a href="#安装kafka" class="headerlink" title="安装kafka"></a>安装kafka</h2><pre><code>0.选择s202 ~ s204三台主机安装kafka
1.准备zk
    略
2.jdk
    略
3.tar文件
4.环境变量
    略
5.配置kafka
    [kafka/config/server.properties]
    ...
    broker.id=202
    ...
    listeners=PLAINTEXT://:9092
    ...
    log.dirs=/home/centos/kafka/logs
    ...
    zookeeper.connect=s201:2181,s202:2181,s203:2181

6.分发server.properties，同时修改每个文件的broker.id

7.启动kafka服务器
    a)先启动zk
    b)启动kafka
        [s202 ~ s204]
        $&gt;bin/kafka-server-start.sh config/server.properties

    c)验证kafka服务器是否启动
        $&gt;netstat -anop | grep 9092

8.创建主题 
    $&gt;bin/kafka-topics.sh --create --zookeeper s201:2181 --replication-factor 3 --partitions 3 --topic test

9.查看主题列表
    $&gt;bin/kafka-topics.sh --list --zookeeper s201:2181

10.启动控制台生产者
    $&gt;bin/kafka-console-producer.sh --broker-list s202:9092 --topic test1

11.启动控制台消费者
    $&gt;bin/kafka-console-consumer.sh --bootstrap-server s202:9092 --topic test1 --from-beginning --zookeeper s202:2181

12.在生产者控制台输入hello world
</code></pre><h2 id="kafka集群在zk的配置"><a href="#kafka集群在zk的配置" class="headerlink" title="kafka集群在zk的配置"></a>kafka集群在zk的配置</h2><pre><code>/controller            ===&gt;    {&quot;version&quot;:1,&quot;brokerid&quot;:202,&quot;timestamp&quot;:&quot;1490926369148&quot;

/controller_epoch    ===&gt;    1

/brokers
/brokers/ids        //记载kfk集群每个服务器的信息
/brokers/ids/202    ===&gt;    {&quot;jmx_port&quot;:-1,&quot;timestamp&quot;:&quot;1490926370304&quot;,&quot;endpoints&quot;:[&quot;PLAINTEXT://s202:9092&quot;],&quot;host&quot;:&quot;s202&quot;,&quot;version&quot;:3,&quot;port&quot;:9092}            //每个节点的连接信息
/brokers/ids/203
/brokers/ids/204        


//每个主题下分区数据，主题是有分区的。
/brokers/topics/test/partitions/0/state ===&gt;{&quot;controller_epoch&quot;:1,&quot;leader&quot;:203,&quot;version&quot;:1,&quot;leader_epoch&quot;:0,&quot;isr&quot;:[203,204,202]}
/brokers/topics/test/partitions/1/state ===&gt;...
/brokers/topics/test/partitions/2/state ===&gt;...
</code></pre><p>leader是针对于主题来说的，是针对主题上的分区来说的。每个分区test主题下。controller也是kfk注册的他和broker是一个层级。说明在kfk集群里面s202是类似于Leader的身份。在</p>
<pre><code>/brokers/seqid        ===&gt; null

/admin
/admin/delete_topics/test        ===&gt;标记删除的主题

/isr_change_notification

/consumers/xxxx/
/config
</code></pre><p>下图是生产者没有连接zk别的都是有连接zk的</p>
<p><img src="https://i.imgur.com/Kq3MmBF.png" alt=""></p>
<h2 id="容错"><a href="#容错" class="headerlink" title="容错"></a>容错</h2><h2 id="创建主题"><a href="#创建主题" class="headerlink" title="创建主题"></a>创建主题</h2><pre><code>//2个副本5个分区，2乘以5对应了10个文件夹分配到3个节点所以s202里面有3个，
repliation_factor 2 partitions 5

$&gt;kafka-topic.sh --zookeeper s202:2181 --replication_factor 3 --partitions 4 --create --topic test3

2 x 5  = 10        //是个文件夹

[s202]
test2-1            //
test2-2            //
test2-3            //

[s203]
test2-0
test2-2
test2-3
test2-4

[s204]
test2-0
test2-1
test2-4
</code></pre><h2 id="重新布局分区和副本，手动再平衡"><a href="#重新布局分区和副本，手动再平衡" class="headerlink" title="重新布局分区和副本，手动再平衡"></a>重新布局分区和副本，手动再平衡</h2><pre><code>$&gt;kafka-topics.sh --alter --zookeeper s202:2181 --topic test2 --replica-assignment 203:204,203:204,203:204,203:204,203:204
</code></pre><h2 id="副本"><a href="#副本" class="headerlink" title="副本"></a>副本</h2><pre><code>broker存放消息以消息达到顺序存放。生产和消费都是副本感知的。
支持到n-1故障。每个分区都有leader，follow.
leader挂掉时，消息分区写入到本地log或者，向生产者发送消息确认回执之前，生产者向新的leader发送消息。

新leader的选举是通过isr进行，第一个注册的follower成为leader。
</code></pre><h2 id="kafka支持副本模式"><a href="#kafka支持副本模式" class="headerlink" title="kafka支持副本模式"></a>kafka支持副本模式</h2><pre><code>[同步复制]
    1.producer联系zk识别leader
    2.向leader发送消息
    3.leadr收到消息写入到本地log
    4.follower从leader pull消息
    5.follower向本地写入log
    6.follower向leader发送ack消息
    7.leader收到所有follower的ack消息
    8.leader向producer回传ack


[异步副本]
    和同步复制的区别在与leader写入本地log之后，
    直接向client回传ack消息，不需要等待所有follower复制完成。
</code></pre><h2 id="通过java-API实现消息生产者，发送消息"><a href="#通过java-API实现消息生产者，发送消息" class="headerlink" title="通过java API实现消息生产者，发送消息"></a>通过java API实现消息生产者，发送消息</h2><pre><code>package com.it18zhang.kafkademo.test;

import org.junit.Test;

import kafka.javaapi.producer.Producer;
import kafka.producer.KeyedMessage;
import kafka.producer.ProducerConfig;

import java.util.HashMap;
import java.util.Properties;

/**
 * Created by Administrator on 2017/3/31.
 */
public class TestProducer {
    @Test
    public void testSend(){
        Properties props = new Properties();
        //broker列表
        props.put(&quot;metadata.broker.list&quot;, &quot;s202:9092&quot;);
        //串行化
        props.put(&quot;serializer.class&quot;, &quot;kafka.serializer.StringEncoder&quot;);
        //
        props.put(&quot;request.required.acks&quot;, &quot;1&quot;);

        //创建生产者配置对象
        ProducerConfig config = new ProducerConfig(props);

        //创建生产者
        Producer&lt;String, String&gt; producer = new Producer&lt;String, String&gt;(config);

        KeyedMessage&lt;String, String&gt; msg = new KeyedMessage&lt;String, String&gt;(&quot;test3&quot;,&quot;100&quot; ,&quot;hello world tomas100&quot;);
        producer.send(msg);
        System.out.println(&quot;send over!&quot;);
    }
}
</code></pre><h2 id="消息消费者"><a href="#消息消费者" class="headerlink" title="消息消费者"></a>消息消费者</h2><pre><code>/**
 * 消费者
 */
@Test
public void testConumser(){
    //
    Properties props = new Properties();
    props.put(&quot;zookeeper.connect&quot;, &quot;s202:2181&quot;);
    props.put(&quot;group.id&quot;, &quot;g3&quot;);
    props.put(&quot;zookeeper.session.timeout.ms&quot;, &quot;500&quot;);
    props.put(&quot;zookeeper.sync.time.ms&quot;, &quot;250&quot;);
    props.put(&quot;auto.commit.interval.ms&quot;, &quot;1000&quot;);
    props.put(&quot;auto.offset.reset&quot;, &quot;smallest&quot;);
    //创建消费者配置对象
    ConsumerConfig config = new ConsumerConfig(props);
    //
    Map&lt;String, Integer&gt; map = new HashMap&lt;String, Integer&gt;();
    map.put(&quot;test3&quot;, new Integer(1));
    Map&lt;String, List&lt;KafkaStream&lt;byte[], byte[]&gt;&gt;&gt; msgs = Consumer.createJavaConsumerConnector(new ConsumerConfig(props)).createMessageStreams(map);
    List&lt;KafkaStream&lt;byte[], byte[]&gt;&gt; msgList = msgs.get(&quot;test3&quot;);
    for(KafkaStream&lt;byte[],byte[]&gt; stream : msgList){
        ConsumerIterator&lt;byte[],byte[]&gt; it = stream.iterator();
        while(it.hasNext()){
            byte[] message = it.next().message();
            System.out.println(new String(message));
        }
    }
}
</code></pre><h2 id="flume集成kafka"><a href="#flume集成kafka" class="headerlink" title="flume集成kafka"></a>flume集成kafka</h2><pre><code>1.KafkaSink
    [生产者]
    a1.sources = r1
    a1.sinks = k1
    a1.channels = c1

    a1.sources.r1.type=netcat
    a1.sources.r1.bind=localhost
    a1.sources.r1.port=8888

    a1.sinks.k1.type = org.apache.flume.sink.kafka.KafkaSink
    a1.sinks.k1.kafka.topic = test3
    a1.sinks.k1.kafka.bootstrap.servers = s202:9092
    a1.sinks.k1.kafka.flumeBatchSize = 20
    a1.sinks.k1.kafka.producer.acks = 1

    a1.channels.c1.type=memory

    a1.sources.r1.channels = c1
    a1.sinks.k1.channel = c1

2.KafkaSource
    [消费者]
    a1.sources = r1
    a1.sinks = k1
    a1.channels = c1

    a1.sources.r1.type = org.apache.flume.source.kafka.KafkaSource
    a1.sources.r1.batchSize = 5000
    a1.sources.r1.batchDurationMillis = 2000
    a1.sources.r1.kafka.bootstrap.servers = s202:9092
    a1.sources.r1.kafka.topics = test3
    a1.sources.r1.kafka.consumer.group.id = g4

    a1.sinks.k1.type = logger

    a1.channels.c1.type=memory

    a1.sources.r1.channels = c1
    a1.sinks.k1.channel = c1

3.Channel
    生产者 + 消费者
    a1.sources = r1
    a1.sinks = k1
    a1.channels = c1

    a1.sources.r1.type = avro
    a1.sources.r1.bind = localhost
    a1.sources.r1.port = 8888

    a1.sinks.k1.type = logger

    a1.channels.c1.type = org.apache.flume.channel.kafka.KafkaChannel
    a1.channels.c1.kafka.bootstrap.servers = s202:9092
    a1.channels.c1.kafka.topic = test3
    a1.channels.c1.kafka.consumer.group.id = g6

    a1.sources.r1.channels = c1
    a1.sinks.k1.channel = c1
</code></pre><p>flume重启后会重新读取里面的内容，那么怎么解决重复读取？要引进行序号，每一行都是一个事件，所以在sink里面之后写入redis或者hbase里面因为是高速的，下次再启动flume，虽然从头开始读，也往通道里面放，但是对于sink来讲，会判断他的行号，如果序号比我的数据存的要早，就滤过。比这个大就往里写。相当于一个拦截器</p>
<p><img src="https://i.imgur.com/U1pTiwY.png" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2018/11/22/Hbase第四天/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/22/Hbase第四天/" itemprop="url">Hbase第四天</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-22T09:26:56+08:00">
                2018-11-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="hbase"><a href="#hbase" class="headerlink" title="hbase"></a>hbase</h2><pre><code>协处理器.
Observer            //触发器,基于事件激活的。
Endpoint            //存储过程,客户端调用。

RegionObserver        //system --&gt; user[加载顺序]

100

00-99

callerId - 201703 : hashcode % 100 = 00-99

01,139xxxx,138yyy,....
</code></pre><h2 id="热点"><a href="#热点" class="headerlink" title="热点"></a>热点</h2><pre><code>让数据均匀分散。
</code></pre><p>create ‘ns1:calllogs’ , SPLITS=&gt;[01,02,03,,…99,]</p>
<h2 id="rowkey"><a href="#rowkey" class="headerlink" title="rowkey"></a>rowkey</h2><pre><code>按照byte排序。
</code></pre><p>create table xxx(){</p>
<p>}</p>
<h2 id="rowkey-1"><a href="#rowkey-1" class="headerlink" title="rowkey"></a>rowkey</h2><pre><code>分区编号
xx,callerId,callTime,calleeId

startkey = xx,19626675332,
startkey = xx,19626675333,
</code></pre><h1 id="对通话记录表的设计：（具体在HBase的设计原则2）"><a href="#对通话记录表的设计：（具体在HBase的设计原则2）" class="headerlink" title="对通话记录表的设计：（具体在HBase的设计原则2）"></a>对通话记录表的设计：（具体在HBase的设计原则2）</h1><p><img src="https://i.imgur.com/Zt5A1OI.png" alt=""></p>
<p>对于首先创建的主叫的表是上面这张表，在查询主叫的时候只需要指定xx，主叫时间,时间片。即可。但是查询被叫的时候就不行了。几乎要全表扫描。用00,138xx,2017010101,139xxx这样查询。所以每次向这个表写记录的时候，我们都知道被叫是谁，如果知道被叫的话。我们可以在设计一张表，叫calleeLog,他的rowkey有calleid，time,callerid构成。被叫表存的value存的是主叫表rowkey里面的被叫。然后根据这个查到主叫表后面的内容。但是如果只想知道谁给你打的电话，所以在被叫表的rowkey里面加了一个callerid，如果想查询谁给你打了电话，就在被叫表rowkey里面加了一个callerid。主叫表的rowkey里面都是作为主叫出现的，被叫表里面的数据都是作为被叫出现的。主叫表的内容被叫表里没有，被叫表的内容主叫表也没有的。而且应该吧时长duration也放在里面。也就是说要把最经常使用的信息都编入rowkey里面去，能不查具体的value就尽量不查询具体的value，但是如果要查询具体的数据，什么基站，那个口啊，就是要查询主叫表里面的value的值。这个下图所示的也就是叫二次索引。在写入主叫表的时候也在往被叫表里面写入，用什么写入？也就是用协处理器来处理，怎么处理呢，就是在你写入主叫表的时候，协处理器立刻截获，然后重写里面的方法，往被叫表里面写入就可以了。所以这个就是一个电信HBase的设计原则。    </p>
<p><img src="https://i.imgur.com/QLxuFNg.png" alt=""></p>
<h2 id="通化记录"><a href="#通化记录" class="headerlink" title="通化记录"></a>通化记录</h2><pre><code>1.创建表
    create &apos;ns1:calllogs&apos;,&apos;f1&apos;

2.创建单元测试
    @Test
    public void put() throws Exception {
        Configuration conf = HBaseConfiguration.create();
        Connection conn = ConnectionFactory.createConnection(conf);
        TableName tname = TableName.valueOf(&quot;ns1:calllogs&quot;);
        Table table = conn.getTable(tname);

        String callerId = &quot;13845456767&quot; ;
        String calleeId = &quot;139898987878&quot; ;
        SimpleDateFormat sdf = new SimpleDateFormat();
        sdf.applyPattern(&quot;yyyyMMddHHmmss&quot;);
        String callTime = sdf.format(new Date());
        int duration = 100 ;
        DecimalFormat dff = new DecimalFormat();
        dff.applyPattern(&quot;00000&quot;);
        String durStr = dff.format(duration);

        //区域00-99
        int hash = (callerId + callTime.substring(0, 6)).hashCode();
        hash = (hash &amp; Integer.MAX_VALUE) % 100 ;

        //hash区域号
        DecimalFormat df = new DecimalFormat();
        df.applyPattern(&quot;00&quot;);
        String regNo = df.format(hash);

        //拼接rowkey
        //xx , callerid , time ,  direction, calleid  ,duration
        String rowkey = regNo + &quot;,&quot; + callerId + &quot;,&quot; + callTime + &quot;,&quot; + &quot;0,&quot; + calleeId + &quot;,&quot; + durStr  ;
        byte[] rowid = Bytes.toBytes(rowkey);
        Put put = new Put(rowid);
        put.addColumn(Bytes.toBytes(&quot;f1&quot;),Bytes.toBytes(&quot;callerPos&quot;),Bytes.toBytes(&quot;河北&quot;));
        put.addColumn(Bytes.toBytes(&quot;f1&quot;),Bytes.toBytes(&quot;calleePos&quot;),Bytes.toBytes(&quot;河南&quot;));
        //执行插入
        table.put(put);
        System.out.println(&quot;over&quot;);
    }

3.创建协处理器
    public class CalleeLogRegionObserver extends BaseRegionObserver{

        public void postPut(ObserverContext&lt;RegionCoprocessorEnvironment&gt; e, Put put, WALEdit edit, Durability durability) throws IOException {
            super.postPut(e, put, edit, durability);
            //
            TableName callLogs = TableName.valueOf(&quot;calllogs&quot;);
            //得到当前的TableName对象
            TableName tableName = e.getEnvironment().getRegion().getRegionInfo().getTable();
            if(!callLogs.equals(tableName)){
                return  ;
            }

            //得到主叫的rowkey
            //xx , callerid , time ,  direction, calleid  ,duration
            //被叫:calleid,time,

            String rowkey = Bytes.toString(put.getRow());
            String[] arr = rowkey.split(&quot;,&quot;);

            String hash = Util.getRegNo(arr[4],arr[2]);
            //hash

            String newRowKey = hash + &quot;,&quot; + arr[4] + &quot;,&quot; + arr[2] + &quot;,1,&quot; + arr[1] + &quot;,&quot; +  arr[5] ;
            Put newPut = new Put(Bytes.toBytes(newRowKey));

            Table t = e.getEnvironment().getTable(tableName);

            t.put(newPut);
        }
    }

4.配置hbase-site.xml并分发分发jar包。
    &lt;property&gt;
        &lt;name&gt;hbase.coprocessor.region.classes&lt;/name&gt;
        &lt;value&gt;com.it18zhang.hbasedemo.coprocessor.CalleeLogRegionObserver&lt;/value&gt;
    &lt;/property&gt;

5.启动hbase集群.
</code></pre><h2 id="BloomFilter"><a href="#BloomFilter" class="headerlink" title="BloomFilter"></a>BloomFilter</h2><pre><code>布隆过滤器。
</code></pre><p><img src="https://i.imgur.com/c0wLF4w.png" alt=""></p>
<p>代码如下:</p>
<p><img src="https://i.imgur.com/Za6Pcr1.png" alt=""></p>
<h2 id="phonix"><a href="#phonix" class="headerlink" title="phonix"></a>phonix</h2><pre><code>1.安装phonix
    a)下载apache-phoenix-4.10.0-HBase-1.2-bin.tar.gz
    b)tar
    c)复制xxx-server.jar到hbase的lib目录，并且分发,删除以前的phonixjar包。
    d)重启hbase

2.使用phonix的命令行程序
    $&gt;phonix/bin/.sqlline.py s202    //连接的是zk服务器
    $phonix&gt;!tables
    $phonix&gt;!help                    //查看帮助
</code></pre><p>phoenix在创建表的时候要使用大量的协处理器，他是在建表时候不区分大小写的，而且hbase不可以识别得出来他的表，但是hbase shell里面建的表他能识别。</p>
<pre><code>2.SQL Client安装
    a)下载squirrel-sql-3.7.1-standard.jar
        该文件是安装文件，执行的安装程序。
        $&gt;jar -jar squirrel-sql-3.7.1-standard.jar
        $&gt;下一步...

    b)复制phoenix-4.10.0-HBase-1.2-client.jar到SQuerrel安装目录的lib下(c:\myprograms\squirrel)。

    c)启动SQuirrel(GUI)
        定位安装目录-&gt;执行squirrel-sql.bat

    d)打开GUI界面

    d)在左侧的边栏选中&quot;Drivers&quot;选项卡，
        点击 &quot;+&quot; -&gt;
        URL                : jdbc:phoenix:192.168.231.202
        Driverclass        : org.apache.phoenix.jdbc.PhoenixDriver    
        jdbc:phoenix: s202

    d)测试。

3.SQLLine客户端操作
    //建表
    $jdbc:phoenix&gt;create table IF NOT EXISTS test.Person (IDCardNum INTEGER not null primary key, Name varchar(20),Age INTEGER);

    //插入数据
    $jdbc:phoenix&gt;UPSERT INTO test.PERSON(IDCardNum , Name,Age) VALUES (1,&apos;tom&apos;,12);

    //删除数据
    $jdbc:phoenix&gt;delete from test.persion where idcardnum = 1 ;

    //更新数据
    //upsert into test.PERSON(IDCardNum , Name,Age) VALUES (1,&apos;tom&apos;,12);
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2018/11/21/Flume/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/21/Flume/" itemprop="url">Flume</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-21T21:41:16+08:00">
                2018-11-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="hbase"><a href="#hbase" class="headerlink" title="hbase"></a>hbase</h2><pre><code>NoSQL.
面向列族。
随机定位
实时读写。
分布式
可伸缩
HA
zookeeper
                        version(列族)
rowkey/famil+qualifier/timestamp = value

rowkey        //唯一性,散列性,定长,不要太长,加盐.

二次索引
byte[]
</code></pre><h2 id="hive"><a href="#hive" class="headerlink" title="hive"></a>hive</h2><pre><code>离线计算。
</code></pre><h2 id="MR-MapReduce"><a href="#MR-MapReduce" class="headerlink" title="MR:MapReduce"></a>MR:MapReduce</h2><pre><code>hadoop : 
DBWritable + WritableComparable :
</code></pre><h2 id="将hbase的表影射到hive上，使用hive的查询语句。"><a href="#将hbase的表影射到hive上，使用hive的查询语句。" class="headerlink" title="将hbase的表影射到hive上，使用hive的查询语句。"></a>将hbase的表影射到hive上，使用hive的查询语句。</h2><pre><code>CREATE TABLE mydb.t11(key string, name string) STORED BY &apos;org.apache.hadoop.hive.hbase.HBaseStorageHandler&apos; 
WITH SERDEPROPERTIES (&quot;hbase.columns.mapping&quot; = &quot;:key,cf:name&quot;)
TBLPROPERTIES(&quot;hbase.table.name&quot; = &quot;ns1:t11&quot;);    

select count(*) from mydb.t11 ;
</code></pre><h2 id="flume"><a href="#flume" class="headerlink" title="flume"></a>flume</h2><pre><code>收集、移动、聚合大量日志数据的服务。
基于流数据的架构，用于在线日志分析。

基于事件。
在生产和消费者之间启动协调作用。
提供了事务保证，确保消息一定被分发。
Source 多种
sink多种.

multihop        //多级跃点.可以从一个flume到另外一个flume

水平扩展:        //加节点，

竖直扩展        //增加硬件。
</code></pre><h2 id="Source"><a href="#Source" class="headerlink" title="Source"></a>Source</h2><pre><code>接受数据，类型有多种。
</code></pre><h2 id="Channel"><a href="#Channel" class="headerlink" title="Channel"></a>Channel</h2><pre><code>临时存放地，对Source中来的数据进行缓冲，直到sink消费掉。
</code></pre><h2 id="Sink"><a href="#Sink" class="headerlink" title="Sink"></a>Sink</h2><pre><code>从channel提取数据存放到中央化存储(hadoop / hbase)。
</code></pre><p><img src="https://i.imgur.com/DbIixF1.png" alt=""></p>
<p>实时产生的数据，</p>
<p>Flume的优点<br>以下是使用Flume的优点：<br>使用Apache Flume，我们可以将数据存储到任何集中存储中<br>（HBase，HDFS）。<br>当传入数据的速率超过可以写入数据的速率时<br>目的地，Flume充当数据生产者和数据生成者之间的中介<br>集中存储并在它们之间提供稳定的数据流。<br>Flume提供了上下文路由的功能。</p>
<ol>
<li>FLUME - 介绍App Flume<br>2<br>Flume中的交易是基于渠道的，其中两个交易（一个发件人<br>为每条消息维护一个接收器。它保证了可靠的信息<br>交货。<br>Flume具有可靠性，容错性，可扩展性，可管理性和可定制性。<br>水槽的特点<br>Flume的一些显着特征如下：<br>Flume将来自多个Web服务器的日志数据提取到集中存储（HDFS，<br>HBase）有效。<br>使用Flume，我们可以立即将来自多个服务器的数据导入Hadoop。<br>与日志文件一起，Flume还用于导入大量事件数据<br>由Facebook和Twitter等社交网站和电子商务制作<br>亚马逊和Flipkart等网站。<br>Flume支持大量源和目标类型。<br>Flume支持多跳流，扇入扇出流，上下文路由等。<br>水槽可以水平缩放</li>
</ol>
<h2 id="安装flume"><a href="#安装flume" class="headerlink" title="安装flume"></a>安装flume</h2><pre><code>1.下载
2.tar
3.环境变量
4.验证flume是否成功  
    $&gt;flume-ng version            //next generation.下一代.
</code></pre><h2 id="配置flume"><a href="#配置flume" class="headerlink" title="配置flume"></a>配置flume</h2><pre><code>1.创建配置文件
[/soft/flume/conf/hello.conf]
#声明三种组件
a1.sources = r1
a1.channels = c1
a1.sinks = k1

#定义source信息
a1.sources.r1.type=netcat
a1.sources.r1.bind=localhost
a1.sources.r1.port=8888

#定义sink信息
a1.sinks.k1.type=logger

#定义channel信息
a1.channels.c1.type=memory

#绑定在一起
a1.sources.r1.channels=c1
a1.sinks.k1.channel=c1

2.运行
    a)启动flume agent
        $&gt;bin/flume-ng agent -f ../conf/helloworld.conf -n a1 -Dflume.root.logger=INFO,console
    b)启动nc的客户端
        $&gt;nc localhost 8888
        $nc&gt;hello world

    c)在flume的终端输出hello world.
</code></pre><h2 id="安装nc"><a href="#安装nc" class="headerlink" title="安装nc"></a>安装nc</h2><pre><code>$&gt;sudo yum install nmap-ncat.x86_64
</code></pre><h2 id="清除仓库缓存"><a href="#清除仓库缓存" class="headerlink" title="清除仓库缓存"></a>清除仓库缓存</h2><pre><code>$&gt;修改ali.repo --&gt; ali.repo.bak文件。
$&gt;sudo yum clean all
$&gt;sudo yum makecache

#例如阿里基本源 
$&gt;sudo wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo 

#阿里epel源
$&gt;sudo wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo
</code></pre><h2 id="flume-source"><a href="#flume-source" class="headerlink" title="flume source"></a>flume source</h2><pre><code>1.netcat
    nc ..

2.exec
    实时日志收集,实时收集日志。
    a1.sources = r1
    a1.sinks = k1
    a1.channels = c1

    a1.sources.r1.type=exec
    a1.sources.r1.command=tail -F /home/centos/test.txt

    a1.sinks.k1.type=logger

    a1.channels.c1.type=memory

    a1.sources.r1.channels=c1
    a1.sinks.k1.channel=c1

3.批量收集
    监控一个文件夹，静态文件。
    收集完之后，会重命名文件成新文件。.compeleted.
    a)配置文件
        [spooldir_r.conf]
        a1.sources = r1
        a1.channels = c1
        a1.sinks = k1

        a1.sources.r1.type=spooldir
        a1.sources.r1.spoolDir=/home/centos/spool
        a1.sources.r1.fileHeader=true

        a1.sinks.k1.type=logger

        a1.channels.c1.type=memory

        a1.sources.r1.channels=c1
        a1.sinks.k1.channel=c1

    b)创建目录
        $&gt;mkdir ~/spool

    c)启动flume
        $&gt;bin/flume-ng agent -f ../conf/helloworld.conf -n a1 -Dflume.root.logger=INFO,console

4.序列source
    [seq]
    a1.sources = r1
    a1.channels = c1
    a1.sinks = k1

    a1.sources.r1.type=seq
    a1.sources.r1.totalEvents=1000

    a1.sinks.k1.type=logger

    a1.channels.c1.type=memory

    a1.sources.r1.channels=c1
    a1.sinks.k1.channel=c1

    [运行]
    $&gt;bin/flume-ng agent -f ../conf/helloworld.conf -n a1 -Dflume.root.logger=INFO,console

5.StressSource
    a1.sources = stresssource-1
    a1.channels = memoryChannel-1
    a1.sources.stresssource-1.type = org.apache.flume.source.StressSource
    a1.sources.stresssource-1.size = 10240
    a1.sources.stresssource-1.maxTotalEvents = 1000000
    a1.sources.stresssource-1.channels = memoryChannel-1
</code></pre><h2 id="flume-sink"><a href="#flume-sink" class="headerlink" title="flume sink"></a>flume sink</h2><pre><code>1.hdfs
    a1.sources = r1
    a1.channels = c1
    a1.sinks = k1

    a1.sources.r1.type = netcat
    a1.sources.r1.bind = localhost
    a1.sources.r1.port = 8888

    a1.sinks.k1.type = hdfs
    a1.sinks.k1.hdfs.path = /flume/events/%y-%m-%d/%H/%M/%S
    a1.sinks.k1.hdfs.filePrefix = events-

    #是否是产生新目录,每十分钟产生一个新目录,一般控制的目录方面。round是决定是否产生新文件的，滚动是决定是否产生新文件的。
    #2017-12-12 --&gt;
    #2017-12-12 --&gt;%H%M%S

    a1.sinks.k1.hdfs.round = true            
    a1.sinks.k1.hdfs.roundValue = 10
    a1.sinks.k1.hdfs.roundUnit = second

    a1.sinks.k1.hdfs.useLocalTimeStamp=true

    #是否产生新文件。
    a1.sinks.k1.hdfs.rollInterval=10
    a1.sinks.k1.hdfs.rollSize=10
    a1.sinks.k1.hdfs.rollCount=3

    a1.channels.c1.type=memory

    a1.sources.r1.channels = c1
    a1.sinks.k1.channel = c1

2.hive
    略

3.hbase
    a1.sources = r1
    a1.channels = c1
    a1.sinks = k1

    a1.sources.r1.type = netcat
    a1.sources.r1.bind = localhost
    a1.sources.r1.port = 8888

    a1.sinks.k1.type = hbase
    a1.sinks.k1.table = ns1:t12
    a1.sinks.k1.columnFamily = f1
    a1.sinks.k1.serializer = org.apache.flume.sink.hbase.RegexHbaseEventSerializer

    a1.channels.c1.type=memory

    a1.sources.r1.channels = c1
    a1.sinks.k1.channel = c1

4.kafka
</code></pre><p>数据进入到源里面去，最终进入通道里面，有很多通道c1,c2,c3，这个取决于通道选择器，ChannelProcessor，对事件进行处理，先经过一堆拦截器也是有很多种 。拦截器在各个文件前加东西，拦截之后再回到选择器。拦截器是典型的批处理，把加到东西流水线似的加到头文件里面。不管是什么对象，通过什么source进来的，都被转换成envent对象。在拦截器这个地方是链式技术。把事件放到通道里面，每个通道放置事件都是一个事务，保证能成功，</p>
<p>这个图是source到通道的图<br><img src="https://i.imgur.com/bzQZ9yK.png" alt=""></p>
<p>sink的图：</p>
<p><img src="https://i.imgur.com/sb3F2lg.png" alt=""></p>
<h2 id="使用avroSource和AvroSink实现跃点agent处理"><a href="#使用avroSource和AvroSink实现跃点agent处理" class="headerlink" title="使用avroSource和AvroSink实现跃点agent处理"></a>使用avroSource和AvroSink实现跃点agent处理</h2><pre><code>1.创建配置文件
    [avro_hop.conf]
    #a1
    a1.sources = r1
    a1.sinks= k1
    a1.channels = c1

    a1.sources.r1.type=netcat
    a1.sources.r1.bind=localhost
    a1.sources.r1.port=8888

    a1.sinks.k1.type = avro
    a1.sinks.k1.hostname=localhost
    a1.sinks.k1.port=9999

    a1.channels.c1.type=memory

    a1.sources.r1.channels = c1
    a1.sinks.k1.channel = c1

    #a2
    a2.sources = r2
    a2.sinks= k2
    a2.channels = c2

    a2.sources.r2.type=avro
    a2.sources.r2.bind=localhost
    a2.sources.r2.port=9999

    a2.sinks.k2.type = logger

    a2.channels.c2.type=memory

    a2.sources.r2.channels = c2
    a2.sinks.k2.channel = c2

2.启动a2
    $&gt;flume-ng agent -f /soft/flume/conf/avro_hop.conf -n a2 -Dflume.root.logger=INFO,console

3.验证a2
    $&gt;netstat -anop | grep 9999


4.启动a1
    $&gt;flume-ng agent -f /soft/flume/conf/avro_hop.conf -n a1

5.验证a1
    $&gt;netstat -anop | grep 8888
</code></pre><h2 id="channel"><a href="#channel" class="headerlink" title="channel"></a>channel</h2><pre><code>1.MemoryChannel
    略
2.FileChannel
</code></pre><p>a1.sources = r1<br>a1.sinks= k1<br>a1.channels = c1</p>
<p>a1.sources.r1.type=netcat<br>a1.sources.r1.bind=localhost<br>a1.sources.r1.port=8888</p>
<p>a1.sinks.k1.type=logger</p>
<pre><code>a1.channels.c1.type = file
a1.channels.c1.checkpointDir = /home/centos/flume/fc_check
a1.channels.c1.dataDirs = /home/centos/flume/fc_data
</code></pre><p>a1.sources.r1.channels=c1<br>a1.sinks.k1.channel=c1</p>
<h2 id="可溢出文件通道"><a href="#可溢出文件通道" class="headerlink" title="可溢出文件通道"></a>可溢出文件通道</h2><p>a1.channels = c1<br>a1.channels.c1.type = SPILLABLEMEMORY</p>
<p>#0表示禁用内存通道，等价于文件通道<br>a1.channels.c1.memoryCapacity = 0</p>
<p>#0,禁用文件通道，等价内存通道。<br>a1.channels.c1.overflowCapacity = 2000</p>
<p>a1.channels.c1.byteCapacity = 800000<br>a1.channels.c1.checkpointDir = /user/centos/flume/fc_check<br>a1.channels.c1.dataDirs = /user/centos/flume/fc_data</p>
<h2 id="创建Flume模块"><a href="#创建Flume模块" class="headerlink" title="创建Flume模块"></a>创建Flume模块</h2><pre><code>1.添加pom.xml
    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
    &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
             xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
             xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
        &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
        &lt;groupId&gt;com.it18zhang&lt;/groupId&gt;
        &lt;artifactId&gt;FluemDemo&lt;/artifactId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
        &lt;dependencies&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.apache.flume&lt;/groupId&gt;
                &lt;artifactId&gt;flume-ng-core&lt;/artifactId&gt;
                &lt;version&gt;1.7.0&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;junit&lt;/groupId&gt;
                &lt;artifactId&gt;junit&lt;/artifactId&gt;
                &lt;version&gt;4.11&lt;/version&gt;
            &lt;/dependency&gt;
        &lt;/dependencies&gt;
    &lt;/project&gt;
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2018/11/21/面试理论知识/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/21/面试理论知识/" itemprop="url">面试理论知识</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-21T21:27:01+08:00">
                2018-11-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>flume：<br>Apache Flume是一种工具/服务/数据提取机制，用于收集聚合和<br>从各种传输大量的流数据，如日志文件，事件（等等）<br>源集中数据存储。</p>
<p>Flume是一种高度可靠，分布式和可配置的工具。 它主要是为了设计的<br>将流数据（日志数据）从各种Web服务器复制到HDFS。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2018/11/19/SSM第一天/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/19/SSM第一天/" itemprop="url">SSM第一天</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-19T22:35:23+08:00">
                2018-11-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="SSM第二天"><a href="#SSM第二天" class="headerlink" title="SSM第二天"></a>SSM第二天</h1><p>三大框架的整合：</p>
<p>数据库层：<br>mybatis数据持久化层：dao在交互mybatis<br>dao:数据访问层：数据访问对象，存放简单的增删改查。每个表都有这个业务<br>service层：业务层，和dao交互，对dao的方法进行组合调用。形成套餐<br>springmvc展现层：做网页，做web开发的，springmvc应该和业务层交互，在springmvc里面的controller层和业务层交互，展现的东西就是jsp做web开发做网站的，做web应用的。通过web架构来实现。springmvc就是web架构里面的一个。</p>
<p><img src="https://i.imgur.com/ygpfvcz.png" alt=""></p>
<h1 id="Mybais和数据库整合"><a href="#Mybais和数据库整合" class="headerlink" title="Mybais和数据库整合"></a>Mybais和数据库整合</h1><p><img src="https://i.imgur.com/M8K3Sqr.png" alt=""></p>
<p>1.在pom中添加依赖：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;com.it18zhang&lt;/groupId&gt;
    &lt;artifactId&gt;SpringmybatisDemo&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
            &lt;version&gt;4.11&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
            &lt;version&gt;3.4.6&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;mysql&lt;/groupId&gt;
            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
            &lt;version&gt;5.1.17&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.mchange&lt;/groupId&gt;
            &lt;artifactId&gt;c3p0&lt;/artifactId&gt;
            &lt;version&gt;0.9.5.2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt;
            &lt;version&gt;4.3.3.RElEASE&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;
            &lt;version&gt;4.3.3.RELEASE&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;    
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-aop&lt;/artifactId&gt;
            &lt;version&gt;4.3.3.RELEASE&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
        &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
        &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;
        &lt;version&gt;1.1.0&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;
</code></pre><p>2.创建包</p>
<pre><code>com.it18zhang.springmybatis.dao
com.it18zhang.springmybatis.service
com.it18zhang.springmybatis.utils
</code></pre><p>3.配置beans.xml在source下</p>
<hr>
<p>坑爹的错误：</p>
<p><img src="https://i.imgur.com/pu7CMME.png" alt=""></p>
<p>在上图的情下，看见下面的mybtis-spring是依赖于mybatis3.1.0，而上面有一个跟他一模一样的包，所以到下面这块，下面的这个版本的包就看不出来了。所以如果有的类仅仅是在下面这个版本下才有的，需要把上面的第一个包先删除掉。因为它只显示第一个依赖的包</p>
<h2 id="复杂应用"><a href="#复杂应用" class="headerlink" title="复杂应用"></a>复杂应用</h2><pre><code>1.准备数据
    sql.sql

2.创建java类.
    [Order.java]
    public class Order {
        private Integer id ;
        private String orderNo ;
        //简历关联关系
        private User user ;

        //get/set
    }

    [Item.java]
    public class Item {
        private Integer id;
        private String itemName;
        //订单项和订单之间的关联关系
        private Order order;
        //get/set
    }

3.创建Order映射文件
    [resource/OrderMapper.xml]
    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
    &lt;!DOCTYPE mapper
            PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
            &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;
    &lt;mapper namespace=&quot;orders&quot;&gt;
        &lt;insert id=&quot;insert&quot;&gt;
          insert into orders(orderno,uid) values(#{orderNo},#{user.id})
        &lt;/insert&gt;

        &lt;!-- findById --&gt;
        &lt;select id=&quot;selectOne&quot; parameterType=&quot;int&quot; resultMap=&quot;RM_Order&quot;&gt;
          select
            o.id oid ,
            o.orderno oorderno ,
            o.uid uid ,
            u.name uname ,
            u.age uage
          from orders o
            left outer join users u on o.uid = u.id where o.id = #{id}
        &lt;/select&gt;
        &lt;!-- findAll --&gt;
        &lt;select id=&quot;selectAll&quot; resultMap=&quot;RM_Order&quot;&gt;
          select
            o.id oid ,
            o.orderno oorderno ,
            o.uid uid ,
            u.name uname ,
            u.age uage
          from orders o
            left outer join users u on o.uid = u.id
        &lt;/select&gt;
        &lt;!-- 自定义结果映射 --&gt;
        &lt;resultMap id=&quot;RM_Order&quot; type=&quot;com.it18zhang.mybatisdemo.domain.Order&quot;&gt;
            &lt;id property=&quot;id&quot; column=&quot;oid&quot;/&gt;
            &lt;result property=&quot;orderNo&quot; column=&quot;oorderno&quot;/&gt;
            &lt;association property=&quot;user&quot; javaType=&quot;com.it18zhang.mybatisdemo.domain.User&quot;&gt;
                &lt;id property=&quot;id&quot; column=&quot;uid&quot; /&gt;
                &lt;result property=&quot;name&quot; column=&quot;uname&quot; /&gt;
                &lt;result property=&quot;age&quot; column=&quot;uage&quot; /&gt;
            &lt;/association&gt;
        &lt;/resultMap&gt;
    &lt;/mapper&gt;

4.修改配置文件,添加映射。
    [resource/mybatis-config.xml]
    &lt;!-- 引入映射文件 --&gt;
    &lt;mappers&gt;
        &lt;mapper resource=&quot;*Mapper.xml&quot;/&gt;
    &lt;/mappers&gt;

5.测试类
    public class TestOrder {

        /**
         * insert
         */
        @Test
        public void insert() throws Exception {
            String resource = &quot;mybatis-config.xml&quot;;
            InputStream inputStream = Resources.getResourceAsStream(resource);
            SqlSessionFactory sf = new SqlSessionFactoryBuilder().build(inputStream);
            SqlSession s = sf.openSession();

            User u = new User();
            u.setId(2);

            Order o = new Order();
            o.setOrderNo(&quot;No005&quot;);
            o.setUser(u);

            s.insert(&quot;orders.insert&quot;,o);
            s.commit();
            s.close();
        }

        @Test
        public void selectOne() throws Exception {
            String resource = &quot;mybatis-config.xml&quot;;
            InputStream inputStream = Resources.getResourceAsStream(resource);
            SqlSessionFactory sf = new SqlSessionFactoryBuilder().build(inputStream);
            SqlSession s = sf.openSession();
            Order order = s.selectOne(&quot;orders.selectOne&quot;,1);
            System.out.println(order.getOrderNo());
            s.commit();
            s.close();
        }

        @Test
        public void selectAll() throws Exception {
            String resource = &quot;mybatis-config.xml&quot;;
            InputStream inputStream = Resources.getResourceAsStream(resource);
            SqlSessionFactory sf = new SqlSessionFactoryBuilder().build(inputStream);
            SqlSession s = sf.openSession();
            List&lt;Order&gt; list = s.selectList(&quot;orders.selectAll&quot;);
            for(Order o : list){
                System.out.println(o.getOrderNo() + &quot; : &quot; + o.getUser().getName());
            }
            s.commit();
            s.close();
        }
    }
</code></pre><h2 id="配置一对多"><a href="#配置一对多" class="headerlink" title="配置一对多"></a>配置一对多</h2><pre><code>1.在User中增加orders集合。
    public class User {
        ...
        private List&lt;Order&gt; orders ;
        //get/set
    }

2.改造UserMapper.xml
</code></pre><h2 id="组合多对一和一对多关联关系到一个实体-Order-中"><a href="#组合多对一和一对多关联关系到一个实体-Order-中" class="headerlink" title="组合多对一和一对多关联关系到一个实体(Order)中"></a>组合多对一和一对多关联关系到一个实体(Order)中</h2><pre><code>1.关系
    Order(*) -&gt; (1)User
    Order(1) -&gt; (*)Item

2.Order.java
    class Order{
        ...
        List&lt;Item&gt; items ;
        //get/set    
    }
2&apos;.修改配置文件增加别名
    [resources/mybatis-config.xml]
    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
    &lt;!DOCTYPE configuration
            PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;
            &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;
    &lt;configuration&gt;
        &lt;typeAliases&gt;
            &lt;typeAlias type=&quot;com.it18zhang.mybatisdemo.domain.User&quot; alias=&quot;_User&quot;/&gt;
            &lt;typeAlias type=&quot;com.it18zhang.mybatisdemo.domain.Order&quot; alias=&quot;_Order&quot;/&gt;
            &lt;typeAlias type=&quot;com.it18zhang.mybatisdemo.domain.Item&quot; alias=&quot;_Item&quot;/&gt;
        &lt;/typeAliases&gt;
        &lt;environments default=&quot;development&quot;&gt;
            &lt;environment id=&quot;development&quot;&gt;
                &lt;transactionManager type=&quot;JDBC&quot;/&gt;
                &lt;dataSource type=&quot;POOLED&quot;&gt;
                    &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;
                    &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/mybatis&quot;/&gt;
                    &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;
                    &lt;property name=&quot;password&quot; value=&quot;root&quot;/&gt;
                &lt;/dataSource&gt;
            &lt;/environment&gt;
        &lt;/environments&gt;
        &lt;!-- 引入映射文件 --&gt;
        &lt;mappers&gt;
            &lt;mapper resource=&quot;UserMapper.xml&quot;/&gt;
            &lt;mapper resource=&quot;OrderMapper.xml&quot;/&gt;
        &lt;/mappers&gt;
    &lt;/configuration&gt;

3.OrderMapper.xml
    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
    &lt;!DOCTYPE mapper
            PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
            &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;
    &lt;mapper namespace=&quot;orders&quot;&gt;
        &lt;insert id=&quot;insert&quot;&gt;
          insert into orders(orderno,uid) values(#{orderNo},#{user.id})
        &lt;/insert&gt;

        &lt;!-- findById --&gt;
        &lt;select id=&quot;selectOne&quot; parameterType=&quot;int&quot; resultMap=&quot;RM_Order&quot;&gt;
          select
            o.id      oid ,
            o.orderno oorderno ,
            o.uid     uid ,
            u.name    uname ,
            u.age     uage ,
            i.id      iid,
            i.itemname iitemname
          from orders o
            left outer join users u on o.uid = u.id
            left outer join items i on o.id = i.oid
          where o.id = #{id}
        &lt;/select&gt;
        &lt;!-- findAll --&gt;
        &lt;select id=&quot;selectAll&quot; resultMap=&quot;RM_Order&quot;&gt;
          select
            o.id      oid ,
            o.orderno oorderno ,
            o.uid     uid ,
            u.name    uname ,
            u.age     uage ,
            i.id      iid,
            i.itemname iitemname
          from orders o
            left outer join users u on o.uid = u.id
            left outer join items i on o.id = i.oid
        &lt;/select&gt;
        &lt;!-- 自定义结果映射 --&gt;
        &lt;resultMap id=&quot;RM_Order&quot; type=&quot;com.it18zhang.mybatisdemo.domain.Order&quot;&gt;
            &lt;id property=&quot;id&quot; column=&quot;oid&quot;/&gt;
            &lt;result property=&quot;orderNo&quot; column=&quot;oorderno&quot;/&gt;
            &lt;association property=&quot;user&quot; javaType=&quot;com.it18zhang.mybatisdemo.domain.User&quot;&gt;
                &lt;id property=&quot;id&quot; column=&quot;uid&quot; /&gt;
                &lt;result property=&quot;name&quot; column=&quot;uname&quot; /&gt;
                &lt;result property=&quot;age&quot; column=&quot;uage&quot; /&gt;
            &lt;/association&gt;
            &lt;collection property=&quot;items&quot; ofType=&quot;_Item&quot;&gt;
                &lt;id property=&quot;id&quot; column=&quot;iid&quot; /&gt;
                &lt;result property=&quot;itemName&quot; column=&quot;iitemname&quot; /&gt;
            &lt;/collection&gt;
        &lt;/resultMap&gt;
    &lt;/mapper&gt;

4.测试
    @Test
    public void selectOne() throws Exception {
        String resource = &quot;mybatis-config.xml&quot;;
        InputStream inputStream = Resources.getResourceAsStream(resource);
        SqlSessionFactory sf = new SqlSessionFactoryBuilder().build(inputStream);
        SqlSession s = sf.openSession();
        Order order = s.selectOne(&quot;orders.selectOne&quot;,1);
        System.out.println(order.getOrderNo() + order.getUser().getName());
        for(Item i : order.getItems()){
            System.out.println(i.getId() + &quot;:&quot; + i.getItemName());
        }
        s.commit();
        s.close();
    }
</code></pre><h2 id="改造项目"><a href="#改造项目" class="headerlink" title="改造项目"></a>改造项目</h2><pre><code>1.引入Util类
    package com.it18zhang.mybatisdemo.util;

    import org.apache.ibatis.io.Resources;
    import org.apache.ibatis.session.SqlSession;
    import org.apache.ibatis.session.SqlSessionFactory;
    import org.apache.ibatis.session.SqlSessionFactoryBuilder;

    import java.io.InputStream;

    /**
     * 工具类
     */
    public class Util {
        //
        private static SqlSessionFactory sf ;

        static{
            try {
                String resource = &quot;mybatis-config.xml&quot;;
                InputStream inputStream = Resources.getResourceAsStream(resource);
                sf = new SqlSessionFactoryBuilder().build(inputStream);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }

        /**
         * 开启会话
         */
        public static SqlSession openSession(){
            return sf.openSession() ;
        }

        /**
         * 关闭会话
         */
        public static void closeSession(SqlSession s){
            if(s != null){
                s.close();
            }
        }


        /**
         * 关闭会话
         */
        public static void rollbackTx(SqlSession s) {
            if (s != null) {
                s.rollback();
            }
        }
    }

2.设计模板类DaoTemplate和回调MybatisCallback接口
    [DaoTemplate.java]
    package com.it18zhang.mybatisdemo.dao;

    import com.it18zhang.mybatisdemo.util.Util;
    import org.apache.ibatis.session.SqlSession;

    /**
     * 模板类
     */
    public class DaoTemplate {
        /**
         * 执行
         */
        public static Object execute(MybatisCallback cb){
            SqlSession s = null;
            try {
                s = Util.openSession();
                Object ret = cb.doInMybatis(s);
                s.commit();
                return ret ;
            } catch (Exception e) {
                Util.rollbackTx(s);
            } finally {
                Util.closeSession(s);
            }
            return null ;
        }
    }

    [MybatisCallback.java]
    package com.it18zhang.mybatisdemo.dao;

    import org.apache.ibatis.session.SqlSession;

    /**
     * 回调接口
     */
    public interface MybatisCallback {
        public Object doInMybatis(SqlSession s);
    }

3.通过模板类+回调接口实现UserDao.java
    [UserDao.java]
    package com.it18zhang.mybatisdemo.dao;

    import com.it18zhang.mybatisdemo.domain.User;
    import com.it18zhang.mybatisdemo.util.Util;
    import org.apache.ibatis.session.SqlSession;

    import java.util.List;

    /**
     * UserDao
     */
    public class UserDao {

        /**
         * 插入操作
         */
        public void insert(final User user){
            DaoTemplate.execute(new MybatisCallback() {
                public Object doInMybatis(SqlSession s) {
                    s.insert(&quot;users.insert&quot;,user);
                    return null ;
                }
            });
        }

        /**
         * 插入操作
         */
        public void update(final User user){
            DaoTemplate.execute(new MybatisCallback() {
                public Object doInMybatis(SqlSession s) {
                    s.update(&quot;users.update&quot;, user);
                    return null ;
                }
            });
        }

        public User selctOne(final Integer id){
            return (User)DaoTemplate.execute(new MybatisCallback() {
                public Object doInMybatis(SqlSession s) {
                    return s.selectOne(&quot;users.selectOne&quot;,id);
                }
            });
        }

        public List&lt;User&gt; selctAll(){
            return (List&lt;User&gt;)DaoTemplate.execute(new MybatisCallback() {
                public Object doInMybatis(SqlSession s) {
                    return s.selectList(&quot;users.selectAll&quot;);
                }
            });
        }
    }

4.App测试
    public static void main(String[] args) {
        UserDao dao = new UserDao();
        User u = dao.selctOne(1);
        System.out.println(u.getName());
    }
</code></pre><hr>
<p>回调接口的一个画图分析：<br><img src="https://i.imgur.com/DufbOjZ.png" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/touxiang.jpg"
                alt="Eric Hunn" />
            
              <p class="site-author-name" itemprop="name">Eric Hunn</p>
              <p class="site-description motion-element" itemprop="description">大数据|动漫迷|科技控</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">68</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">15</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">104</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/erichunn" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:erichunn.me@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/u/2944687303/home?wvr=5" target="_blank" title="Webibo">
                      
                        <i class="fa fa-fw fa-weibo"></i>Webibo</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://github.com/drakeet/" title="Drakeet" target="_blank">Drakeet</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      
	  
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1311545319&auto=1&height=66"></iframe>

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Eric Hunn</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
