<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="无心是一首歌" type="application/atom+xml" />






<meta name="description" content="大数据|动漫迷|科技控">
<meta property="og:type" content="website">
<meta property="og:title" content="无心是一首歌">
<meta property="og:url" content="http://erichunn.github.io/index.html">
<meta property="og:site_name" content="无心是一首歌">
<meta property="og:description" content="大数据|动漫迷|科技控">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="无心是一首歌">
<meta name="twitter:description" content="大数据|动漫迷|科技控">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: 'undefined',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://erichunn.github.io/"/>





  <title>无心是一首歌</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?02fe19ac065353167cab1b453f2909ec";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">无心是一首歌</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-首页">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-关于我">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于我
          </a>
        </li>
      
        
        <li class="menu-item menu-item-标签">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-分类">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-归档">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-站点地图">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-腾讯公益">
          <a href="/404/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            腾讯公益
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2019/11/09/Springboot/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/09/Springboot/" itemprop="url">Springboot</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-09T23:01:15+08:00">
                2019-11-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>首先构建一个springboot，需要注意的一点，在下面这个地方不能用default应该用Http://sstart.spring.io<br><img src="https://i.imgur.com/RkpIOlk.png" alt=""></p>
<p><img src="https://i.imgur.com/pPqhL2V.png" alt=""></p>
<hr>
<p>里面的依赖通过parent继承，Parent里面都是写好的依赖。</p>
<p>starter-web把spring和springmvc都已经包好了</p>
<p>Springboot的入口类的@SpringBootApplication这个注解是声明该类是一个springboot的引导类，通过这个注解可以实现很多功能，比如；</p>
<p><img src="https://i.imgur.com/2R3FndU.png" alt=""></p>
<p>上面这个图片就是显示@SpringBootApplication这个类里面的原注解，主要的就是下面的三个@SpringBootConfiguration这个是相当于Configuration一样，就是标注改类是Spring的配置类，@EnableAutoConfiguration这个是自动注入配置，@ComponentScan这个是组件扫描，也就是跟这个文件统一同一个级别下的都会被扫描。</p>
<p>这三个注解主要是自动注入配置比较麻烦，下面看一下源码：<br><img src="https://i.imgur.com/ZjTotQa.png" alt=""></p>
<p>这个Import是当前这个注解下引入其他配置，然后定位到这一行，引入其他的配置：</p>
<p><img src="https://i.imgur.com/4hfBAch.png" alt=""></p>
<p>然后再进去定位到这一样：<br><img src="https://i.imgur.com/1AKBq3i.png" alt=""><br>这就不用进去了，因为进去里面很麻烦，所以可以往下面两行去看如果是当前出问题的话就暴露信息No auto Configuration classes found in META-INF….这个就是没有在META-INF下面发现。默认就在当前的jar包下面。也就是org.springframework.boot.autoconfigure里面<br><img src="https://i.imgur.com/9cwI46N.png" alt=""><br>通过这个里面的配置可以使用springboot首先里面的自动配置。</p>
<p>然后发现一行熟悉的内容，通过下面这个进去到这个类里面：<br><img src="https://i.imgur.com/CbQphdE.png" alt=""><br>在定位到这一行：<br><img src="https://i.imgur.com/8V1inUu.png" alt=""><br>进入到里面就是这样：<br><img src="https://i.imgur.com/I1mUJ77.png" alt=""><br>这个就是通过sever.port来配置的，那这个value在哪里呢？</p>
<p>就在这个里面<br><img src="https://i.imgur.com/yCFgYRY.png" alt=""></p>
<p>springboot自动配置注解@autoEnconfiguration这个注解的底层就是配置这个文件：</p>
<p><img src="https://i.imgur.com/HMEXNmb.png" alt=""></p>
<p>这个文件我们可以通过配置把里面的内容覆盖。那么在哪里覆盖呢？</p>
<p>在这里面有一个加载配置文件的地方。在Yml或者properties配置即可。</p>
<p><img src="https://i.imgur.com/Iuta9Ab.png" alt=""></p>
<p>可以在resources目录下面配置properties文件修改配置。</p>
<p><img src="https://i.imgur.com/QyJlqed.png" alt=""></p>
<hr>
<h1 id="Springboot配置文件"><a href="#Springboot配置文件" class="headerlink" title="Springboot配置文件"></a>Springboot配置文件</h1><p>配置文件有一个加载顺序，先加载yml在加载Yaml最后加载Properties<br><img src="https://i.imgur.com/OiAv8IE.png" alt=""></p>
<h2 id="在yaml文件中添加配置：和配置的写法"><a href="#在yaml文件中添加配置：和配置的写法" class="headerlink" title="在yaml文件中添加配置：和配置的写法"></a>在yaml文件中添加配置：和配置的写法</h2><pre><code>#普通数据的配置
name: zhangsan
#对象的配置
person:
  name: zhnagsan
  age: 18
  addr: beijing

#  对象行内配置，和上面一样只不过配置在一行了
person1: {name: zhangsan,age: 18,addr: beijing}
#端口配置
server:
  port: 8082
#  集合或者数组的配置(普通字符串)
city:
  - beijing
  - tianjin
  - chongqing

city1: [bijing,tiananjin,chongqing]
#配置数据、集合（对象是数据）studeng下面就是一个对象，三个属性
student:
  - name: tom
    age: 18
    addr: beijing
  - name: luccy
    age: 19
    addr: tianjin
#    这种也有一行的情况
student1: [{name: tom,age: 18 ,addr: beijing},{name: luccy,age: 13 ,addr: nanjing}]
#关于map的集合
map:
  key1: value1
  key2: value2
</code></pre><hr>
<p>、<br>使用@Value注解可以拿到属性放到字段上，</p>
<pre><code>package com.itheima.controller;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/11 23:37
 */
@Controller
public class Quick2Controller {

    @Value(&quot;${name}&quot;)
    private String name;

    @RequestMapping(&quot;/quick1&quot;)
    @ResponseBody
    public String quick2(){
//        获得内部的配置文件信息
        return &quot;name:&quot;+ name;
    }
}
</code></pre><hr>
<p>使用注解@ConfigurationProperties映射</p>
<pre><code>package com.itheima.controller;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/11 23:37
 */
@Controller
@ConfigurationProperties(prefix = &quot;person&quot;)
public class Quick3Controller {

    private String name;
    private String addr;

    //    想获得person3的全部数据
    @RequestMapping(&quot;/quick3&quot;)
    @ResponseBody
    public String quick2() {
//        获得内部的配置文件信息
        return &quot;name:&quot; + name;
    }


    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getAddr() {
        return addr;
    }

    public void setAddr(String addr) {
        this.addr = addr;
    }
}
</code></pre><hr>
<p>在Pom当中配置这个可以给出相应的提示：<br><img src="https://i.imgur.com/hbgcUKl.png" alt=""><br>安装这个之后在yml之中有这种东西：<br><img src="https://i.imgur.com/ekLv1KR.png" alt=""></p>
<p>以后程序需要配置的时候，可以先写属性，然后在在yml文件中去写配置就有相应的提示了。</p>
<hr>
<hr>
<hr>
<h1 id="Srpingboot集成"><a href="#Srpingboot集成" class="headerlink" title="Srpingboot集成"></a>Srpingboot集成</h1><h2 id="Springboot整合Mybatis"><a href="#Springboot整合Mybatis" class="headerlink" title="Springboot整合Mybatis"></a>Springboot整合Mybatis</h2><p>添加Mybatis起步依赖。</p>
<p><img src="https://i.imgur.com/gERtxsl.png" alt=""></p>
<pre><code>package com.itheima.controller;

import com.itheima.domain.User;
import com.itheima.mapper.UserMapper;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

import java.util.List;

@Controller
public class MybatisController {

    @Autowired
    private UserMapper userMapper;

    @RequestMapping(&quot;/query&quot;)
    @ResponseBody
    public List&lt;User&gt; queryUserList(){
        List&lt;User&gt; users = userMapper.queryUserList();
        return users;
    }

}
</code></pre><hr>
<pre><code>package com.itheima.domain;

public class User {

    private Long id;
    private String username;
    private String password;
    private String name;

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getUsername() {
        return username;
    }

    public void setUsername(String username) {
        this.username = username;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    @Override
    public String toString() {
        return &quot;User{&quot; +
                &quot;id=&quot; + id +
                &quot;, username=&apos;&quot; + username + &apos;\&apos;&apos; +
                &quot;, password=&apos;&quot; + password + &apos;\&apos;&apos; +
                &quot;, name=&apos;&quot; + name + &apos;\&apos;&apos; +
                &apos;}&apos;;
    }
}
</code></pre><hr>
<pre><code>package com.itheima.mapper;

import com.itheima.domain.User;
import org.apache.ibatis.annotations.Mapper;

import java.util.List;


@Mapper
public interface UserMapper {

    public List&lt;User&gt; queryUserList();

}
</code></pre><hr>
<pre><code>package com.itheima;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class SpringbootMybatisApplication {

    public static void main(String[] args) {
        SpringApplication.run(SpringbootMybatisApplication.class, args);
    }

}
</code></pre><hr>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;
&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot; &gt;
&lt;mapper namespace=&quot;com.itheima.mapper.UserMapper&quot;&gt;
    &lt;select id=&quot;queryUserList&quot; resultType=&quot;user&quot;&gt;
        select * from user
    &lt;/select&gt;
&lt;/mapper&gt;
</code></pre><hr>
<pre><code>spring.datasource.driverClassName=com.mysql.jdbc.Driver
spring.datasource.url=jdbc:mysql://127.0.0.1:3306/test?useUnicode=true&amp;characterEncoding=utf8
spring.datasource.username=root
spring.datasource.password=root

mybatis.type-aliases-package=com.itheima.domain
mybatis.mapper-locations=classpath:mapper/*Mapper.xml
</code></pre><hr>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;com.itheima&lt;/groupId&gt;
    &lt;artifactId&gt;springboot_mybatis&lt;/artifactId&gt;
    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
    &lt;packaging&gt;jar&lt;/packaging&gt;

    &lt;name&gt;springboot_mybatis&lt;/name&gt;
    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;

    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;2.0.1.RELEASE&lt;/version&gt;
        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
    &lt;/parent&gt;

    &lt;properties&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
        &lt;java.version&gt;1.8&lt;/java.version&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;!--SpingBoot集成junit测试的起步依赖--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;

        &lt;!--mybatis起步依赖--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;
            &lt;version&gt;1.1.1&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- MySQL连接驱动 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;mysql&lt;/groupId&gt;
            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
        &lt;/dependency&gt;

    &lt;/dependencies&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

&lt;/project&gt;
</code></pre><hr>
<hr>
<hr>
<p>整合jpa和redis<br><img src="https://i.imgur.com/zq4IfZo.png" alt=""><br>    package com.itheima.domain;</p>
<pre><code>import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/12 17:52
 */

//@Entity ：表明是一个实体类
@Entity
public class User {

//@Id 标注用于声明一个实体类的属性映射为数据库的主键列。该属性通常置于属性声明语句之前，可与声明语句同行，也可写在单独行上。
    @Id
//主键生成策略，因为使用Mysql所以使用IDENTITY
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    private String username;
    private String password;
    private String name;

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getUsername() {
        return username;
    }

    public void setUsername(String username) {
        this.username = username;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    @Override
    public String toString() {
        return &quot;User{&quot; +
                &quot;id=&quot; + id +
                &quot;, username=&apos;&quot; + username + &apos;\&apos;&apos; +
                &quot;, password=&apos;&quot; + password + &apos;\&apos;&apos; +
                &quot;, name=&apos;&quot; + name + &apos;\&apos;&apos; +
                &apos;}&apos;;
    }
}
</code></pre><hr>
<pre><code>package com.itheima.repository;

import com.itheima.domain.User;
import org.springframework.data.jpa.repository.JpaRepository;

import java.util.List;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/12 17:56
 */
public interface UserRepository extends JpaRepository&lt;User,Long&gt; {

    /**
     *
     * @return
     */
    public List&lt;User&gt; findAll();

}
</code></pre><hr>
<pre><code>package com.itheima;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class SpringbootJpaApplication {

    public static void main(String[] args) {
        SpringApplication.run(SpringbootJpaApplication.class, args);
    }

}
</code></pre><hr>
<pre><code>#DB Configuration:
spring.datasource.driverClassName=com.mysql.jdbc.Driver
spring.datasource.url=jdbc:mysql://127.0.0.1:3306/test?useUnicode=true&amp;characterEncoding=utf8
spring.datasource.username=root
spring.datasource.password=root

#JPA Configuration:
spring.jpa.database=MySQL
spring.jpa.show-sql=true
spring.jpa.generate-ddl=true
spring.jpa.hibernate.ddl-auto=update
spring.jpa.hibernate.naming_strategy=org.hibernate.cfg.ImprovedNamingStrategy

#Redis
spring.redis.host=127.0.0.1
spring.redis.port=6379
</code></pre><hr>
<pre><code>package com.itheima;

import com.itheima.domain.User;
import com.itheima.repository.UserRepository;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

import javax.swing.*;
import java.util.List;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/12 18:00
 */
@RunWith(SpringRunner.class)
@SpringBootTest(classes = SpringbootJpaApplication.class)
public class JPATest {

//    测试userrepository是否可以成功注入
    @Autowired
    private UserRepository userRepository;
    @Test
    public void test() {
        List&lt;User&gt; all = userRepository.findAll();
        System.out.println(all);
    }

}
</code></pre><hr>
<pre><code>package com.itheima;

import com.fasterxml.jackson.databind.ObjectMapper;
import com.itheima.domain.User;
import com.itheima.repository.UserRepository;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.test.context.junit4.SpringRunner;

import java.util.List;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/12 21:31
 */
@RunWith(SpringRunner.class)
@SpringBootTest(classes =SpringbootJpaApplication.class)
public class RedisTest {

    @Autowired
    private RedisTemplate&lt;String,String&gt; redisTemplate;

    @Autowired
    private UserRepository userRepository;
    @Test
    public void test() throws  Exception{
//        1从redis中获得数据，数据形式一般json字符串
        String userListJson = redisTemplate.boundValueOps(&quot;user.findAll&quot;).get();
//        2判断redis中是否存在数据
        if(null==userListJson) {
//        3判断是否存在想要数据如果不存在从数据库中查询
            List&lt;User&gt; all = userRepository.findAll();
//         4.将查询的数据存储到redis中
//          向将List集合转换成json格式的字符串，使用jackson进行一个对象和json和对象的转化
            ObjectMapper objectMapper = new ObjectMapper();
            userListJson = objectMapper.writeValueAsString(all);
            redisTemplate.boundValueOps(&quot;user.findAll&quot;).set(userListJson);
            System.out.println(&quot;=====================从数据库中获得user的数据==================&quot;);
        }else{
            System.out.println(&quot;===================从redis缓存中获得数据===============&quot;);
        }
//        4、将数据在控制台打印
         System.out.println(userListJson);
//
    }
}
</code></pre><hr>
<pre><code>package com.itheima;

import org.springframework.boot.test.context.SpringBootTest;

@SpringBootTest
class SpringbootJpaApplicationTests {

    void contextLoads() {
    }

}
</code></pre><hr>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;2.0.1.RELEASE&lt;/version&gt;
        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
    &lt;/parent&gt;
    &lt;groupId&gt;com.itheima&lt;/groupId&gt;
    &lt;artifactId&gt;springboot_jpa&lt;/artifactId&gt;
    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
    &lt;name&gt;springboot_jpa&lt;/name&gt;
    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;

    &lt;properties&gt;
        &lt;java.version&gt;1.8&lt;/java.version&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;!--jpa起步依赖配置--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;!--mysql驱动--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;mysql&lt;/groupId&gt;
            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;!--redis--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;
        &lt;/dependency&gt;


        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
            &lt;exclusions&gt;
                &lt;exclusion&gt;
                    &lt;groupId&gt;org.junit.vintage&lt;/groupId&gt;
                    &lt;artifactId&gt;junit-vintage-engine&lt;/artifactId&gt;
                &lt;/exclusion&gt;
            &lt;/exclusions&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

&lt;/project&gt;
</code></pre><p>https://<a href="http://www.jianguoyun.com/p/DaYAQ50QnbDxBxinpJgC" title="课堂pdf笔记" target="_blank" rel="noopener">www.jianguoyun.com/p/DaYAQ50QnbDxBxinpJgC</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2019/11/08/Maven高级之父子工程SSM案例/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/08/Maven高级之父子工程SSM案例/" itemprop="url">Maven高级之父子工程SSM案例</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-08T23:34:50+08:00">
                2019-11-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Maven高级之父子工程SSM案例结合三种启动方式</p>
<p>先看一下目录结构：</p>
<p><img src="https://i.imgur.com/9S0lHP3.png" alt=""><br><img src="https://i.imgur.com/iINWgG8.png" alt=""><br><img src="https://i.imgur.com/vWJH8NI.png" alt=""></p>
<p>然后上代码：</p>
<pre><code>package com.itheima.dao;

import com.itheima.domain.Items;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/7 17:17
 */
public interface ItemsDao {
    /**
     * 根据ID查找Items
     * @param id
     * @return
     */
    public Items findById(Integer id);
}
</code></pre><hr>
<pre><code>package com.itheima.domain;

import java.util.Date;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/7 17:15
 */
public class Items {
    private Integer id;
    private String name;
    private Double price;
    private String prc;
    private Date createtime;
    private String detail;

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Double getPrice() {
        return price;
    }

    public void setPrice(Double price) {
        this.price = price;
    }

    public String getPrc() {
        return prc;
    }

    public void setPrc(String prc) {
        this.prc = prc;
    }

    public Date getCreatetime() {
        return createtime;
    }

    public void setCreatetime(Date createtime) {
        this.createtime = createtime;
    }

    public String getDetail() {
        return detail;
    }

    public void setDetail(String detail) {
        this.detail = detail;
    }

    @Override
    public String toString() {
        return &quot;items{&quot; +
                &quot;id=&quot; + id +
                &quot;, name=&apos;&quot; + name + &apos;\&apos;&apos; +
                &quot;, price=&quot; + price +
                &quot;, prc=&apos;&quot; + prc + &apos;\&apos;&apos; +
                &quot;, createtime=&quot; + createtime +
                &quot;, detail=&apos;&quot; + detail + &apos;\&apos;&apos; +
                &apos;}&apos;;
    }
}
</code></pre><hr>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE mapper
        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;

&lt;mapper namespace=&quot;com.itheima.dao.ItemsDao&quot;&gt;
&lt;!--    返回值是resulttype，因为我们事先已经把实体类中所有的属性和我们数据库中的列保持一致了
所以我们只需要写resultType就可以了，如果不一致可以写resultMap
这个地方已经改成了小写的i，这个地方既然已经写了别名了，写配置文件的时候切记要扫描POJO这个包的路径--&gt;
    &lt;select id=&quot;findById&quot; parameterType=&quot;int&quot; resultType=&quot;items&quot;&gt;
        select * from items  where id = #{id}
    &lt;/select&gt;
&lt;/mapper&gt;
</code></pre><hr>
<p>ItemsDao.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;
       xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;
       xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;
       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
                http://www.springframework.org/schema/beans/spring-beans.xsd
                http://www.springframework.org/schema/context
                http://www.springframework.org/schema/context/spring-context.xsd
                http://www.springframework.org/schema/aop
                http://www.springframework.org/schema/aop/spring-aop.xsd
                http://www.springframework.org/schema/tx
                http://www.springframework.org/schema/tx/spring-tx.xsd
                http://www.springframework.org/schema/mvc
                http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;&gt;
    &lt;!--dao层配置文件开始--&gt;
    &lt;!--配置连接池--&gt;
    &lt;bean id=&quot;dataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot;&gt;
        &lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.cj.jdbc.Driver&quot;/&gt;
        &lt;property name=&quot;url&quot;  value=&quot;jdbc:mysql://localhost:3306/maven?useUnicode=true&amp;amp;characterEncoding=utf-8&amp;amp;useSSL=false&amp;amp;serverTimezone=GMT%2B8&quot;/&gt;
        &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;
        &lt;property name=&quot;password&quot; value=&quot;root&quot;/&gt;
    &lt;/bean&gt;

    &lt;!--配置生产SqlSession对象的工厂--&gt;
    &lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;
        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt;
        &lt;!--扫描pojo包，给包下所有pojo对象起别名--&gt;
        &lt;property name=&quot;typeAliasesPackage&quot; value=&quot;com.itheima.domain&quot;/&gt;
    &lt;/bean&gt;

    &lt;!--扫描接口包路径，生成包下所有接口的代理对象，并且放入spring容器中--&gt;
    &lt;bean class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt;
        &lt;property name=&quot;basePackage&quot; value=&quot;com.itheima.dao&quot;/&gt;
    &lt;/bean&gt;
    &lt;!--dao层配置文件结束--&gt;
&lt;/beans&gt;
</code></pre><hr>
<p>dao.pom:</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;

&lt;!--    子工程可以和父工程共用groupid和version，但是他必须要有自己的artifactId，下面这套就是共用的--&gt;
    &lt;parent&gt;
        &lt;artifactId&gt;maven_day02_parent&lt;/artifactId&gt;
        &lt;groupId&gt;com.itheima&lt;/groupId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;artifactId&gt;maven_day02_dao&lt;/artifactId&gt;


&lt;/project&gt;
</code></pre><hr>
<pre><code>package com.itheima.service.impl;

import com.itheima.dao.ItemsDao;
import com.itheima.domain.Items;
import com.itheima.service.ItemService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

/**
 * 有一个公司开发的常用原则，自己写的类尽量使用注解，如果是框架使用的类，尽量使用配置文件
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/7 20:46
 */
@Service
public class ItemServiceImpl implements ItemService {
    @Autowired
    private ItemsDao itemsDao;

    public Items findById(Integer id) {
        return itemsDao.findById(id);
    }
}
</code></pre><hr>
<pre><code>package com.itheima.service;

import com.itheima.domain.Items;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/7 20:45
 */
public interface ItemService {
    public Items findById(Integer id);
}
</code></pre><hr>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;
       xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;
       xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;
       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
                http://www.springframework.org/schema/beans/spring-beans.xsd
                http://www.springframework.org/schema/context
                http://www.springframework.org/schema/context/spring-context.xsd
                http://www.springframework.org/schema/aop
                http://www.springframework.org/schema/aop/spring-aop.xsd
                http://www.springframework.org/schema/tx
                http://www.springframework.org/schema/tx/spring-tx.xsd
                http://www.springframework.org/schema/mvc
                http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;&gt;

    &lt;!--service层配置文件开始--&gt;

    &lt;!--组件扫描配置--&gt;
    &lt;context:component-scan base-package=&quot;com.itheima.service&quot;/&gt;

    &lt;!--aop面向切面编程，切面就是切入点和通知的组合--&gt;
    &lt;!--配置事务管理器--&gt;
    &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;
        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt;
    &lt;/bean&gt;
    &lt;!--配置事务的通知--&gt;
    &lt;tx:advice id=&quot;advice&quot;&gt;
        &lt;tx:attributes&gt;
            &lt;tx:method name=&quot;save*&quot; propagation=&quot;REQUIRED&quot;/&gt;
            &lt;tx:method name=&quot;update*&quot; propagation=&quot;REQUIRED&quot;/&gt;
            &lt;tx:method name=&quot;delete*&quot; propagation=&quot;REQUIRED&quot;/&gt;
            &lt;tx:method name=&quot;find*&quot; read-only=&quot;true&quot;/&gt;
            &lt;tx:method name=&quot;*&quot; propagation=&quot;REQUIRED&quot;/&gt;
        &lt;/tx:attributes&gt;
    &lt;/tx:advice&gt;

    &lt;!--配置切面--&gt;
    &lt;aop:config&gt;
        &lt;aop:pointcut id=&quot;pointcut&quot; expression=&quot;execution(* com.itheima.service.impl.*.*(..))&quot;/&gt;
        &lt;aop:advisor advice-ref=&quot;advice&quot; pointcut-ref=&quot;pointcut&quot;/&gt;
    &lt;/aop:config&gt;
    &lt;!--service层配置文件结束--&gt;
&lt;/beans&gt;
</code></pre><hr>
<p>service.pom:</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;parent&gt;
        &lt;artifactId&gt;maven_day02_parent&lt;/artifactId&gt;
        &lt;groupId&gt;com.itheima&lt;/groupId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;artifactId&gt;maven_day02_service&lt;/artifactId&gt;

&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.itheima&lt;/groupId&gt;
        &lt;artifactId&gt;maven_day02_dao&lt;/artifactId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;

&lt;/project&gt;
</code></pre><hr>
<pre><code>package com.itheima.controller;

import com.itheima.domain.Items;
import com.itheima.service.ItemService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/7 21:36
 */
@Controller
@RequestMapping(&quot;/items&quot;)
public class ItemController {
    @Autowired
    private ItemService itemsService;

    @RequestMapping(&quot;/findDetail&quot;)
    public String findDetail(Model model){
        Items items = itemsService.findById(1);
//        这个addAttribute里面参数，结合看Pages下面的jsp来看都是item.price，item.detail，说明都是用这个key来取值的。，那么就配置即可
        model.addAttribute(&quot;item&quot;,items);
        return &quot;itemDetail&quot;;
    }
}
</code></pre><hr>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;
       xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;
       xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;
       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
                http://www.springframework.org/schema/beans/spring-beans.xsd
                http://www.springframework.org/schema/context
                http://www.springframework.org/schema/context/spring-context.xsd
                http://www.springframework.org/schema/aop
                http://www.springframework.org/schema/aop/spring-aop.xsd
                http://www.springframework.org/schema/tx
                http://www.springframework.org/schema/tx/spring-tx.xsd
                http://www.springframework.org/schema/mvc
                http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;&gt;

    &lt;import resource=&quot;classpath:spring/applicationContext_dao.xml&quot;/&gt;
    &lt;import resource=&quot;classpath:spring/applicationContext_service.xml&quot;/&gt;
&lt;/beans&gt;
</code></pre><hr>
<pre><code># Set root category priority to INFO and its only appender to CONSOLE.
#log4j.rootCategory=INFO, CONSOLE            debug   info   warn error fatal
log4j.rootCategory=debug, CONSOLE, LOGFILE

# Set the enterprise logger category to FATAL and its only appender to CONSOLE.
log4j.logger.org.apache.axis.enterprise=FATAL, CONSOLE

# CONSOLE is set to be a ConsoleAppender using a PatternLayout.
log4j.appender.CONSOLE=org.apache.log4j.ConsoleAppender
log4j.appender.CONSOLE.layout=org.apache.log4j.PatternLayout
log4j.appender.CONSOLE.layout.ConversionPattern=%d{ISO8601} %-6r [%15.15t] %-5p %30.30c %x - %m\n

# LOGFILE is set to be a File appender using a PatternLayout.
log4j.appender.LOGFILE=org.apache.log4j.FileAppender
log4j.appender.LOGFILE.File=d:\axis.log
log4j.appender.LOGFILE.Append=true
log4j.appender.LOGFILE.layout=org.apache.log4j.PatternLayout
log4j.appender.LOGFILE.layout.ConversionPattern=%d{ISO8601} %-6r [%15.15t] %-5p %30.30c %x - %m\n
</code></pre><hr>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;
       xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;
       xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;
       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
                http://www.springframework.org/schema/beans/spring-beans.xsd
                http://www.springframework.org/schema/context
                http://www.springframework.org/schema/context/spring-context.xsd
                http://www.springframework.org/schema/aop
                http://www.springframework.org/schema/aop/spring-aop.xsd
                http://www.springframework.org/schema/tx
                http://www.springframework.org/schema/tx/spring-tx.xsd
                http://www.springframework.org/schema/mvc
                http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;&gt;
&lt;!--    配置组件扫描--&gt;
    &lt;context:component-scan base-package=&quot;com.itheima.controller&quot;/&gt;
&lt;!--    处理器映射器，处理器适配器--&gt;
    &lt;mvc:annotation-driven/&gt;
&lt;!--    配置视图解析器--&gt;
    &lt;bean id=&quot;internalResourceViewResolver&quot; class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;
        &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/pages/&quot;/&gt;
        &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt;
    &lt;/bean&gt;

&lt;!--    释放静态资源 凡事遇到静态资源就会默认交给deafault去处理，也就是之前写的httpservlet而不是现在的动态--&gt;
    &lt;mvc:default-servlet-handler/&gt;
&lt;/beans&gt;
</code></pre><hr>
<pre><code>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;
    pageEncoding=&quot;UTF-8&quot;%&gt;
&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot; %&gt;
&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/fmt&quot;  prefix=&quot;fmt&quot;%&gt;    

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;
&lt;title&gt;Insert title here&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt; 
    &lt;form&gt;
        &lt;table width=&quot;100%&quot; border=1&gt;
            &lt;tr&gt;
                &lt;td&gt;商品名称&lt;/td&gt;
                &lt;td&gt; ${item.name } &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;商品价格&lt;/td&gt;
                &lt;td&gt; ${item.price } &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;生成日期&lt;/td&gt;
                &lt;td&gt; &lt;fmt:formatDate value=&quot;${item.createtime}&quot; pattern=&quot;yyyy-MM-dd HH:mm:ss&quot;/&gt; &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;商品简介&lt;/td&gt;
                &lt;td&gt;${item.detail} &lt;/td&gt;
            &lt;/tr&gt;
        &lt;/table&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<pre><code>&lt;!DOCTYPE web-app
        PUBLIC &quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot;
        &quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot;&gt;

&lt;web-app xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee
          http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;
         version=&quot;3.0&quot;&gt;


  &lt;!--    首先配置编码过滤器--&gt;

  &lt;filter&gt;
    &lt;filter-name&gt;encoding&lt;/filter-name&gt;
    &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;encoding&lt;/param-name&gt;
      &lt;param-value&gt;UTF-8&lt;/param-value&gt;
    &lt;/init-param&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;forceEncoding&lt;/param-name&gt;
      &lt;param-value&gt;true&lt;/param-value&gt;
    &lt;/init-param&gt;
  &lt;/filter&gt;
  &lt;filter-mapping&gt;
    &lt;filter-name&gt;encoding&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;/filter-mapping&gt;

  &lt;!--    配置Spring核心监听器--&gt;
  &lt;listener&gt;
    &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;
  &lt;/listener&gt;
  &lt;!--    spring默认监听器只能监听WEB_INF路径下的名字叫applicationContext.xml的spring配置文件，我们的文件名称可以对上但是路径对不上
  所以我们重新指定spring配置路径--&gt;
  &lt;context-param&gt;
    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
    &lt;param-value&gt;classpath:applicationContext.xml&lt;/param-value&gt;
  &lt;/context-param&gt;


  &lt;!--    配置springmvc的核心servlet--&gt;
  &lt;servlet&gt;
    &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt;
    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
      &lt;!--            classpath的默认路径就是这个resources--&gt;
      &lt;param-value&gt;classpath:springmvc.xml&lt;/param-value&gt;
    &lt;/init-param&gt;
    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
  &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;

&lt;/web-app&gt;
</code></pre><hr>
<pre><code>&lt;html&gt;
&lt;body&gt;
&lt;h2&gt;Hello World!&lt;/h2&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<p>web.pom</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;

&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;parent&gt;
        &lt;artifactId&gt;maven_day02_parent&lt;/artifactId&gt;
        &lt;groupId&gt;com.itheima&lt;/groupId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;artifactId&gt;maven_day02_web&lt;/artifactId&gt;
    &lt;packaging&gt;war&lt;/packaging&gt;

&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.itheima&lt;/groupId&gt;
        &lt;artifactId&gt;maven_day02_service&lt;/artifactId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
&lt;/project&gt;
</code></pre><hr>
<p>parent.pom</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

&lt;!--    工程和模块的区别：
        工程不等于完整的项目，模块也不等于完整的项目，一个完整的项目看的是代码，代码完整就可以说是一个完整的项目，和工程和
        项目没关系的。--&gt;

&lt;!--    那么工程和模块啥区别呢？工程天生只能使用自己的内部资源，工程是天生独立的，后天可以和其他模块建立关联关系，模块天生是属于
父工程的，也就是模块一旦创建，所有父工程的资源都可以使用--&gt;

&lt;!--    子模块天生继承父工程，可以使用付工程所有资源，
        子模块之间天生没任何关系--&gt;

&lt;!--    父子工程之间不用建立关系，继承关系是先天的，不需要手动建立

         平级之间的关系叫依赖关系。依赖不是先天的，是需要后天建立的--&gt;
    &lt;groupId&gt;com.itheima&lt;/groupId&gt;
    &lt;artifactId&gt;maven_day02_parent&lt;/artifactId&gt;
    &lt;packaging&gt;pom&lt;/packaging&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
&lt;!--    下面有几个字模块会显示到这里--&gt;
    &lt;modules&gt;
        &lt;module&gt;maven_day02_dao&lt;/module&gt;
        &lt;module&gt;maven_day02_service&lt;/module&gt;
        &lt;module&gt;maven_day02_web&lt;/module&gt;
    &lt;/modules&gt;

        &lt;!--maven工程要导入jar包的坐标，就必须要考虑解决jar包冲突。
            解决jar包冲突的方式一：
            第一声明优先原则：哪个jar包的坐标在靠上的位置，这个jar包就是先声明的。
            先声明的jar包坐标下的依赖包，可以优先进入项目中。

            maven导入jar包中的一些概念：
            直接依赖：项目中直接导入的jar包，就是该项目的直接依赖包。
            传递依赖：项目中没有直接导入的jar包，可以通过项目直接依赖jar包传递到项目中去。

            解决jar包冲突的方式二：
            路径近者优先原则。直接依赖路径比传递依赖路径近，那么最终项目进入的jar包会是路径近的直接依赖包。

            解决jar包冲突的方式三【推荐使用】：
            直接排除法。
            当我们要排除某个jar包下依赖包，在配置exclusions标签的时候，内部可以不写版本号。
            因为此时依赖包使用的版本和默认和本jar包一样。
            --&gt;
        &lt;!-- 统一管理jar包版本 --&gt;
        &lt;properties&gt;
            &lt;spring.version&gt;5.0.2.RELEASE&lt;/spring.version&gt;
            &lt;slf4j.version&gt;1.6.6&lt;/slf4j.version&gt;
            &lt;log4j.version&gt;1.2.12&lt;/log4j.version&gt;
            &lt;shiro.version&gt;1.2.3&lt;/shiro.version&gt;
            &lt;mysql.version&gt;8.0.11&lt;/mysql.version&gt;
            &lt;mybatis.version&gt;3.4.5&lt;/mybatis.version&gt;
            &lt;spring.security.version&gt;5.0.1.RELEASE&lt;/spring.security.version&gt;
        &lt;/properties&gt;

        &lt;!--
        maven工程是可以分父子依赖关系的。
        凡是依赖别的项目后，拿到的别的项目的依赖包，都属于传递依赖。
        比如：当前A项目，被B项目依赖。那么我们A项目中所有jar包都会传递到B项目中。
        B项目开发者，如果再在B项目中导入一套ssm框架的jar包，对于B项目是直接依赖。
        那么直接依赖的jar包就会把我们A项目传递过去的jar包覆盖掉。
        为了防止以上情况的出现。我们可以把A项目中主要jar包的坐标锁住，那么其他依赖该项目的项目中，
        即便是有同名jar包直接依赖，也无法覆盖。
        --&gt;
        &lt;!-- 锁定jar包版本 --&gt;
        &lt;dependencyManagement&gt;
            &lt;dependencies&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                    &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
                    &lt;version&gt;${spring.version}&lt;/version&gt;
                &lt;/dependency&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                    &lt;artifactId&gt;spring-web&lt;/artifactId&gt;
                    &lt;version&gt;${spring.version}&lt;/version&gt;
                &lt;/dependency&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                    &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
                    &lt;version&gt;${spring.version}&lt;/version&gt;
                &lt;/dependency&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                    &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;
                    &lt;version&gt;${spring.version}&lt;/version&gt;
                &lt;/dependency&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                    &lt;artifactId&gt;spring-test&lt;/artifactId&gt;
                    &lt;version&gt;${spring.version}&lt;/version&gt;
                &lt;/dependency&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
                    &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
                    &lt;version&gt;${mybatis.version}&lt;/version&gt;
                &lt;/dependency&gt;
            &lt;/dependencies&gt;
        &lt;/dependencyManagement&gt;

        &lt;!-- 项目依赖jar包 --&gt;
        &lt;dependencies&gt;
            &lt;!-- spring --&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.aspectj&lt;/groupId&gt;
                &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;
                &lt;version&gt;1.6.8&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-aop&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-web&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-orm&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-beans&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-core&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-test&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;junit&lt;/groupId&gt;
                &lt;artifactId&gt;junit&lt;/artifactId&gt;
                &lt;version&gt;4.12&lt;/version&gt;
                &lt;scope&gt;test&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;mysql&lt;/groupId&gt;
                &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
                &lt;version&gt;${mysql.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
                &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;
                &lt;version&gt;3.1.0&lt;/version&gt;
                &lt;scope&gt;provided&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;javax.servlet.jsp&lt;/groupId&gt;
                &lt;artifactId&gt;jsp-api&lt;/artifactId&gt;
                &lt;version&gt;2.0&lt;/version&gt;
                &lt;scope&gt;provided&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;jstl&lt;/groupId&gt;
                &lt;artifactId&gt;jstl&lt;/artifactId&gt;
                &lt;version&gt;1.2&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;!-- log start --&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;log4j&lt;/groupId&gt;
                &lt;artifactId&gt;log4j&lt;/artifactId&gt;
                &lt;version&gt;${log4j.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
                &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;
                &lt;version&gt;${slf4j.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
                &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
                &lt;version&gt;${slf4j.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;!-- log end --&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
                &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
                &lt;version&gt;${mybatis.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
                &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;
                &lt;version&gt;1.3.0&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;c3p0&lt;/groupId&gt;
                &lt;artifactId&gt;c3p0&lt;/artifactId&gt;
                &lt;version&gt;0.9.1.2&lt;/version&gt;
                &lt;type&gt;jar&lt;/type&gt;
                &lt;scope&gt;compile&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt;
                &lt;artifactId&gt;pagehelper&lt;/artifactId&gt;
                &lt;version&gt;5.1.2&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
                &lt;artifactId&gt;spring-security-web&lt;/artifactId&gt;
                &lt;version&gt;${spring.security.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
                &lt;artifactId&gt;spring-security-config&lt;/artifactId&gt;
                &lt;version&gt;${spring.security.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
                &lt;artifactId&gt;spring-security-core&lt;/artifactId&gt;
                &lt;version&gt;${spring.security.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
                &lt;artifactId&gt;spring-security-taglibs&lt;/artifactId&gt;
                &lt;version&gt;${spring.security.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
                &lt;artifactId&gt;druid&lt;/artifactId&gt;
                &lt;version&gt;1.0.9&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;junit&lt;/groupId&gt;
                &lt;artifactId&gt;junit&lt;/artifactId&gt;
                &lt;version&gt;4.12&lt;/version&gt;
            &lt;/dependency&gt;

        &lt;/dependencies&gt;
            &lt;build&gt;
                &lt;plugins&gt;
                    &lt;plugin&gt;
                        &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;
                        &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;
                        &lt;version&gt;2.2&lt;/version&gt;
                    &lt;/plugin&gt;
                &lt;/plugins&gt;
            &lt;/build&gt;
    &lt;/project&gt;
</code></pre><hr>
<hr>
<hr>
<p>有三种启动方式，一种是在Parent工程里面使用插件tomcat:run来启动</p>
<p><img src="https://i.imgur.com/TcQ4bj6.png" alt=""></p>
<p>一种是在这里添加模块通过tomcat启动：</p>
<p><img src="https://i.imgur.com/MU39o1u.png" alt=""></p>
<p>还有一种是使用web的tomcat插件来启动，但是必须要在Parent的插件功能里面将三个子模块Install在本地仓库里面形成jar包，才可以。</p>
<p><img src="https://i.imgur.com/HAlG3Bx.png" alt=""></p>
<p><img src="https://i.imgur.com/33TtbB9.png" alt=""></p>
<p>为什么要这样，因为在web的Pom文件当中他使用了service的jar包。这样的话maven会首先去本地仓库去找，然后找不到的话去中央仓库，因为都没有，所以要先打成jar包扔进本地仓库才可以。</p>
<p><img src="https://i.imgur.com/PC0GQ9A.png" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2019/11/07/Maven高级/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/07/Maven高级/" itemprop="url">Maven高级</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-07T14:29:01+08:00">
                2019-11-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="https://i.imgur.com/zEkvEtg.png" alt=""></p>
<p><img src="https://i.imgur.com/dwXen5E.png" alt=""></p>
<p><img src="https://i.imgur.com/ttwZWen.png" alt=""></p>
<p>执行SQL文件导入进去了一个表和内容供这章节学习使用：</p>
<p><img src="https://i.imgur.com/CYuGZuM.png" alt=""></p>
<hr>
<h1 id="Maven导入Jar包时候依赖冲突的解决"><a href="#Maven导入Jar包时候依赖冲突的解决" class="headerlink" title="Maven导入Jar包时候依赖冲突的解决"></a>Maven导入Jar包时候依赖冲突的解决</h1><blockquote>
</blockquote>
<pre><code>Maven工程要导入Jar包的坐标，就必须考虑解决jar包的冲突
解决jar包冲突的方式一：
       第一声明优先原则：哪个Jar包的坐标靠上的位置，这个Jar包就是先声明的。
       先声明的jar包坐标下的依赖，可以有优先进入到项目当中，也就是说spring-context和spring-bean都依赖于spring-core这个，
       但是content和bean版本不同
       所以就会优先使用前面的
   解决jar包冲突的方式二：
   maven导入jar包的一些概念：
       直接依赖：项目中直接导入的jar包就是该项目的直接依赖包。
       传递依赖：项目中并没有直接导入jar包，可以通过项目直接依赖jar包传递到项目当中去
       如果有传递依赖，也有直接依赖，那么就是用最近的直接依赖
    解决jar包冲突的方式三：【推荐使用】
     直接排除法：
       当我们要排除某个依赖包下面的依赖包的时候，在配置exclusion标签的时候，内部可以不写版本号，
       因为此时依赖包使用的版本号默认和jar包一样的
</code></pre><p>在我们平时公司中使用的时候一般是复制别人的依赖包，不用在这个上面纠结太久，一旦说可能出现冲突问题，解决办法就是使用Exclusion标签做排除法，可以查看一下依赖关系，在IDEA中使用这个按钮查看</p>
<p><img src="https://i.imgur.com/nKKeTY6.png" alt=""></p>
<p><img src="https://i.imgur.com/3X7Lzg4.png" alt=""></p>
<hr>
<p>下面是常用的SSM使用的Pom文件。一般使用这些依赖包就够用了：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;

&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

  &lt;groupId&gt;com.itheima&lt;/groupId&gt;
  &lt;artifactId&gt;maven_day02_1&lt;/artifactId&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;packaging&gt;war&lt;/packaging&gt;

  &lt;!-- 统一管理jar包版本 --&gt;
  &lt;properties&gt;
    &lt;spring.version&gt;5.0.2.RELEASE&lt;/spring.version&gt;
    &lt;slf4j.version&gt;1.6.6&lt;/slf4j.version&gt;
    &lt;log4j.version&gt;1.2.12&lt;/log4j.version&gt;
    &lt;shiro.version&gt;1.2.3&lt;/shiro.version&gt;
    &lt;mysql.version&gt;5.1.6&lt;/mysql.version&gt;
    &lt;mybatis.version&gt;3.4.5&lt;/mybatis.version&gt;
    &lt;spring.security.version&gt;5.0.1.RELEASE&lt;/spring.security.version&gt;
  &lt;/properties&gt;

  &lt;!--
  maven工程是可以分父子依赖关系的。
  凡是依赖别的项目后，拿到的别的项目的依赖包，都属于传递依赖。
  比如：当前A项目，被B项目依赖。那么我们A项目中所有jar包都会传递到B项目中。
  B项目开发者，如果再在B项目中导入一套ssm框架的jar包，对于B项目是直接依赖。
  那么直接依赖的jar包就会把我们A项目传递过去的jar包覆盖掉。
  为了防止以上情况的出现。我们可以把A项目中主要jar包的坐标锁住，那么其他依赖该项目的项目中，
  即便是有同名jar包直接依赖，也无法覆盖。
  --&gt;
  &lt;!-- 锁定jar包版本 --&gt;
  &lt;dependencyManagement&gt;
    &lt;dependencies&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
        &lt;version&gt;${spring.version}&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-web&lt;/artifactId&gt;
        &lt;version&gt;${spring.version}&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
        &lt;version&gt;${spring.version}&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;
        &lt;version&gt;${spring.version}&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-test&lt;/artifactId&gt;
        &lt;version&gt;${spring.version}&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
        &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
        &lt;version&gt;${mybatis.version}&lt;/version&gt;
      &lt;/dependency&gt;
    &lt;/dependencies&gt;
  &lt;/dependencyManagement&gt;

  &lt;!-- 项目依赖jar包 --&gt;
  &lt;dependencies&gt;
    &lt;!-- spring --&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.aspectj&lt;/groupId&gt;
      &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;
      &lt;version&gt;1.6.8&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
      &lt;artifactId&gt;spring-aop&lt;/artifactId&gt;
      &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
      &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
      &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
      &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt;
      &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
      &lt;artifactId&gt;spring-web&lt;/artifactId&gt;
      &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
      &lt;artifactId&gt;spring-orm&lt;/artifactId&gt;
      &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
      &lt;artifactId&gt;spring-beans&lt;/artifactId&gt;
      &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
      &lt;artifactId&gt;spring-core&lt;/artifactId&gt;
      &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
      &lt;artifactId&gt;spring-test&lt;/artifactId&gt;
      &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
      &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
      &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
      &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;
      &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;junit&lt;/groupId&gt;
      &lt;artifactId&gt;junit&lt;/artifactId&gt;
      &lt;version&gt;4.12&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;mysql&lt;/groupId&gt;
      &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
      &lt;version&gt;${mysql.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
      &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;
      &lt;version&gt;3.1.0&lt;/version&gt;
      &lt;scope&gt;provided&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;javax.servlet.jsp&lt;/groupId&gt;
      &lt;artifactId&gt;jsp-api&lt;/artifactId&gt;
      &lt;version&gt;2.0&lt;/version&gt;
      &lt;scope&gt;provided&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;jstl&lt;/groupId&gt;
      &lt;artifactId&gt;jstl&lt;/artifactId&gt;
      &lt;version&gt;1.2&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;!-- log start --&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;log4j&lt;/groupId&gt;
      &lt;artifactId&gt;log4j&lt;/artifactId&gt;
      &lt;version&gt;${log4j.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
      &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;
      &lt;version&gt;${slf4j.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
      &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
      &lt;version&gt;${slf4j.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;!-- log end --&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
      &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
      &lt;version&gt;${mybatis.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
      &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;
      &lt;version&gt;1.3.0&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;c3p0&lt;/groupId&gt;
      &lt;artifactId&gt;c3p0&lt;/artifactId&gt;
      &lt;version&gt;0.9.1.2&lt;/version&gt;
      &lt;type&gt;jar&lt;/type&gt;
      &lt;scope&gt;compile&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt;
      &lt;artifactId&gt;pagehelper&lt;/artifactId&gt;
      &lt;version&gt;5.1.2&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
      &lt;artifactId&gt;spring-security-web&lt;/artifactId&gt;
      &lt;version&gt;${spring.security.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
      &lt;artifactId&gt;spring-security-config&lt;/artifactId&gt;
      &lt;version&gt;${spring.security.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
      &lt;artifactId&gt;spring-security-core&lt;/artifactId&gt;
      &lt;version&gt;${spring.security.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
      &lt;artifactId&gt;spring-security-taglibs&lt;/artifactId&gt;
      &lt;version&gt;${spring.security.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
      &lt;artifactId&gt;druid&lt;/artifactId&gt;
      &lt;version&gt;1.0.9&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;junit&lt;/groupId&gt;
      &lt;artifactId&gt;junit&lt;/artifactId&gt;
      &lt;version&gt;4.12&lt;/version&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
  &lt;!-- 添加tomcat7插件 --&gt;
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;
        &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.2&lt;/version&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;
</code></pre><hr>
<p>maven工程是可以分成父子关系的，一个项目可以依赖另外一个项目，凡事依赖别人的项目后，拿到的别人的I项目依赖之后都属于传递依赖。</p>
<p>比如当前A项目被B项目依赖，那么我们A项目中所有的Jar包都会传递到B项目中。B项目中得到的项目依赖都属于传递依赖。可能A项目是比较新的项目，但是B项目用的是比较老的依赖。B项目开发者如果再在B项目中导入一套SSM框架的依赖包，对于B项目就是直接依赖。那么直接依赖的jar包就会把我们A项目传递过去的jar包覆盖掉。为了防止这种情况出现，我们可以把A项目中的主要jar包的坐标锁定住，那么其他依赖该项目的项目中即便是有同名jar包直接依赖也无法覆盖。</p>
<dependencymanagement></dependencymanagement>这个标签起到了一个锁定的作用。但是仅仅是锁定作用，没有导入坐标作用，还是得需要<denpenedies>解决导入jar包。<br><br>上面这段SSM的依赖通过EL表达式，把配置文件都卸载上面来统一管理jar包版本。<br><br><strong>*<br># 案例一整套SSM的编写 #<br><br>    package com.itheima.controller;<br><br>    import com.itheima.domain.Items;<br>    import com.itheima.service.ItemService;<br>    import org.springframework.beans.factory.annotation.Autowired;<br>    import org.springframework.stereotype.Controller;<br>    import org.springframework.ui.Model;<br>    import org.springframework.web.bind.annotation.RequestMapping;<br><br>    /</strong><br>     <em> @Description TODO
     </em> @Author TT Hun<br>     <em> @Data 2019/11/7 21:36
     </em>/<br>    @Controller<br>    @RequestMapping(“/items”)<br>    public class ItemController {<br>        @Autowired<br>        private ItemService itemsService;<br><br>        @RequestMapping(“/findDetail”)<br>        public String findDetail(Model model){<br>            Items items = itemsService.findById(1);<br>    //        这个addAttribute里面参数，结合看Pages下面的jsp来看都是item.price，item.detail，说明都是用这个key来取值的。，那么就配置即可<br>            model.addAttribute(“item”,items);<br>            return “itemDetail”;<br>        }<br>    }<br><strong>*<br>    package com.itheima.dao;<br><br>    import com.itheima.domain.Items;<br><br>    /</strong><br>     <em> @Description TODO
     </em> @Author TT Hun<br>     <em> @Data 2019/11/7 17:17
     </em>/<br>    public interface ItemsDao {<br>        /<strong><br>         <em> 根据ID查找Items
         </em> @param id<br>         <em> @return
         </em>/<br>        public Items findById(Integer id);<br>    }<br><br>*</strong><br>    package com.itheima.domain;<br><br>    import java.util.Date;<br><br>    /<strong><br>     <em> @Description TODO
     </em> @Author TT Hun<br>     <em> @Data 2019/11/7 17:15
     </em>/<br>    public class Items {<br>        private Integer id;<br>        private String name;<br>        private Double price;<br>        private String prc;<br>        private Date createtime;<br>        private String detail;<br><br>        public Integer getId() {<br>            return id;<br>        }<br><br>        public void setId(Integer id) {<br>            this.id = id;<br>        }<br><br>        public String getName() {<br>            return name;<br>        }<br><br>        public void setName(String name) {<br>            this.name = name;<br>        }<br><br>        public Double getPrice() {<br>            return price;<br>        }<br><br>        public void setPrice(Double price) {<br>            this.price = price;<br>        }<br><br>        public String getPrc() {<br>            return prc;<br>        }<br><br>        public void setPrc(String prc) {<br>            this.prc = prc;<br>        }<br><br>        public Date getCreatetime() {<br>            return createtime;<br>        }<br><br>        public void setCreatetime(Date createtime) {<br>            this.createtime = createtime;<br>        }<br><br>        public String getDetail() {<br>            return detail;<br>        }<br><br>        public void setDetail(String detail) {<br>            this.detail = detail;<br>        }<br><br>        @Override<br>        public String toString() {<br>            return “items{“ +<br>                    “id=” + id +<br>                    “, name=’” + name + ‘\’’ +<br>                    “, price=” + price +<br>                    “, prc=’” + prc + ‘\’’ +<br>                    “, createtime=” + createtime +<br>                    “, detail=’” + detail + ‘\’’ +<br>                    ‘}’;<br>        }<br>    }<br>*</strong><br>    package com.itheima.service.impl;<br><br>    import com.itheima.dao.ItemsDao;<br>    import com.itheima.domain.Items;<br>    import com.itheima.service.ItemService;<br>    import org.springframework.beans.factory.annotation.Autowired;<br>    import org.springframework.stereotype.Service;<br><br>    /<strong><br>     <em> 有一个公司开发的常用原则，自己写的类尽量使用注解，如果是框架使用的类，尽量使用配置文件
     </em> @Description TODO<br>     <em> @Author TT Hun
     </em> @Data 2019/11/7 20:46<br>     <em>/<br>    @Service<br>    public class ItemServiceImpl implements ItemService {<br>        @Autowired<br>        private ItemsDao itemsDao;<br><br>        public Items findById(Integer id) {<br>            return itemsDao.findById(id);<br>        }<br>    }
</em></strong><br>    package com.itheima.service;<br><br>    import com.itheima.domain.Items;<br><br>    /<strong><br>     <em> @Description TODO
     </em> @Author TT Hun<br>     <em> @Data 2019/11/7 20:45
     </em>/<br>    public interface ItemService {<br>        public Items findById(Integer id);<br>    }<br>*</strong><br>    &lt;?xml version=”1.0” encoding=”UTF-8” ?&gt;<br>    &lt;!DOCTYPE mapper<br>            PUBLIC “-//mybatis.org//DTD Mapper 3.0//EN”<br>            “<a href="http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;" target="_blank" rel="noopener">http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</a><br><br>    <mapper namespace="com.itheima.dao.ItemsDao"><br>    <!--    返回值是resulttype，因为我们事先已经把实体类中所有的属性和我们数据库中的列保持一致了
    所以我们只需要写resultType就可以了，如果不一致可以写resultMap
    这个地方已经改成了小写的i，这个地方既然已经写了别名了，写配置文件的时候切记要扫描POJO这个包的路径--><br>        <select id="findById" parametertype="int" resulttype="items"><br>            select <em> from items  where id = #{id}<br>        </em></select><br>    </mapper><br>**<br>applicationContext.xml<br><br>    &lt;?xml version=”1.0” encoding=”UTF-8”?&gt;<br>    <beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:aop="http://www.springframework.org/schema/aop" xmlns:tx="http://www.springframework.org/schema/tx" xmlns:mvc="http://www.springframework.org/schema/mvc" xsi:schemalocation="http://www.springframework.org/schema/beans
                    http://www.springframework.org/schema/beans/spring-beans.xsd
                    http://www.springframework.org/schema/context
                    http://www.springframework.org/schema/context/spring-context.xsd
                    http://www.springframework.org/schema/aop
                    http://www.springframework.org/schema/aop/spring-aop.xsd
                    http://www.springframework.org/schema/tx
                    http://www.springframework.org/schema/tx/spring-tx.xsd
                    http://www.springframework.org/schema/mvc
                    http://www.springframework.org/schema/mvc/spring-mvc.xsd"><br>        <!--dao层配置文件开始--><br>        <!--配置连接池--><br>        <bean id="dataSource" class="com.alibaba.druid.pool.DruidDataSource"><br>            <property name="driverClassName" value="com.mysql.cj.jdbc.Driver"><br>            <property name="url" value="jdbc:mysql://localhost:3306/maven?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false&amp;serverTimezone=GMT%2B8"><br>            <property name="username" value="root"><br>            <property name="password" value="root"><br>        </property></property></property></property></bean><br><br>        <!--配置生产SqlSession对象的工厂--><br>        <bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean"><br>            <property name="dataSource" ref="dataSource"><br>            <!--扫描pojo包，给包下所有pojo对象起别名--><br>            <property name="typeAliasesPackage" value="com.itheima.domain"><br>        </property></property></bean><br><br>        <!--扫描接口包路径，生成包下所有接口的代理对象，并且放入spring容器中--><br>        <bean class="org.mybatis.spring.mapper.MapperScannerConfigurer"><br>            <property name="basePackage" value="com.itheima.dao"><br>        </property></bean><br>        <!--dao层配置文件结束--><br><br><br>        <!--service层配置文件开始--><br><br>        <!--组件扫描配置--><br>        &lt;context:component-scan base-package=”com.itheima.service”/&gt;<br><br>        <!--aop面向切面编程，切面就是切入点和通知的组合--><br>        <!--配置事务管理器--><br>        <bean id="transactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager"><br>            <property name="dataSource" ref="dataSource"><br>        </property></bean><br>        <!--配置事务的通知--><br>        &lt;tx:advice id=”advice”&gt;<br>            <a href="tx:attributes" target="_blank" rel="noopener">tx:attributes</a><br>                &lt;tx:method name=”save<em>“ propagation=”REQUIRED”/&gt;<br>                &lt;tx:method name=”update</em>“ propagation=”REQUIRED”/&gt;<br>                &lt;tx:method name=”delete<em>“ propagation=”REQUIRED”/&gt;<br>                &lt;tx:method name=”find</em>“ read-only=”true”/&gt;<br>                &lt;tx:method name=”<em>“ propagation=”REQUIRED”/&gt;<br>            &lt;/tx:attributes&gt;<br>        &lt;/tx:advice&gt;<br><br>        <!--配置切面--><br>        <a href="aop:config" target="_blank" rel="noopener">aop:config</a><br>            &lt;aop:pointcut id=”pointcut” expression=”execution(</em> com.itheima.service.impl.<em>.</em>(..))”/&gt;<br>            &lt;aop:advisor advice-ref=”advice” pointcut-ref=”pointcut”/&gt;<br>        &lt;/aop:config&gt;<br>        <!--service层配置文件结束--><br>    </beans><br><strong><em><br>log4j.properties<br><br>    # Set root category priority to INFO and its only appender to CONSOLE.<br>    #log4j.rootCategory=INFO, CONSOLE            debug   info   warn error fatal<br>    log4j.rootCategory=debug, CONSOLE, LOGFILE<br><br>    # Set the enterprise logger category to FATAL and its only appender to CONSOLE.<br>    log4j.logger.org.apache.axis.enterprise=FATAL, CONSOLE<br><br>    # CONSOLE is set to be a ConsoleAppender using a PatternLayout.<br>    log4j.appender.CONSOLE=org.apache.log4j.ConsoleAppender<br>    log4j.appender.CONSOLE.layout=org.apache.log4j.PatternLayout<br>    log4j.appender.CONSOLE.layout.ConversionPattern=%d{ISO8601} %-6r [%15.15t] %-5p %30.30c %x - %m\n<br><br>    # LOGFILE is set to be a File appender using a PatternLayout.<br>    log4j.appender.LOGFILE=org.apache.log4j.FileAppender<br>    log4j.appender.LOGFILE.File=d:\axis.log<br>    log4j.appender.LOGFILE.Append=true<br>    log4j.appender.LOGFILE.layout=org.apache.log4j.PatternLayout<br>    log4j.appender.LOGFILE.layout.ConversionPattern=%d{ISO8601} %-6r [%15.15t] %-5p %30.30c %x - %m\n
</em></strong><br>springmvc.xml<br><br>    &lt;?xml version=”1.0” encoding=”UTF-8”?&gt;<br>    <beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:aop="http://www.springframework.org/schema/aop" xmlns:tx="http://www.springframework.org/schema/tx" xmlns:mvc="http://www.springframework.org/schema/mvc" xsi:schemalocation="http://www.springframework.org/schema/beans
                    http://www.springframework.org/schema/beans/spring-beans.xsd
                    http://www.springframework.org/schema/context
                    http://www.springframework.org/schema/context/spring-context.xsd
                    http://www.springframework.org/schema/aop
                    http://www.springframework.org/schema/aop/spring-aop.xsd
                    http://www.springframework.org/schema/tx
                    http://www.springframework.org/schema/tx/spring-tx.xsd
                    http://www.springframework.org/schema/mvc
                    http://www.springframework.org/schema/mvc/spring-mvc.xsd"><br>    <!--    配置组件扫描--><br>        &lt;context:component-scan base-package=”com.itheima.controller”/&gt;<br>    <!--    处理器映射器，处理器适配器--><br>        <a href="mvc:annotation-driven/" target="_blank" rel="noopener">mvc:annotation-driven/</a><br>    <!--    配置视图解析器--><br>        <bean id="internalResourceViewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver"><br>            <property name="prefix" value="/WEB-INF/pages/"><br>            <property name="suffix" value=".jsp"><br>        </property></property></bean><br><br>    <!--    释放静态资源 凡事遇到静态资源就会默认交给deafault去处理，也就是之前写的httpservlet而不是现在的动态--><br>        <a href="mvc:default-servlet-handler/" target="_blank" rel="noopener">mvc:default-servlet-handler/</a><br><br>    </beans><br><strong><em><br>itemDetail.jsp<br><br>    &lt;%@ page language=”java” contentType=”text/html; charset=UTF-8”<br>        pageEncoding=”UTF-8”%&gt;<br>    &lt;%@ taglib uri=”<a href="http://java.sun.com/jsp/jstl/core&quot;" target="_blank" rel="noopener">http://java.sun.com/jsp/jstl/core&quot;</a> prefix=”c” %&gt;<br>    &lt;%@ taglib uri=”<a href="http://java.sun.com/jsp/jstl/fmt&quot;" target="_blank" rel="noopener">http://java.sun.com/jsp/jstl/fmt&quot;</a>  prefix=”fmt”%&gt;<br><br>    &lt;!DOCTYPE html PUBLIC “-//W3C//DTD HTML 4.01 Transitional//EN” “<a href="http://www.w3.org/TR/html4/loose.dtd&quot;&gt;" target="_blank" rel="noopener">http://www.w3.org/TR/html4/loose.dtd&quot;&gt;</a><br>    <html><br>    <head><br>    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><br>    <title>Insert title here</title><br>    </head><br>    <body><br>        <form><br>            <table width="100%" border="1"><br>                <tr><br>                    <td>商品名称</td><br>                    <td> ${item.name } </td><br>                </tr><br>                <tr><br>                    <td>商品价格</td><br>                    <td> ${item.price } </td><br>                </tr><br>                <tr><br>                    <td>生成日期</td><br>                    <td> &lt;fmt:formatDate value=”${item.createtime}” pattern=”yyyy-MM-dd HH:mm:ss”/&gt; </td><br>                </tr><br>                <tr><br>                    <td>商品简介</td><br>                    <td>${item.detail} </td><br>                </tr><br>            </table><br>        </form><br>    </body><br>    </html>
</em></strong><br>web.xml<br><br>    &lt;!DOCTYPE web-app<br>            PUBLIC “-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN”<br>            “<a href="http://java.sun.com/dtd/web-app_2_3.dtd&quot;&gt;" target="_blank" rel="noopener">http://java.sun.com/dtd/web-app_2_3.dtd&quot;&gt;</a><br><br>    <web-app xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemalocation="http://java.sun.com/xml/ns/javaee
              http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" version="3.0"><br><br><br>        <!--    首先配置编码过滤器--><br><br>        <filter><br>            <filter-name>encoding</filter-name><br>            <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class><br>            <init-param><br>                <param-name>encoding</param-name><br>                <param-value>UTF-8</param-value><br>            </init-param><br>            <init-param><br>                <param-name>forceEncoding</param-name><br>                <param-value>true</param-value><br>            </init-param><br>        </filter><br>        <filter-mapping><br>            <filter-name>encoding</filter-name><br>            <url-pattern>/<em></em></url-pattern><br>        </filter-mapping><br><br>        <!--    配置Spring核心监听器--><br>        <listener><br>            <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class><br>        </listener><br>        <!--    spring默认监听器只能监听WEB_INF路径下的名字叫applicationContext.xml的spring配置文件，我们的文件名称可以对上但是路径对不上
        所以我们重新指定spring配置路径--><br>        <context-param><br>            <param-name>contextConfigLocation</param-name><br>            <param-value>classpath:applicationContext.xml</param-value><br>        </context-param><br><br><br>        <!--    配置springmvc的核心servlet--><br>        <servlet><br>            <servlet-name>springmvc</servlet-name><br>            <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class><br>            <init-param><br>                <param-name>contextConfigLocation</param-name><br>                <!--            classpath的默认路径就是这个resources--><br>                <param-value>classpath:springmvc.xml</param-value><br>            </init-param><br>            <load-on-startup>1</load-on-startup><br>        </servlet><br>        <servlet-mapping><br>            <servlet-name>springmvc</servlet-name><br>            <url-pattern>/</url-pattern><br>        </servlet-mapping><br><br>    </web-app><br>**<br>ItemTest<br><br>    package com.itheima.test;<br><br>    import com.itheima.dao.ItemsDao;<br>    import com.itheima.domain.Items;<br>    import com.itheima.service.ItemService;<br>    import org.junit.Test;<br>    import org.springframework.context.ApplicationContext;<br>    import org.springframework.context.support.ClassPathXmlApplicationContext;<br><br>    /<strong><br>     <em> @Description TODO
     </em> @Author TT Hun<br>     <em> @Data 2019/11/7 20:12
     </em>/<br>    public class ItemsTest {<br><br>        @Test<br>        public void findById(){<br>    //        获取Spring容器<br>            ApplicationContext ac = new ClassPathXmlApplicationContext(“applicationContext.xml”);<br>    //        从容器中直接拿到dao的代理对象<br>            ItemsDao itemsDao = ac.getBean(ItemsDao.class);<br>    //        调用方法<br>            Items items = itemsDao.findById(1);<br>            System.out.println(items.getName());<br>        }<br><br>        /</strong><br>         <em> service测试
         </em>/<br>        @Test<br>        public void findById1(){<br>    //        获取Spring容器<br>            ApplicationContext ac = new ClassPathXmlApplicationContext(“applicationContext.xml”);<br>            ItemService itemService = ac.getBean(ItemService.class);<br>    //        拿到Service之后直接去调用方法<br>            Items items = itemService.findById(1);<br>            System.out.println(items.getName());<br>        }<br>    }<br>***<br>pom文件：<br><br>    &lt;?xml version=”1.0” encoding=”UTF-8”?&gt;<br><br>    <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemalocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"><br>        <modelversion>4.0.0</modelversion><br><br>        <groupid>com.itheima</groupid><br>        <artifactid>maven_day02_1</artifactid><br>        <version>1.0-SNAPSHOT</version><br>        <packaging>war</packaging><br><br><br>        <!--maven工程要导入jar包的坐标，就必须要考虑解决jar包冲突。
            解决jar包冲突的方式一：
            第一声明优先原则：哪个jar包的坐标在靠上的位置，这个jar包就是先声明的。
            先声明的jar包坐标下的依赖包，可以优先进入项目中。

            maven导入jar包中的一些概念：
            直接依赖：项目中直接导入的jar包，就是该项目的直接依赖包。
            传递依赖：项目中没有直接导入的jar包，可以通过项目直接依赖jar包传递到项目中去。

            解决jar包冲突的方式二：
            路径近者优先原则。直接依赖路径比传递依赖路径近，那么最终项目进入的jar包会是路径近的直接依赖包。

            解决jar包冲突的方式三【推荐使用】：
            直接排除法。
            当我们要排除某个jar包下依赖包，在配置exclusions标签的时候，内部可以不写版本号。
            因为此时依赖包使用的版本和默认和本jar包一样。
            --><br>        <!-- 统一管理jar包版本 --><br>        <properties><br>            &lt;spring.version&gt;5.0.2.RELEASE&lt;/spring.version&gt;<br>            &lt;slf4j.version&gt;1.6.6&lt;/slf4j.version&gt;<br>            &lt;log4j.version&gt;1.2.12&lt;/log4j.version&gt;<br>            &lt;shiro.version&gt;1.2.3&lt;/shiro.version&gt;<br>            &lt;mysql.version&gt;8.0.11&lt;/mysql.version&gt;<br>            &lt;mybatis.version&gt;3.4.5&lt;/mybatis.version&gt;<br>            &lt;spring.security.version&gt;5.0.1.RELEASE&lt;/spring.security.version&gt;<br>        </properties><br><br>        <!--
        maven工程是可以分父子依赖关系的。
        凡是依赖别的项目后，拿到的别的项目的依赖包，都属于传递依赖。
        比如：当前A项目，被B项目依赖。那么我们A项目中所有jar包都会传递到B项目中。
        B项目开发者，如果再在B项目中导入一套ssm框架的jar包，对于B项目是直接依赖。
        那么直接依赖的jar包就会把我们A项目传递过去的jar包覆盖掉。
        为了防止以上情况的出现。我们可以把A项目中主要jar包的坐标锁住，那么其他依赖该项目的项目中，
        即便是有同名jar包直接依赖，也无法覆盖。
        --><br>        <!-- 锁定jar包版本 --><br>        <dependencymanagement><br>            <dependencies><br>                <dependency><br>                    <groupid>org.springframework</groupid><br>                    <artifactid>spring-context</artifactid><br>                    <version>${spring.version}</version><br>                </dependency><br>                <dependency><br>                    <groupid>org.springframework</groupid><br>                    <artifactid>spring-web</artifactid><br>                    <version>${spring.version}</version><br>                </dependency><br>                <dependency><br>                    <groupid>org.springframework</groupid><br>                    <artifactid>spring-webmvc</artifactid><br>                    <version>${spring.version}</version><br>                </dependency><br>                <dependency><br>                    <groupid>org.springframework</groupid><br>                    <artifactid>spring-tx</artifactid><br>                    <version>${spring.version}</version><br>                </dependency><br>                <dependency><br>                    <groupid>org.springframework</groupid><br>                    <artifactid>spring-test</artifactid><br>                    <version>${spring.version}</version><br>                </dependency><br>                <dependency><br>                    <groupid>org.mybatis</groupid><br>                    <artifactid>mybatis</artifactid><br>                    <version>${mybatis.version}</version><br>                </dependency><br>            </dependencies><br>        </dependencymanagement>

<pre><code>    &lt;!-- 项目依赖jar包 --&gt;
    &lt;dependencies&gt;
        &lt;!-- spring --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.aspectj&lt;/groupId&gt;
            &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;
            &lt;version&gt;1.6.8&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-aop&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-web&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-orm&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-beans&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-core&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-test&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
            &lt;version&gt;4.12&lt;/version&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;mysql&lt;/groupId&gt;
            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
            &lt;version&gt;${mysql.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
            &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;
            &lt;version&gt;3.1.0&lt;/version&gt;
            &lt;scope&gt;provided&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;javax.servlet.jsp&lt;/groupId&gt;
            &lt;artifactId&gt;jsp-api&lt;/artifactId&gt;
            &lt;version&gt;2.0&lt;/version&gt;
            &lt;scope&gt;provided&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;jstl&lt;/groupId&gt;
            &lt;artifactId&gt;jstl&lt;/artifactId&gt;
            &lt;version&gt;1.2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;!-- log start --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;log4j&lt;/groupId&gt;
            &lt;artifactId&gt;log4j&lt;/artifactId&gt;
            &lt;version&gt;${log4j.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
            &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;
            &lt;version&gt;${slf4j.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
            &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
            &lt;version&gt;${slf4j.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;!-- log end --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
            &lt;version&gt;${mybatis.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;
            &lt;version&gt;1.3.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;c3p0&lt;/groupId&gt;
            &lt;artifactId&gt;c3p0&lt;/artifactId&gt;
            &lt;version&gt;0.9.1.2&lt;/version&gt;
            &lt;type&gt;jar&lt;/type&gt;
            &lt;scope&gt;compile&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt;
            &lt;artifactId&gt;pagehelper&lt;/artifactId&gt;
            &lt;version&gt;5.1.2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
            &lt;artifactId&gt;spring-security-web&lt;/artifactId&gt;
            &lt;version&gt;${spring.security.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
            &lt;artifactId&gt;spring-security-config&lt;/artifactId&gt;
            &lt;version&gt;${spring.security.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
            &lt;artifactId&gt;spring-security-core&lt;/artifactId&gt;
            &lt;version&gt;${spring.security.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
            &lt;artifactId&gt;spring-security-taglibs&lt;/artifactId&gt;
            &lt;version&gt;${spring.security.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
            &lt;artifactId&gt;druid&lt;/artifactId&gt;
            &lt;version&gt;1.0.9&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
            &lt;version&gt;4.12&lt;/version&gt;
        &lt;/dependency&gt;

    &lt;/dependencies&gt;
    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;
                &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;2.2&lt;/version&gt;
            &lt;/plugin&gt;

        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/project&gt;
</code></pre><hr>
<hr>
<hr>
<h1 id="Maven工程拆分与聚合的思想"><a href="#Maven工程拆分与聚合的思想" class="headerlink" title="Maven工程拆分与聚合的思想"></a>Maven工程拆分与聚合的思想</h1><p><img src="https://i.imgur.com/Z1yB0PQ.png" alt=""></p>
<p>#Maven父子工程的创建#<br>首先父工程的pom：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

&lt;!--    工程和模块的区别：
        工程不等于完整的项目，模块也不等于完整的项目，一个完整的项目看的是代码，代码完整就可以说是一个完整的项目，和工程和
        项目没关系的。--&gt;

&lt;!--    那么工程和模块啥区别呢？工程天生只能使用自己的内部资源，工程是天生独立的，后天可以和其他模块建立关联关系，模块天生是属于
父工程的，也就是模块一旦创建，所有父工程的资源都可以使用--&gt;

&lt;!--    子模块天生继承父工程，可以使用付工程所有资源，
        子模块之间天生没任何关系--&gt;

&lt;!--    父子工程之间不用建立关系，继承关系是先天的，不需要手动建立

         平级之间的关系叫依赖关系。依赖不是先天的，是需要后天建立的--&gt;
    &lt;groupId&gt;com.itheima&lt;/groupId&gt;
    &lt;artifactId&gt;maven_day02_parent&lt;/artifactId&gt;
    &lt;packaging&gt;pom&lt;/packaging&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
&lt;!--    下面有几个字模块会显示到这里--&gt;
    &lt;modules&gt;
        &lt;module&gt;maven_day02_dao&lt;/module&gt;
        &lt;module&gt;maven_day02_service&lt;/module&gt;
        &lt;module&gt;maven_day02_web&lt;/module&gt;
    &lt;/modules&gt;

        &lt;!--maven工程要导入jar包的坐标，就必须要考虑解决jar包冲突。
            解决jar包冲突的方式一：
            第一声明优先原则：哪个jar包的坐标在靠上的位置，这个jar包就是先声明的。
            先声明的jar包坐标下的依赖包，可以优先进入项目中。

            maven导入jar包中的一些概念：
            直接依赖：项目中直接导入的jar包，就是该项目的直接依赖包。
            传递依赖：项目中没有直接导入的jar包，可以通过项目直接依赖jar包传递到项目中去。

            解决jar包冲突的方式二：
            路径近者优先原则。直接依赖路径比传递依赖路径近，那么最终项目进入的jar包会是路径近的直接依赖包。

            解决jar包冲突的方式三【推荐使用】：
            直接排除法。
            当我们要排除某个jar包下依赖包，在配置exclusions标签的时候，内部可以不写版本号。
            因为此时依赖包使用的版本和默认和本jar包一样。
            --&gt;
        &lt;!-- 统一管理jar包版本 --&gt;
        &lt;properties&gt;
            &lt;spring.version&gt;5.0.2.RELEASE&lt;/spring.version&gt;
            &lt;slf4j.version&gt;1.6.6&lt;/slf4j.version&gt;
            &lt;log4j.version&gt;1.2.12&lt;/log4j.version&gt;
            &lt;shiro.version&gt;1.2.3&lt;/shiro.version&gt;
            &lt;mysql.version&gt;8.0.11&lt;/mysql.version&gt;
            &lt;mybatis.version&gt;3.4.5&lt;/mybatis.version&gt;
            &lt;spring.security.version&gt;5.0.1.RELEASE&lt;/spring.security.version&gt;
        &lt;/properties&gt;

        &lt;!--
        maven工程是可以分父子依赖关系的。
        凡是依赖别的项目后，拿到的别的项目的依赖包，都属于传递依赖。
        比如：当前A项目，被B项目依赖。那么我们A项目中所有jar包都会传递到B项目中。
        B项目开发者，如果再在B项目中导入一套ssm框架的jar包，对于B项目是直接依赖。
        那么直接依赖的jar包就会把我们A项目传递过去的jar包覆盖掉。
        为了防止以上情况的出现。我们可以把A项目中主要jar包的坐标锁住，那么其他依赖该项目的项目中，
        即便是有同名jar包直接依赖，也无法覆盖。
        --&gt;
        &lt;!-- 锁定jar包版本 --&gt;
        &lt;dependencyManagement&gt;
            &lt;dependencies&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                    &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
                    &lt;version&gt;${spring.version}&lt;/version&gt;
                &lt;/dependency&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                    &lt;artifactId&gt;spring-web&lt;/artifactId&gt;
                    &lt;version&gt;${spring.version}&lt;/version&gt;
                &lt;/dependency&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                    &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
                    &lt;version&gt;${spring.version}&lt;/version&gt;
                &lt;/dependency&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                    &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;
                    &lt;version&gt;${spring.version}&lt;/version&gt;
                &lt;/dependency&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                    &lt;artifactId&gt;spring-test&lt;/artifactId&gt;
                    &lt;version&gt;${spring.version}&lt;/version&gt;
                &lt;/dependency&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
                    &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
                    &lt;version&gt;${mybatis.version}&lt;/version&gt;
                &lt;/dependency&gt;
            &lt;/dependencies&gt;
        &lt;/dependencyManagement&gt;

        &lt;!-- 项目依赖jar包 --&gt;
        &lt;dependencies&gt;
            &lt;!-- spring --&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.aspectj&lt;/groupId&gt;
                &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;
                &lt;version&gt;1.6.8&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-aop&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-web&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-orm&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-beans&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-core&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-test&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;
                &lt;version&gt;${spring.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;junit&lt;/groupId&gt;
                &lt;artifactId&gt;junit&lt;/artifactId&gt;
                &lt;version&gt;4.12&lt;/version&gt;
                &lt;scope&gt;test&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;mysql&lt;/groupId&gt;
                &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
                &lt;version&gt;${mysql.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
                &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;
                &lt;version&gt;3.1.0&lt;/version&gt;
                &lt;scope&gt;provided&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;javax.servlet.jsp&lt;/groupId&gt;
                &lt;artifactId&gt;jsp-api&lt;/artifactId&gt;
                &lt;version&gt;2.0&lt;/version&gt;
                &lt;scope&gt;provided&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;jstl&lt;/groupId&gt;
                &lt;artifactId&gt;jstl&lt;/artifactId&gt;
                &lt;version&gt;1.2&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;!-- log start --&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;log4j&lt;/groupId&gt;
                &lt;artifactId&gt;log4j&lt;/artifactId&gt;
                &lt;version&gt;${log4j.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
                &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;
                &lt;version&gt;${slf4j.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
                &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
                &lt;version&gt;${slf4j.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;!-- log end --&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
                &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
                &lt;version&gt;${mybatis.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
                &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;
                &lt;version&gt;1.3.0&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;c3p0&lt;/groupId&gt;
                &lt;artifactId&gt;c3p0&lt;/artifactId&gt;
                &lt;version&gt;0.9.1.2&lt;/version&gt;
                &lt;type&gt;jar&lt;/type&gt;
                &lt;scope&gt;compile&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt;
                &lt;artifactId&gt;pagehelper&lt;/artifactId&gt;
                &lt;version&gt;5.1.2&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
                &lt;artifactId&gt;spring-security-web&lt;/artifactId&gt;
                &lt;version&gt;${spring.security.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
                &lt;artifactId&gt;spring-security-config&lt;/artifactId&gt;
                &lt;version&gt;${spring.security.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
                &lt;artifactId&gt;spring-security-core&lt;/artifactId&gt;
                &lt;version&gt;${spring.security.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
                &lt;artifactId&gt;spring-security-taglibs&lt;/artifactId&gt;
                &lt;version&gt;${spring.security.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
                &lt;artifactId&gt;druid&lt;/artifactId&gt;
                &lt;version&gt;1.0.9&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;junit&lt;/groupId&gt;
                &lt;artifactId&gt;junit&lt;/artifactId&gt;
                &lt;version&gt;4.12&lt;/version&gt;
            &lt;/dependency&gt;

        &lt;/dependencies&gt;
        &lt;build&gt;
            &lt;plugins&gt;
                &lt;plugin&gt;
                    &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;
                    &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;
                    &lt;version&gt;2.2&lt;/version&gt;
                &lt;/plugin&gt;

            &lt;/plugins&gt;
        &lt;/build&gt;
    &lt;/project&gt;
</code></pre><p>service层的pom:<br>    &lt;?xml version=”1.0” encoding=”UTF-8”?&gt;<br>    <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemalocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"><br>        <parent><br>            <artifactid>maven_day02_parent</artifactid><br>            <groupid>com.itheima</groupid><br>            <version>1.0-SNAPSHOT</version><br>        </parent><br>        <modelversion>4.0.0</modelversion></project></p>
<pre><code>    &lt;artifactId&gt;maven_day02_service&lt;/artifactId&gt;

&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.itheima&lt;/groupId&gt;
        &lt;artifactId&gt;maven_day02_dao&lt;/artifactId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;

&lt;/project&gt;
</code></pre><hr>
<p>dao层类似。</p>
<hr>
<h1 id="传递下来的包是否能用"><a href="#传递下来的包是否能用" class="headerlink" title="传递下来的包是否能用"></a>传递下来的包是否能用</h1><p>如果说在parent使用了scope这个作用域的标签就不一定在子工程可以使用：</p>
<p><img src="https://i.imgur.com/dzfAU9e.png" alt=""></p>
<hr>
<h1 id="Maven工程打开SSM项目的三种启动方式（包括完整代码）"><a href="#Maven工程打开SSM项目的三种启动方式（包括完整代码）" class="headerlink" title="Maven工程打开SSM项目的三种启动方式（包括完整代码）"></a>Maven工程打开SSM项目的三种启动方式（包括完整代码）</h1><p>首先看一下目录结构，目录结构是父工程结合子工程的</p>
</project></denpenedies>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2019/11/07/SSM整合案例/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/07/SSM整合案例/" itemprop="url">SSM整合案例</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-07T14:27:39+08:00">
                2019-11-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>SSM：就是springmvc,spring,ssm</p>
<p>首先整合一下spring框架里面的东西。</p>
<p>以下是目录结构</p>
<p><img src="https://i.imgur.com/3nhqu4F.png" alt=""></p>
<p>首先是写spring里面的结构，不包括springmvc和mybatis:</p>
<pre><code>package cn.itcast.controller;

/**
 * @Description 账户web
 * @Author TT Hun
 * @Data 2019/11/9 16:04
 */
public class AccountController {

}
</code></pre><hr>
<pre><code>package cn.itcast.dao;

import java.util.List;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/9 15:54
 */
public interface Account {

    /**
     * 查询所有账户
     * @return
     */
    public List&lt;Account&gt; findAll();

    /**
     * 保存账户信息
     * @param account
     */
    public void saveAccount(Account account);

}
</code></pre><hr>
<pre><code>package cn.itcast.domain;

import java.io.Serializable;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/9 15:52
 */
public class Account implements Serializable {
    private Integer id;
    private String name;
    private Double money;

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Double getMoney() {
        return money;
    }

    public void setMoney(Double money) {
        this.money = money;
    }

    @Override
    public String toString() {
        return &quot;Account{&quot; +
                &quot;id=&quot; + id +
                &quot;, name=&apos;&quot; + name + &apos;\&apos;&apos; +
                &quot;, money=&quot; + money +
                &apos;}&apos;;
    }
}
</code></pre><hr>
<pre><code>package cn.itcast.service.impl;

import cn.itcast.dao.Account;
import cn.itcast.service.AccountService;
import org.springframework.stereotype.Service;

import java.util.List;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/9 16:02
 */
@Service(&quot;accountService&quot;)
public class AccountServiceImpl implements AccountService {
    @Override
    public List&lt;Account&gt; findAll() {
        System.out.println(&quot;业务层查询所有账户信息&quot;);
        return null;
    }

    @Override
    public void saveAccount(Account account) {
        System.out.println(&quot;业务层保存账户&quot;);

    }
}
</code></pre><hr>
<pre><code>package cn.itcast.service;

import cn.itcast.dao.Account;

import java.util.List;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/9 15:58
 */
public interface AccountService {
    /**
     * 查询所有账户
     * @return
     */
    public List&lt;Account&gt; findAll();

    /**
     * 保存账户信息
     * @param account
     */
    public void saveAccount(Account account);
}
</code></pre><hr>
<pre><code>package cn.itcast.test;

import cn.itcast.service.AccountService;
import org.junit.Test;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/9 16:21
 */
public class testSpring {
    @Test
    public void run1(){
//        加载配置文件
        ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;classpath:applicationContext.xml&quot;);
//        获取对象
        AccountService as = (AccountService)ac.getBean(&quot;accountService&quot;);
//        调用方法
        as.findAll();

    }
}
</code></pre><hr>
<p>&lt;?xml version=”1.0” encoding=”UTF-8”?&gt;</p>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:aop="http://www.springframework.org/schema/aop" xmlns:tx="http://www.springframework.org/schema/tx" xsi:schemalocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans.xsd
    http://www.springframework.org/schema/context
    http://www.springframework.org/schema/context/spring-context.xsd
    http://www.springframework.org/schema/aop
    http://www.springframework.org/schema/aop/spring-aop.xsd
    http://www.springframework.org/schema/tx
    http://www.springframework.org/schema/tx/spring-tx.xsd">

<pre><code>&lt;!--开启注解的扫描，希望处理service和dao，controller不需要Spring框架去处理--&gt;
&lt;context:component-scan base-package=&quot;cn.itcast&quot; &gt;
    &lt;!--配置哪些注解不扫描--&gt;
    &lt;context:exclude-filter type=&quot;annotation&quot; expression=&quot;org.springframework.stereotype.Controller&quot; /&gt;
&lt;/context:component-scan&gt;

&lt;/beans&gt;
</code></pre><p>web.xml和index.jsp先不动</p>
<hr>
<hr>
<hr>
<p>然后再看这个springmvc怎么写：</p>
<pre><code>package cn.itcast.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;

/**
 * @Description 账户web
 * @Author TT Hun
 * @Data 2019/11/9 16:04
 */
@Controller
@RequestMapping(&quot;/account&quot;)
public class AccountController {
    @RequestMapping(&quot;/findAll&quot;)
    public String findAll(){
        System.out.println(&quot;查询所有帐户信息&quot;);
        return &quot;list&quot;;
    }

}
</code></pre><hr>
<p>testSpring类</p>
<pre><code>package cn.itcast.test;

import cn.itcast.service.AccountService;
import org.junit.Test;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/9 16:21
 */
public class testSpring {
    @Test
    public void run1(){
//        加载配置文件
        ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;classpath:applicationContext.xml&quot;);
//        获取对象
        AccountService as = (AccountService)ac.getBean(&quot;accountService&quot;);
//        调用方法
        as.findAll();

    }
}
</code></pre><hr>
<p>springmvc.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xsi:schemaLocation=&quot;
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;

    &lt;!--开启注解扫描，只扫描Controller注解--&gt;
    &lt;context:component-scan base-package=&quot;cn.itcast&quot;&gt;
        &lt;context:include-filter type=&quot;annotation&quot; expression=&quot;org.springframework.stereotype.Controller&quot; /&gt;
    &lt;/context:component-scan&gt;

    &lt;!--配置的视图解析器对象--&gt;
    &lt;bean id=&quot;internalResourceViewResolver&quot; class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;
        &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/pages/&quot;/&gt;
        &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt;
    &lt;/bean&gt;

    &lt;!--过滤静态资源--&gt;
    &lt;mvc:resources location=&quot;/css/&quot; mapping=&quot;/css/**&quot; /&gt;
    &lt;mvc:resources location=&quot;/images/&quot; mapping=&quot;/images/**&quot; /&gt;
    &lt;mvc:resources location=&quot;/js/&quot; mapping=&quot;/js/**&quot; /&gt;

    &lt;!--开启SpringMVC注解的支持--&gt;
    &lt;mvc:annotation-driven/&gt;

&lt;/beans&gt;
</code></pre><hr>
<p>list.jsp</p>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/9
  Time: 17:27
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
    &lt;h2&gt;查询所有账户信息&lt;/h2&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<p>web.xml</p>
<pre><code>&lt;!DOCTYPE web-app PUBLIC
        &quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot;
        &quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot; &gt;

&lt;web-app&gt;
  &lt;display-name&gt;Archetype Created Web Application&lt;/display-name&gt;

  &lt;!--配置前端控制器--&gt;
  &lt;servlet&gt;
    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;
    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
    &lt;!--加载springmvc.xml配置文件--&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
      &lt;param-value&gt;classpath:springmvc.xml&lt;/param-value&gt;
    &lt;/init-param&gt;
    &lt;!--启动服务器，创建该servlet--&gt;
    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
  &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;

  &lt;!--解决中文乱码的过滤器--&gt;
  &lt;filter&gt;
    &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;encoding&lt;/param-name&gt;
      &lt;param-value&gt;UTF-8&lt;/param-value&gt;
    &lt;/init-param&gt;
  &lt;/filter&gt;
  &lt;filter-mapping&gt;
    &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;/filter-mapping&gt;

&lt;/web-app&gt;
</code></pre><hr>
</beans>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2019/11/06/Oracle使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/06/Oracle使用/" itemprop="url">Oracle使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-06T14:18:03+08:00">
                2019-11-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Oracle的查询"><a href="#Oracle的查询" class="headerlink" title="Oracle的查询"></a>Oracle的查询</h1><h2 id="单行查询"><a href="#单行查询" class="headerlink" title="单行查询"></a>单行查询</h2><p>upper代表将小写转换成大写，lower大写变小写<br><img src="https://i.imgur.com/9rodKEr.png" alt=""><br>round四舍五入，后面参数保留几位。trunc直接截取几位。<br><img src="https://i.imgur.com/s5tOMWq.png" alt=""></p>
<p><img src="https://i.imgur.com/xxDaXwf.png" alt=""></p>
<p><img src="https://i.imgur.com/NKM9KU5.png" alt=""></p>
<p>转换函数：<br><img src="https://i.imgur.com/3lGMivQ.png" alt=""><br>通用函数：<br>nvl函数：如果是空的话就按照后面的给定的数值来计算：<br><img src="https://i.imgur.com/D1Zlr9D.png" alt=""></p>
<h2 id="多行函数（聚合函数）"><a href="#多行函数（聚合函数）" class="headerlink" title="多行函数（聚合函数）"></a>多行函数（聚合函数）</h2><p><img src="https://i.imgur.com/ZWGzcWn.png" alt=""></p>
<h2 id="分组查询"><a href="#分组查询" class="headerlink" title="分组查询"></a>分组查询</h2><p>分组查询中，出现在group by后面的原始列才能出现在select后面 ，没有出现在group by后面的列想在select后面出现必须加上聚合函数，也就是下面的e.sal必须要使用完聚合函数之后才能用。下面这个SQL在经历了group by之后已经变成了三行两列的状况，也就是有几个部门就有几组数据了。所以如果在聚合完了之后的再去查询e.ename，一个部门肯定不止一个人，怎么都没法查询，所以说select后面出现的必须是一个组的共同特性。<br>聚合函数是作用于多列返回一个值，也就是聚合函数有一个特性，可以把多行记录变成一个值。<br><img src="https://i.imgur.com/pZd41xt.png" alt=""></p>
<hr>
<p>如果说把avg(e.sal) 设置一个别名asal那么在写having条件的时候能否直接使用asal&gt;200呢，不行的</p>
<p>所有条件都不能使用别名判断，因为在查询的时候都是分先后顺序的。<br><img src="https://i.imgur.com/vs8YqkY.png" alt=""></p>
<hr>
<p>说一个错误的案例<br><img src="https://i.imgur.com/KazK8Dz.png" alt=""></p>
<hr>
<p><img src="https://i.imgur.com/4A7O1hp.png" alt=""></p>
<p><img src="https://i.imgur.com/oa1LRqq.png" alt=""></p>
<hr>
<h2 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h2><p><img src="https://i.imgur.com/pRhtP3Z.png" alt=""></p>
<p>内连接和等值连接一样</p>
<p><img src="https://i.imgur.com/9PJPFNT.png" alt=""></p>
<p><img src="https://i.imgur.com/ER5WivO.png" alt=""></p>
<p><img src="https://i.imgur.com/xH8YnZX.png" alt=""></p>
<h3 id="左外连接和右外连接的区别"><a href="#左外连接和右外连接的区别" class="headerlink" title="左外连接和右外连接的区别"></a>左外连接和右外连接的区别</h3><p><img src="https://i.imgur.com/39ZdRfn.png" alt=""></p>
<h3 id="oracle中专用连接"><a href="#oracle中专用连接" class="headerlink" title="oracle中专用连接"></a>oracle中专用连接</h3><p><img src="https://i.imgur.com/4XxzU1B.png" alt=""></p>
<hr>
<h3 id="继续多表查询"><a href="#继续多表查询" class="headerlink" title="继续多表查询"></a>继续多表查询</h3><p>首先如果写一个复杂的查询先把架子搭起来，也就是：</p>
<p>select </p>
<p>from </p>
<p>where</p>
<p>然后在继续往里面写<br><img src="https://i.imgur.com/hL5Scyy.png" alt=""></p>
<p>首先看上面这张图，要写这个SQL首先考虑员工在哪一张表，领导姓名在哪张表，然后放在from后面</p>
<p>首先这个数据库下EMP表可以看到多个信息，可以看见员工也可以看见这个员工对应的领导</p>
<h3 id="自连接"><a href="#自连接" class="headerlink" title="自连接"></a>自连接</h3><p><img src="https://i.imgur.com/Rt47x0M.png" alt=""><br>其中mgr是领导编号，empno是员工编号</p>
<h2 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h2><p>下面这个查询的前提是这个ename是主键，也就是唯一可以写等号<br><img src="https://i.imgur.com/gDwL9BT.png" alt=""></p>
<p>要不然下面这种写法比较准确</p>
<p><img src="https://i.imgur.com/Wc2Ovse.png" alt=""></p>
<hr>
<p><img src="https://i.imgur.com/7LZ8JtO.png" alt=""></p>
<hr>
<p><img src="https://i.imgur.com/c5IfG9S.png" alt=""></p>
<h2 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h2><p><img src="https://i.imgur.com/rGa4WDi.png" alt=""></p>
<p>这个分页查询的仔细解释，涉及到一个rownum的问题。</p>
<p>首先看下面这样一个错误的案例：下面这个错误的案例的原因是由于顺序的问题首先是select 的内容，做完之后rownum就是在select之后就排序了，这个rownum也就相当于一个独立于这个表之外的一个列的感觉。这样的话然后再去使用where条件的话rownum已经是乱序的了，所以，这样的话是拿不到前几个的</p>
<p><img src="https://i.imgur.com/VJc7HGK.png" alt=""></p>
<p>那么rownum乱序怎么理解呢？看如下图，也就是说上面的where条件是在下面这种情况下加上的。</p>
<p><img src="https://i.imgur.com/Ik1OhOt.png" alt=""></p>
<p>所以得出来一个结论，也就是排序操作会影响rownum的顺序，我们可以先排序在去加行号。</p>
<p><img src="https://i.imgur.com/vRYDkdp.png" alt=""></p>
<p>这样就已经不乱了。</p>
<p>也就是说如果涉及到排序，但是还需要使用rownum的话，我们可以再次嵌套查询，就可以避开rownum乱的顺序了。</p>
<p>接着来说分页查询的一个失败的案例</p>
<p><img src="https://i.imgur.com/9AJibTN.png" alt=""></p>
<p>看上面的这个发现这样子查询出来就一条数据都没有了，什么原因呢</p>
<p>原因就是因为rownum是在select之后按照顺序排列的，rownum是按照顺序依次递增不能跳着顺序走。那么这句SQL就设计到一个问题，也就是select先执行还是where先执行的问题。我们知道是where先走，当where先的时候，查询第一条记录本来要在该记录上加上一个行号1但是一看要通过rownum=1来判断rownum&gt;5的条件，这样一来怎么都不能满足，第一个rownum就加不上，也不能跳跃着加，所以就查不到了，只不过是条件不满足而已。</p>
<p>所以rownum不能直接写大于一个正数，但是我们可以通过嵌套间接写大于也就是如下</p>
<p><img src="https://i.imgur.com/T7okHNi.png" alt=""></p>
<p>分页查询结束</p>
<hr>
<hr>
<hr>
<h1 id="Oracle的对象"><a href="#Oracle的对象" class="headerlink" title="Oracle的对象"></a>Oracle的对象</h1><h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><p><img src="https://i.imgur.com/RTT3Y5W.png" alt=""></p>
<p><img src="https://i.imgur.com/ZKixbfN.png" alt=""></p>
<p><img src="https://i.imgur.com/LNbrv3z.png" alt=""></p>
<p>假如总部一个查询语句，分部一个查询语句各自查一套，总部突然卖出了十万雨伞，但是分部没有及时去查询，就出现总部已经没货了，所以就让总部从表中查询，分部看视图，因为视图里面根本就没数据，只要总部的数据改变了，分部立马就能看到最新的数据。这是视图经常使用的地方。</p>
<hr>
<hr>
<h2 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h2><p><img src="https://i.imgur.com/oEGbq9z.png" alt=""></p>
<p><img src="https://i.imgur.com/dgIVAcY.png" alt=""></p>
<hr>
<hr>
<hr>
<h1 id="Oracle编程"><a href="#Oracle编程" class="headerlink" title="Oracle编程"></a>Oracle编程</h1><p><img src="https://i.imgur.com/KCaI2V9.png" alt=""></p>
<p>这个地方没有看感觉用处不大</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2019/11/03/SpringMVC第二天/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/03/SpringMVC第二天/" itemprop="url">SpringMVC第二天</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-03T21:06:07+08:00">
                2019-11-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="第一章：相应数据和结果视图"><a href="#第一章：相应数据和结果视图" class="headerlink" title="第一章：相应数据和结果视图"></a>第一章：相应数据和结果视图</h1><h2 id="响应之返回值是String类型的"><a href="#响应之返回值是String类型的" class="headerlink" title="响应之返回值是String类型的"></a>响应之返回值是String类型的</h2><blockquote>
<p>首先说一个以后开发常见的方式：<br>首先从response.jsp发请求，然后我从Controller后台查出来，存到model，存到request里，然后在转发到页面。再从request域里取出来。</p>
</blockquote>
<pre><code>package cn.itcast.controller;

import cn.itcast.domain.User;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/3 21:26
 */
@Controller
@RequestMapping(&quot;/user&quot;)
public class UserController {

    @RequestMapping(&quot;/testString&quot;)
    public String testString(Model model){
        System.out.println(&quot;testString方法执行了...&quot;);
//       模拟从数据库中查询对象
        User user = new User();
        user.setUsername(&quot;美美&quot;);
        user.setPassword(&quot;123&quot;);
        user.setAge(30);
//        把对象存起来
        model.addAttribute(&quot;user&quot;,user);
        return &quot;success&quot;;
    }

}
</code></pre><hr>
<pre><code>package cn.itcast.domain;

import java.io.Serializable;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/3 22:00
 */
public class User  implements Serializable {
    private String password;
    private Integer age;
    private String  username;

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public Integer getAge() {
        return age;
    }

    public void setAge(Integer age) {
        this.age = age;
    }

    public String getUsername() {
        return username;
    }

    public void setUsername(String username) {
        this.username = username;
    }
}
</code></pre><hr>
<p>springmvc.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;
       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xsi:schemaLocation=&quot;
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;

    &lt;!-- 开启注解扫描 扫描这个路径下的包，就可以在--&gt;
    &lt;context:component-scan base-package=&quot;cn.itcast&quot;/&gt;

    &lt;!-- 视图解析器对象  视图解析器的类名是固定的，然后配置通过这个视图解析器就可以让controller里面return的东西直接跳转指定的jsp页面
        但是还需要配置2个属性，一个是Prefix就是配置找文件的路径
        suffix指的是配置的后缀名字。最后也就是找/web-if/pages/下的后缀是jsp的文件--&gt;
    &lt;bean id=&quot;internalResourceViewResolver&quot; class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;
        &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/pages/&quot;/&gt;
        &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt;
    &lt;/bean&gt;

    &lt;!-- 开启SpringMVC框架注解的支持 标签是固定的--&gt;
    &lt;mvc:annotation-driven  /&gt;

&lt;/beans&gt;
</code></pre><hr>
<p>success.jsp</p>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/3
  Time: 21:22
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; isELIgnored=&quot;false&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h2&gt;执行成功&lt;/h2&gt;

${user.username}
${user.password}

&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<p>web.xml</p>
<pre><code>&lt;!DOCTYPE web-app PUBLIC
 &quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot;
 &quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot; &gt;

&lt;web-app&gt;
  &lt;display-name&gt;Archetype Created Web Application&lt;/display-name&gt;

  &lt;!--配置前端控制器--&gt;
  &lt;servlet&gt;
    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;
    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
      &lt;param-value&gt;classpath:springmvc.xml&lt;/param-value&gt;
    &lt;/init-param&gt;
    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
  &lt;/servlet&gt;

  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;

  &lt;!--配置解决中文乱码的过滤器--&gt;
  &lt;filter&gt;
    &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;encoding&lt;/param-name&gt;
      &lt;param-value&gt;UTF-8&lt;/param-value&gt;
    &lt;/init-param&gt;
  &lt;/filter&gt;
  &lt;filter-mapping&gt;
    &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;/filter-mapping&gt;

&lt;/web-app&gt;
</code></pre><hr>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/3
  Time: 21:25
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;a href=&quot;user/testString&quot; &gt;testString&lt;/a&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<hr>
<hr>
<h2 id="响应值值返回值是void类型"><a href="#响应值值返回值是void类型" class="headerlink" title="响应值值返回值是void类型"></a>响应值值返回值是void类型</h2><h3 id="第一种方法：编写请求转发程序跳转到jsp界面"><a href="#第一种方法：编写请求转发程序跳转到jsp界面" class="headerlink" title="第一种方法：编写请求转发程序跳转到jsp界面"></a>第一种方法：编写请求转发程序跳转到jsp界面</h3><pre><code>package cn.itcast.controller;

import cn.itcast.domain.User;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/3 21:26
 */
@Controller
@RequestMapping(&quot;/user&quot;)
public class UserController {

    /**
     * 返回值类型是一个字符串
     * @param model
     * @return
     */
    @RequestMapping(&quot;/testString&quot;)
    public String testString(Model model){
        System.out.println(&quot;testString方法执行了...&quot;);
//       模拟从数据库中查询对象
        User user = new User();
        user.setUsername(&quot;美美&quot;);
        user.setPassword(&quot;123&quot;);
        user.setAge(30);
//        把对象存起来
        model.addAttribute(&quot;user&quot;,user);
        return &quot;success&quot;;
    }


    /**
     * 返回值类型是Void
     * 请求转发是一次请求，请求路径不用编写项目名字
     * @param
     * @return
     */
    @RequestMapping(&quot;/testVoid&quot;)
    public void testVoid(HttpServletRequest request ,HttpServletResponse response)throws  Exception{
        System.out.println(&quot;testVoid方法执行了...&quot;);
//       便携请求转发的程序，手动便携转发程序不会通过视图解析器，所以要自己配置WEB-INF/pages/success.jsp需要自己提供完整目录
        request.getRequestDispatcher(&quot;/WEB-INF/pages/success.jsp&quot;).forward(request,response);

        return ;
    }
}
</code></pre><hr>
<pre><code>package cn.itcast.domain;

import java.io.Serializable;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/3 22:00
 */
public class User  implements Serializable {
    private String password;
    private Integer age;
    private String  username;

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public Integer getAge() {
        return age;
    }

    public void setAge(Integer age) {
        this.age = age;
    }

    public String getUsername() {
        return username;
    }

    public void setUsername(String username) {
        this.username = username;
    }
}
</code></pre><hr>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/3
  Time: 21:25
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;a href=&quot;user/testString&quot; &gt;testString&lt;/a&gt;
&lt;br&gt;
&lt;a href=&quot;user/testVoid&quot;&gt;testVoid&lt;/a&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<p>success.jsp</p>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/3
  Time: 21:22
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; isELIgnored=&quot;false&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h2&gt;执行成功&lt;/h2&gt;

${user.username}
${user.password}

&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<h3 id="第二种方法：重定向"><a href="#第二种方法：重定向" class="headerlink" title="第二种方法：重定向"></a>第二种方法：重定向</h3><p><img src="https://i.imgur.com/JKmwTno.png" alt=""></p>
<h3 id="第三种方法：直接响应"><a href="#第三种方法：直接响应" class="headerlink" title="第三种方法：直接响应"></a>第三种方法：直接响应</h3><p><img src="https://i.imgur.com/nqn2Zb5.png" alt=""></p>
<hr>
<h2 id="响应之返回值是ModelAndView类型"><a href="#响应之返回值是ModelAndView类型" class="headerlink" title="响应之返回值是ModelAndView类型"></a>响应之返回值是ModelAndView类型</h2><p>这个和返回值是String基本是一样的，只不过写法不同，返回值String底层也是调用这个的。<br><img src="https://i.imgur.com/cRzAOZk.png" alt=""></p>
<h2 id="转发和重定向"><a href="#转发和重定向" class="headerlink" title="转发和重定向"></a>转发和重定向</h2><p>有个问题没搞懂，重定向智能定位到根目录下的文件吗。为什么写和上面一样的路径不能跳转。是一个问题，尚未认真考虑解决呢。<br><img src="https://i.imgur.com/3qS26c7.png" alt=""></p>
<h2 id="ResponseBody注解响应json数据"><a href="#ResponseBody注解响应json数据" class="headerlink" title="ResponseBody注解响应json数据"></a>ResponseBody注解响应json数据</h2><p>页面发送一个axis请求，是一个异步请求，后台需要把对象转换成json的字符串响应回去可以通过ResponseBody这个注解完成这个任务。</p>
<p>这个地方需要告诉前端控制器不是所有请求都拦截的，静态资源比如.js和图片是不需要拦截的。下面这地方配置为/证明都拦截还需要在springmvc.xml中配置哪些不拦截<br><img src="https://i.imgur.com/R7peaUO.png" alt=""><br><img src="https://i.imgur.com/2pkeXim.png" alt=""></p>
<p>先看目录结构：<br><img src="https://i.imgur.com/DqJvvYs.png" alt="">里面的js文件视频中是从资料中直接拿到的。</p>
<p>下面是整个代码的结构：</p>
<p><img src="https://i.imgur.com/XvHH7N4.png" alt=""></p>
<p>response.jsp界面</p>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/3
  Time: 21:25
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
    &lt;%--下面这个是吧js引入到了jsp里面了--%&gt;
    &lt;script src=&quot;js/jquery.min.js&quot;&gt;&lt;/script&gt;
    &lt;script&gt;
        // 页面加载，绑定点击时间
        $(function(){
            $(&quot;#btn&quot;).click(function(){
                 alert(&quot;hello btn&quot;);
            });
        });
    &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;a href=&quot;user/testString&quot; &gt;testString&lt;/a&gt;
&lt;br&gt;
&lt;a href=&quot;user/testVoid&quot;&gt;testVoid&lt;/a&gt;
5&lt;br&gt;
&lt;%--转发或者重定向--%&gt;
&lt;a href=&quot;user/testForwardOrRedirect&quot;&gt;testForwardOrRedirect&lt;/a&gt;

&lt;%--写一个按钮--%&gt;
&lt;button id=&quot;btn&quot;&gt;发送ajax的请求&lt;/button&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<p>在springmvc.xml文件中设置哪些不拦截；</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;
       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xsi:schemaLocation=&quot;
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;

    &lt;!-- 开启注解扫描 扫描这个路径下的包，就可以在--&gt;
    &lt;context:component-scan base-package=&quot;cn.itcast&quot;/&gt;

    &lt;!-- 视图解析器对象  视图解析器的类名是固定的，然后配置通过这个视图解析器就可以让controller里面return的东西直接跳转指定的jsp页面
        但是还需要配置2个属性，一个是Prefix就是配置找文件的路径
        suffix指的是配置的后缀名字。最后也就是找/web-if/pages/下的后缀是jsp的文件--&gt;
    &lt;bean id=&quot;internalResourceViewResolver&quot; class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;
        &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/pages/&quot;/&gt;
        &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt;
    &lt;/bean&gt;

&lt;!--前端控制器，哪些静态资源不拦截，location写法就是以后js下所有的请求都不拦截，mapping就是和映射请求有关的,以后jss-图片也需要配置上不拦截--&gt;
    &lt;mvc:resources mapping=&quot;/js/&quot; location=&quot;/js/**&quot;/&gt;


&lt;!--     开启SpringMVC框架注解的支持 标签是固定的--&gt;
    &lt;mvc:annotation-driven  /&gt;

&lt;/beans&gt;
</code></pre><hr>
<h2 id="响应json数据之发送ajax请求"><a href="#响应json数据之发送ajax请求" class="headerlink" title="响应json数据之发送ajax请求"></a>响应json数据之发送ajax请求</h2><p>package cn.itcast.controller;</p>
<p>import cn.itcast.domain.User;<br>import org.springframework.stereotype.Controller;<br>import org.springframework.ui.Model;<br>import org.springframework.web.bind.annotation.RequestBody;<br>import org.springframework.web.bind.annotation.RequestMapping;<br>import org.springframework.web.servlet.ModelAndView;</p>
<p>import javax.servlet.http.HttpServletRequest;<br>import javax.servlet.http.HttpServletResponse;</p>
<p>/**</p>
<ul>
<li>@Description TODO</li>
<li>@Author TT Hun</li>
<li><p>@Data 2019/11/3 21:26<br>*/<br>@Controller<br>@RequestMapping(“/user”)<br>public class UserController {</p>
<p> /**</p>
<ul>
<li>模拟异步请求和响应过程</li>
<li>@param</li>
<li>@return<br>*/<br>@RequestMapping(“/testAjax”)<br>public void testAjax(@RequestBody String body){<br> System.out.println(“testForwardOrRedirect开始执行”);<br> System.out.println(body);<br>}<br>}</li>
</ul>
</li>
</ul>
<hr>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/3
  Time: 21:25
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
    &lt;%--下面这个是吧js引入到了jsp里面了--%&gt;
    &lt;script src=&quot;js/jquery.min.js&quot;&gt;&lt;/script&gt;
    &lt;script&gt;
        // 页面加载，绑定点击时间
        $(function(){
            $(&quot;#btn&quot;).click(function(){
                 // alert(&quot;hello btn&quot;);
            //    发送ajax请求
                $.ajax({
                //    编写json格式
                    url:&quot;user/testAjax&quot;,
                    //给服务器端传递的类型
                    contentType:&quot;application/json;charset=utf-8&quot;,
                    data:&apos;{&quot;username&quot;:&quot;呵呵&quot;,&quot;password&quot;:&quot;123&quot;,&quot;age&quot;:&quot;30&quot;}&apos;,
                    dataType:&quot;json&quot;,
                    type:&quot;post&quot;,
                    success:function (data){
                //        data指的是服务器端Json相应的数据，进行解析

                }
                })
            });

        });
    &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;a href=&quot;user/testString&quot; &gt;testString&lt;/a&gt;
&lt;br&gt;
&lt;a href=&quot;user/testVoid&quot;&gt;testVoid&lt;/a&gt;
5&lt;br&gt;
&lt;%--转发或者重定向--%&gt;
&lt;a href=&quot;user/testForwardOrRedirect&quot;&gt;testForwardOrRedirect&lt;/a&gt;

&lt;%--写一个按钮--%&gt;
&lt;button id=&quot;btn&quot;&gt;发送ajax的请求&lt;/button&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<p>结果直接拿到请求体<br><img src="https://i.imgur.com/Fm5iLrw.png" alt=""></p>
<hr>
<h3 id="怎么返回的json数据直接封装到对象当中"><a href="#怎么返回的json数据直接封装到对象当中" class="headerlink" title="怎么返回的json数据直接封装到对象当中"></a>怎么返回的json数据直接封装到对象当中</h3><p> springmvc框架已经帮我们做好了很多，如果Key和javabean中属性相同，可以直接封装到javabean里面，但是需要额外的jar包做类型转换。把串转成对象或者把对象转成串。</p>
<pre><code>package cn.itcast.controller;

import cn.itcast.domain.User;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.servlet.ModelAndView;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/3 21:26
 */
@Controller
@RequestMapping(&quot;/user&quot;)
public class UserController {

    @RequestMapping(&quot;/testAjax&quot;)
    public @ResponseBody User testAjax(@RequestBody User user){
        System.out.println(&quot;testAjax开始执行&quot;);
//       客户端发送的ajax请求，传递的是json字符串，后台已经把字符串封装到user对象当中去了
        System.out.println(user);
//        做一个响应
        user.setUsername(&quot;哈哈&quot;);
        user.setAge(40);
        user.setPassword(&quot;123&quot;);
        return user;
    }
}
</code></pre><hr>
<pre><code>package cn.itcast.domain;

import java.io.Serializable;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/3 22:00
 */
public class User  implements Serializable {
    private String password;
    private Integer age;
    private String  username;

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public Integer getAge() {
        return age;
    }

    public void setAge(Integer age) {
        this.age = age;
    }

    public String getUsername() {
        return username;
    }

    public void setUsername(String username) {
        this.username = username;
    }

    @Override
    public String toString() {
        return &quot;User{&quot; +
                &quot;password=&apos;&quot; + password + &apos;\&apos;&apos; +
                &quot;, age=&quot; + age +
                &quot;, username=&apos;&quot; + username + &apos;\&apos;&apos; +
                &apos;}&apos;;
    }
}
</code></pre><hr>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/3
  Time: 21:25
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
    &lt;%--下面这个是吧js引入到了jsp里面了--%&gt;
    &lt;script src=&quot;js/jquery.min.js&quot;&gt;&lt;/script&gt;
    &lt;script&gt;
        // 页面加载，绑定点击时间
        $(function(){
            $(&quot;#btn&quot;).click(function(){
                 // alert(&quot;hello btn&quot;);
            //    发送ajax请求
                $.ajax({
                //    编写json格式
                    url:&quot;user/testAjax&quot;,
                    //给服务器端传递的类型
                    contentType:&quot;application/json;charset=utf-8&quot;,
                    data:&apos;{&quot;username&quot;:&quot;呵呵&quot;,&quot;password&quot;:&quot;123&quot;,&quot;age&quot;:&quot;30&quot;}&apos;,
                    dataType:&quot;json&quot;,
                    type:&quot;post&quot;,
                    success:function (data){
                //        data指的是服务器端Json相应的数据，进行解析
                    alert(data);
                    alert(data.username);
                    alert(data.age);
                    alert(data.password);
                }
                })
            });

        });
    &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;a href=&quot;user/testString&quot; &gt;testString&lt;/a&gt;
&lt;br&gt;
&lt;a href=&quot;user/testVoid&quot;&gt;testVoid&lt;/a&gt;
5&lt;br&gt;
&lt;%--转发或者重定向--%&gt;
&lt;a href=&quot;user/testForwardOrRedirect&quot;&gt;testForwardOrRedirect&lt;/a&gt;

&lt;%--写一个按钮--%&gt;
&lt;button id=&quot;btn&quot;&gt;发送ajax的请求&lt;/button&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<p><img src="https://i.imgur.com/qJnIJQ4.png" alt=""></p>
<h1 id="第二章：SpringMVC实现文件上传"><a href="#第二章：SpringMVC实现文件上传" class="headerlink" title="第二章：SpringMVC实现文件上传"></a>第二章：SpringMVC实现文件上传</h1><h2 id="文件上传回顾"><a href="#文件上传回顾" class="headerlink" title="文件上传回顾"></a>文件上传回顾</h2><p>默认表单提交数据的格式是一组键值对的方式username=hehe&amp;password=123但是一旦把取值从默认变成multipart会把提交的表单分成几个部分，里面存储数据，可能包含文本框的值也可能包含上传选择文件的内容。<br><img src="https://i.imgur.com/3UI4KKM.png" alt=""></p>
<p>然后请求正文的内容变成：<br><img src="https://i.imgur.com/WUaN9Pk.png" alt=""><br><img src="https://i.imgur.com/koETv8W.png" alt=""></p>
<p>这时候表单用分隔符的方式把它分成了若干个部分。那么怎么去解析呢？通过一个jar包的组件<br><img src="https://i.imgur.com/eZ3Pu31.png" alt=""></p>
<hr>
<h2 id="首先环境搭建"><a href="#首先环境搭建" class="headerlink" title="首先环境搭建"></a>首先环境搭建</h2><p>配置springmvc.xml配置web.xml配置Pom.xml</p>
<pre><code>    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!-- $Id: pom.xml 642118 2008-03-28 08:04:16Z reinhard $ --&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;

  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;packaging&gt;war&lt;/packaging&gt;

  &lt;name&gt;springmvc_day02_02_fileupload&lt;/name&gt;
  &lt;groupId&gt;cn.itcast&lt;/groupId&gt;
  &lt;artifactId&gt;springmvc_day02_02_fileupload&lt;/artifactId&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;

  &lt;properties&gt;
    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
    &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;
    &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;
    &lt;spring.version&gt;5.0.2.RELEASE&lt;/spring.version&gt;
  &lt;/properties&gt;
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.mortbay.jetty&lt;/groupId&gt;
        &lt;artifactId&gt;maven-jetty-plugin&lt;/artifactId&gt;
        &lt;version&gt;6.1.7&lt;/version&gt;
        &lt;configuration&gt;
          &lt;connectors&gt;
            &lt;connector implementation=&quot;org.mortbay.jetty.nio.SelectChannelConnector&quot;&gt;
              &lt;port&gt;8888&lt;/port&gt;
              &lt;maxIdleTime&gt;30000&lt;/maxIdleTime&gt;
            &lt;/connector&gt;
          &lt;/connectors&gt;
          &lt;webAppSourceDirectory&gt;${project.build.directory}/${pom.artifactId}-${pom.version}&lt;/webAppSourceDirectory&gt;
          &lt;contextPath&gt;/&lt;/contextPath&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;

  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
      &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
      &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
      &lt;artifactId&gt;spring-web&lt;/artifactId&gt;
      &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
      &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
      &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
      &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
      &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;
      &lt;version&gt;2.5&lt;/version&gt;
      &lt;scope&gt;provided&lt;/scope&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
      &lt;groupId&gt;commons-fileupload&lt;/groupId&gt;
      &lt;artifactId&gt;commons-fileupload&lt;/artifactId&gt;
      &lt;version&gt;1.3.1&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;commons-io&lt;/groupId&gt;
      &lt;artifactId&gt;commons-io&lt;/artifactId&gt;
      &lt;version&gt;2.4&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
      &lt;groupId&gt;javax.servlet.jsp&lt;/groupId&gt;
      &lt;artifactId&gt;jsp-api&lt;/artifactId&gt;
      &lt;version&gt;2.0&lt;/version&gt;
      &lt;scope&gt;provided&lt;/scope&gt;
    &lt;/dependency&gt;

  &lt;/dependencies&gt;

&lt;/project&gt;
</code></pre><hr>
<p>web.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;

&lt;web-app version=&quot;2.4&quot;
         xmlns=&quot;http://java.sun.com/xml/ns/j2ee&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&quot;&gt;


  &lt;!--配置前端控制器--&gt;
  &lt;servlet&gt;
    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;
    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
      &lt;param-value&gt;classpath:springmvc.xml&lt;/param-value&gt;
    &lt;/init-param&gt;
    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
  &lt;/servlet&gt;

  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;

  &lt;!--配置解决中文乱码的过滤器--&gt;
  &lt;filter&gt;
    &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;encoding&lt;/param-name&gt;
      &lt;param-value&gt;UTF-8&lt;/param-value&gt;
    &lt;/init-param&gt;
  &lt;/filter&gt;
  &lt;filter-mapping&gt;
    &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;/filter-mapping&gt;
&lt;/web-app&gt;
</code></pre><hr>
<p>springmvc.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;
       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xsi:schemaLocation=&quot;
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;

    &lt;!-- 开启注解扫描 扫描这个路径下的包，就可以在--&gt;
    &lt;context:component-scan base-package=&quot;cn.itcast&quot;/&gt;

    &lt;!-- 视图解析器对象  视图解析器的类名是固定的，然后配置通过这个视图解析器就可以让controller里面return的东西直接跳转指定的jsp页面
        但是还需要配置2个属性，一个是Prefix就是配置找文件的路径
        suffix指的是配置的后缀名字。最后也就是找/web-if/pages/下的后缀是jsp的文件--&gt;
    &lt;bean id=&quot;internalResourceViewResolver&quot; class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;
        &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/pages/&quot;/&gt;
        &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt;
    &lt;/bean&gt;

&lt;!--前端控制器，哪些静态资源不拦截，location写法就是以后js下所有的请求都不拦截，mapping就是和映射请求有关的,以后jss-图片也需要配置上不拦截--&gt;
    &lt;mvc:resources mapping=&quot;/js/&quot; location=&quot;/js/**&quot;/&gt;


&lt;!--     开启SpringMVC框架注解的支持 标签是固定的--&gt;
    &lt;mvc:annotation-driven  /&gt;

&lt;/beans&gt;
</code></pre><hr>
<h2 id="文件上传之传统方式上传代码"><a href="#文件上传之传统方式上传代码" class="headerlink" title="文件上传之传统方式上传代码"></a>文件上传之传统方式上传代码</h2><p>index.jsp文件：<br>    &lt;%–<br>      Created by IntelliJ IDEA.<br>      User: Hun<br>      Date: 2019/11/5<br>      Time: 11:25<br>      To change this template use File | Settings | File Templates.<br>    –%&gt;<br>    &lt;%@ page contentType=”text/html;charset=UTF-8” language=”java” %&gt;<br>    <html><br>    <head><br>        <title>文件上传</title><br>    </head><br>    <body><br>    <h3>文件上传</h3><br>    <form action="user/fileupload1" method="post" enctype="multipart/form-data"><br>        选择上传文件：<input type="file" name="upload"><br>        <br><br>        <input type="submit" value="上传"><br>    </form><br>    </body><br>    </html></p>
<hr>
<p>success.jsp<br>    &lt;%–<br>      Created by IntelliJ IDEA.<br>      User: Hun<br>      Date: 2019/11/5<br>      Time: 11:28<br>      To change this template use File | Settings | File Templates.<br>    –%&gt;<br>    &lt;%@ page contentType=”text/html;charset=UTF-8” language=”java” %&gt;<br>    <html><br>    <head><br>        <title>Title</title><br>    </head><br>    <body><br>    <h3>上传文件成功</h3><br>    </body><br>    </html></p>
<hr>
<pre><code>package cn.itcast.controller;

import org.apache.commons.fileupload.FileItem;
import org.apache.commons.fileupload.disk.DiskFileItemFactory;
import org.apache.commons.fileupload.servlet.ServletFileUpload;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;

import javax.servlet.http.HttpServletRequest;
import java.io.File;
import java.util.List;
import java.util.UUID;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/5 11:26
 */
@Controller
@RequestMapping(&quot;/user&quot;)
public class UserController {

    /**
     * 文件上传
     * @return
     */
    @RequestMapping(&quot;/fileupload1&quot;)
    public String fileUpload1(HttpServletRequest request) throws Exception{
        System.out.println(&quot;文件上传&quot;);
//        可以使用fileupload这个组件完成上传
//        上传的位置
        String path = request.getSession().getServletContext().getRealPath(&quot;/uploads/&quot;);
//        判断改路径是否存在：
        File file = new File(path);
        if(!file.exists()){
            file.mkdirs();
        }
//    解析request对象获取到上传的文件项
        DiskFileItemFactory factory=new DiskFileItemFactory();
        ServletFileUpload upload = new ServletFileUpload(factory);
//   解析request
        List&lt;FileItem&gt; items = upload.parseRequest(request);
//        遍历
        for(FileItem item:items){
//            进行判断，判断item对象是否是上传文件项目
            if(item.isFormField()){
//                如果是true则是普通表单项目，如果是false则是上传文件项
            }else{
//                说明是上传文件项
//                 获取到上传文件的名称
                String filename = item.getName();
//                把文件名设置成唯一值，uuid
                String uuid = UUID.randomUUID().toString().replace(&quot;-&quot;,&quot;&quot;);
                filename = uuid+&quot;_&quot;+filename;
//                完成文件上传
                item.write(new File(path,filename));
//                删除临时文件。一旦大于10KB就生成临时文件
                item.delete();


            }
        }

        return &quot;success&quot;;
    }
}
</code></pre><hr>
<p>最终结果的图片落在这里：<br><img src="https://i.imgur.com/k0zwX9f.png" alt=""></p>
<h2 id="SpringMVC上传文件"><a href="#SpringMVC上传文件" class="headerlink" title="SpringMVC上传文件"></a>SpringMVC上传文件</h2><p>首先看一下整体原理：<br>解释一下下面的图：也就是上传的文件通过写在域里面通过request传递到前端控制器，前端控制器通过配置好的文件解析器解析request,然后拿到上传文件。再传递给Controller里面和文件解析器中相同参数名的参数。然后再调用他的方法对他进行使用。<br><img src="https://i.imgur.com/7edLiOL.png" alt=""><br><strong>完整代码如下：</strong><br> Controller</p>
<pre><code>package cn.itcast.controller;

import org.apache.commons.fileupload.FileItem;
import org.apache.commons.fileupload.disk.DiskFileItemFactory;
import org.apache.commons.fileupload.servlet.ServletFileUpload;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.multipart.MultipartFile;

import javax.servlet.http.HttpServletRequest;
import java.io.File;
import java.util.List;
import java.util.UUID;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/5 11:26
 */
@Controller
@RequestMapping(&quot;/user&quot;)
public class UserController {

    /**
     * 传统方式文件上传
     * @return
     */
    @RequestMapping(&quot;/fileupload1&quot;)
    public String fileUpload1(HttpServletRequest request) throws Exception{
        System.out.println(&quot;文件上传&quot;);
//        可以使用fileupload这个组件完成上传
//        上传的位置
        String path = request.getSession().getServletContext().getRealPath(&quot;/uploads/&quot;);
//        判断改路径是否存在：
        File file = new File(path);
        if(!file.exists()){
            file.mkdirs();
        }
//    解析request对象获取到上传的文件项
        DiskFileItemFactory factory=new DiskFileItemFactory();
        ServletFileUpload upload = new ServletFileUpload(factory);
//   解析request
        List&lt;FileItem&gt; items = upload.parseRequest(request);
//        遍历
        for(FileItem item:items){
//            进行判断，判断item对象是否是上传文件项目
            if(item.isFormField()){
//                如果是true则是普通表单项目，如果是false则是上传文件项
            }else{
//                说明是上传文件项
//                 获取到上传文件的名称
                String filename = item.getName();
//                把文件名设置成唯一值，uuid
                String uuid = UUID.randomUUID().toString().replace(&quot;-&quot;,&quot;&quot;);
                filename = uuid+&quot;_&quot;+filename;
//                完成文件上传
                item.write(new File(path,filename));
//                删除临时文件。一旦大于10KB就生成临时文件
                item.delete();
            }
        }
        return &quot;success&quot;;
    }

    /**
     * SpringMVC方式文件上传
     * @return
     */
    @RequestMapping(&quot;/fileupload2&quot;)
    public String fileUpload2(HttpServletRequest request ,MultipartFile upload) throws Exception{
        System.out.println(&quot;文件上传&quot;);
//        可以使用fileupload这个组件完成上传
//        上传的位置
        String path = request.getSession().getServletContext().getRealPath(&quot;/uploads/&quot;);
//        判断改路径是否存在：
        File file = new File(path);
        if(!file.exists()){
            file.mkdirs();
        }
//         说明是上传文件项
//         获取到上传文件的名称
        String filename = upload.getOriginalFilename();
//         把文件名设置成唯一值，uuid
         String uuid = UUID.randomUUID().toString().replace(&quot;-&quot;,&quot;&quot;);
         filename = uuid+&quot;_&quot;+filename;
//         完成文件上传
        upload.transferTo(new File(path,filename));
        return &quot;success&quot;;
    }
}
</code></pre><hr>
<p>springmvc.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;
       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xsi:schemaLocation=&quot;
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;

    &lt;!-- 开启注解扫描 扫描这个路径下的包，就可以在--&gt;
    &lt;context:component-scan base-package=&quot;cn.itcast&quot;/&gt;

    &lt;!-- 视图解析器对象  视图解析器的类名是固定的，然后配置通过这个视图解析器就可以让controller里面return的东西直接跳转指定的jsp页面
        但是还需要配置2个属性，一个是Prefix就是配置找文件的路径
        suffix指的是配置的后缀名字。最后也就是找/web-if/pages/下的后缀是jsp的文件--&gt;
    &lt;bean id=&quot;internalResourceViewResolver&quot; class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;
        &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/pages/&quot;/&gt;
        &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt;
    &lt;/bean&gt;

&lt;!--前端控制器，哪些静态资源不拦截，location写法就是以后js下所有的请求都不拦截，mapping就是和映射请求有关的,以后jss-图片也需要配置上不拦截--&gt;
    &lt;mvc:resources mapping=&quot;/js/&quot; location=&quot;/js/**&quot;/&gt;

&lt;!--    配置文件解析器对象--&gt;
    &lt;bean id=&quot;multipartResolver&quot; class=&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;&gt;
&lt;!--        这个是配置最大上传文件。value是字节为单位，下面这个也就是10M  --&gt;
        &lt;property name=&quot;maxUploadSize&quot; value=&quot;10485760&quot; /&gt;
    &lt;/bean&gt;

&lt;!--     开启SpringMVC框架注解的支持 标签是固定的--&gt;
    &lt;mvc:annotation-driven  /&gt;

&lt;/beans&gt;
</code></pre><hr>
<p>index.jsp</p>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/5
  Time: 11:25
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;文件上传&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h3&gt;文件上传&lt;/h3&gt;
&lt;form action=&quot;user/fileupload1&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
    选择上传文件：&lt;input type=&quot;file&quot; name=&quot;upload&quot;/&gt;
    &lt;br/&gt;
    &lt;input type=&quot;submit&quot; value=&quot;上传&quot;/&gt;
&lt;/form&gt;

&lt;form action=&quot;user/fileupload2&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
    选择上传文件：&lt;input type=&quot;file&quot; name=&quot;upload&quot;/&gt;
    &lt;br/&gt;
    &lt;input type=&quot;submit&quot; value=&quot;上传&quot;/&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<p>web.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;

&lt;!--
  - This is the Cocoon web-app configurations file
  -
  - $Id$
  --&gt;
&lt;web-app version=&quot;2.4&quot;
         xmlns=&quot;http://java.sun.com/xml/ns/j2ee&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&quot;&gt;


  &lt;!--配置前端控制器--&gt;
  &lt;servlet&gt;
    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;
    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
      &lt;param-value&gt;classpath:springmvc.xml&lt;/param-value&gt;
    &lt;/init-param&gt;
    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
  &lt;/servlet&gt;

  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;

  &lt;!--配置解决中文乱码的过滤器--&gt;
  &lt;filter&gt;
    &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;encoding&lt;/param-name&gt;
      &lt;param-value&gt;UTF-8&lt;/param-value&gt;
    &lt;/init-param&gt;
  &lt;/filter&gt;
  &lt;filter-mapping&gt;
    &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;/filter-mapping&gt;
&lt;/web-app&gt;
</code></pre><hr>
<p><img src="https://i.imgur.com/I7bTQPD.png" alt=""></p>
<h2 id="SpringMVC跨服务器方式的文件上传"><a href="#SpringMVC跨服务器方式的文件上传" class="headerlink" title="SpringMVC跨服务器方式的文件上传"></a>SpringMVC跨服务器方式的文件上传</h2><p><img src="https://i.imgur.com/coohqTT.png" alt=""><br>目前跨服务器的内容由于图片服务器没有打开所以目前还没成功，可能是因为图片服务器的配置问题。代码肯定没问题：</p>
<pre><code>package cn.itcast.controller;

import com.sun.jersey.api.client.Client;
import com.sun.jersey.api.client.WebResource;
import org.apache.commons.fileupload.FileItem;
import org.apache.commons.fileupload.disk.DiskFileItemFactory;
import org.apache.commons.fileupload.servlet.ServletFileUpload;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.multipart.MultipartFile;

import javax.servlet.http.HttpServletRequest;
import java.io.File;
import java.util.List;
import java.util.UUID;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/5 11:26
 */
@Controller
@RequestMapping(&quot;/user&quot;)
public class UserController {
    /**
     * 跨服务器文件上传
     * @return
     */
    @RequestMapping(&quot;/fileupload3&quot;)
    public String fileuoload3(MultipartFile upload) throws Exception {
        System.out.println(&quot;跨服务器文件上传...&quot;);

        // 定义上传文件服务器路径
        String path = &quot;http://localhost:9999/uploads/&quot;;
        // 说明上传文件项
        // 获取上传文件的名称
        String filename = upload.getOriginalFilename();
        // 把文件的名称设置唯一值，uuid
        String uuid = UUID.randomUUID().toString().replace(&quot;-&quot;, &quot;&quot;);
        filename = uuid+&quot;_&quot;+filename;
        // 创建客户端的对象
        Client client = Client.create();
        // 和图片服务器进行连接
        WebResource webResource = client.resource(path + filename);
        // 上传文件
        webResource.put(upload.getBytes());
        return &quot;success&quot;;
    }
}
</code></pre><hr>
<p>springmvc.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;
       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xsi:schemaLocation=&quot;
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;

    &lt;!-- 开启注解扫描 --&gt;
    &lt;context:component-scan base-package=&quot;cn.itcast&quot;/&gt;

    &lt;!-- 视图解析器对象 --&gt;
    &lt;bean id=&quot;internalResourceViewResolver&quot; class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;
        &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/pages/&quot;/&gt;
        &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt;
    &lt;/bean&gt;

    &lt;!--前端控制器，哪些静态资源不拦截--&gt;
    &lt;mvc:resources location=&quot;/css/&quot; mapping=&quot;/css/**&quot;/&gt;
    &lt;mvc:resources location=&quot;/images/&quot; mapping=&quot;/images/**&quot;/&gt;
    &lt;mvc:resources location=&quot;/js/&quot; mapping=&quot;/js/**&quot;/&gt;

    &lt;!--配置文件解析器对象--&gt;
    &lt;bean id=&quot;multipartResolver&quot; class=&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;&gt;
        &lt;property name=&quot;maxUploadSize&quot; value=&quot;10485760&quot; /&gt;
    &lt;/bean&gt;

    &lt;!-- 开启SpringMVC框架注解的支持 --&gt;
    &lt;mvc:annotation-driven /&gt;

&lt;/beans&gt;
</code></pre><hr>
<p>web.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the &quot;License&quot;); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--&gt;

&lt;!--
  - This is the Cocoon web-app configurations file
  -
  - $Id$
  --&gt;
&lt;web-app version=&quot;2.4&quot;
         xmlns=&quot;http://java.sun.com/xml/ns/j2ee&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&quot;&gt;


  &lt;!--配置前端控制器--&gt;
  &lt;servlet&gt;
    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;
    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
      &lt;param-value&gt;classpath:springmvc.xml&lt;/param-value&gt;
    &lt;/init-param&gt;
    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
  &lt;/servlet&gt;

  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;

  &lt;!--配置解决中文乱码的过滤器--&gt;
  &lt;filter&gt;
    &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;encoding&lt;/param-name&gt;
      &lt;param-value&gt;UTF-8&lt;/param-value&gt;
    &lt;/init-param&gt;
  &lt;/filter&gt;
  &lt;filter-mapping&gt;
    &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;/filter-mapping&gt;
&lt;/web-app&gt;
</code></pre><hr>
<p>index.jsp</p>
<pre><code>    &lt;%--
      Created by IntelliJ IDEA.
      User: Hun
      Date: 2019/11/5
      Time: 11:25
      To change this template use File | Settings | File Templates.
    --%&gt;
    &lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
    &lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;文件上传&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
    &lt;h3&gt;文件上传&lt;/h3&gt;
    &lt;form action=&quot;user/fileupload1&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
        选择上传文件：&lt;input type=&quot;file&quot; name=&quot;upload&quot;/&gt;
        &lt;br/&gt;
        &lt;input type=&quot;submit&quot; value=&quot;上传&quot;/&gt;
    &lt;/form&gt;

    &lt;form action=&quot;user/fileupload2&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
        选择上传文件：&lt;input type=&quot;file&quot; name=&quot;upload&quot;/&gt;
        &lt;br/&gt;
        &lt;input type=&quot;submit&quot; value=&quot;上传&quot;/&gt;
    &lt;/form&gt;

    &lt;h2&gt;跨服务器文件上传&lt;/h2&gt;
    &lt;form action=&quot;user/fileupload3&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
        选择上传文件：&lt;input type=&quot;file&quot; name=&quot;upload&quot;/&gt;
        &lt;br/&gt;
        &lt;input type=&quot;submit&quot; value=&quot;上传&quot;/&gt;
    &lt;/form&gt;


    &lt;/body&gt;
    &lt;/html&gt;
***
success.jsp

&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/5
  Time: 11:28
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h3&gt;上传文件成功&lt;/h3&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<p>图片服务器略。</p>
<h1 id="第三章SpringMVC异常处理"><a href="#第三章SpringMVC异常处理" class="headerlink" title="第三章SpringMVC异常处理"></a>第三章SpringMVC异常处理</h1><h2 id="SpringMVC异常处理之处理代码编写"><a href="#SpringMVC异常处理之处理代码编写" class="headerlink" title="SpringMVC异常处理之处理代码编写"></a>SpringMVC异常处理之处理代码编写</h2><p><img src="https://i.imgur.com/ZHUrpOK.png" alt=""></p>
<pre><code>package cn.itcast.controller;

import cn.itcast.exception.SysException;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/5 22:38
 */
@Controller
@RequestMapping(&quot;/user&quot;)
public class UserController {
    @RequestMapping(&quot;/testException&quot;)
    public String testException() throws SysException {
        System.out.println(&quot;testException 执行了&quot;);
        try {
//        模拟异常
            int a = 10 / 0;
        } catch (Exception e) {
//            控制台打印异常信息
            e.printStackTrace();
//           向上抛出异常信息
            throw new SysException(&quot;查询所有用户出错了。。。&quot;);

        }
        return &quot;success&quot;;
    }
}
</code></pre><hr>
<pre><code>package cn.itcast.exception;

/**
 * @Description 自定义的异常类
 * @Author TT Hun
 * @Data 2019/11/5 23:06
 */
public class SysException extends Exception {
//    用来存储提示信息的
    private String message;

    @Override
    public String getMessage() {
        return message;
    }

    public void setMessage(String message) {
        this.message = message;
    }

    public SysException(String message) {
        this.message = message;
    }
}
</code></pre><hr>
<pre><code>package cn.itcast.exception;

import org.springframework.web.servlet.HandlerExceptionResolver;
import org.springframework.web.servlet.ModelAndView;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * @Description 异常处理器
 * @Author TT Hun
 * @Data 2019/11/5 23:10
 */
public class SysExceptionResolver implements HandlerExceptionResolver {
    /**
     * 处理异常逻辑
     * @param request
     * @param response
     * @param handler
     * @param ex
     * @return
     */
    public ModelAndView resolveException(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) {

        // 获取到异常对象
        SysException e = null;
//        判断是否是ex异常
        if(ex instanceof SysException) {
            e = (SysException) ex;
        } else{//如果不是的话
            e = new SysException(&quot;系统正在维护....&quot;);
        }
        // 创建ModelAndView对象，这个modelandview可以帮助跳转到那个界面
        ModelAndView mv = new ModelAndView();
//        向里面存入提示信息，存了一组键值对
        mv.addObject(&quot;errorMsg&quot;,e.getMessage());
//        往哪里跳转
        mv.setViewName(&quot;error&quot;);
        return mv;
    }
}
</code></pre><hr>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;
       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xsi:schemaLocation=&quot;
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;

    &lt;!-- 开启注解扫描 --&gt;
    &lt;context:component-scan base-package=&quot;cn.itcast&quot;/&gt;

    &lt;!-- 视图解析器对象 --&gt;
    &lt;bean id=&quot;internalResourceViewResolver&quot; class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;
        &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/pages/&quot;/&gt;
        &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt;
    &lt;/bean&gt;

    &lt;!--前端控制器，哪些静态资源不拦截--&gt;
    &lt;mvc:resources location=&quot;/css/&quot; mapping=&quot;/css/**&quot;/&gt;
    &lt;mvc:resources location=&quot;/images/&quot; mapping=&quot;/images/**&quot;/&gt;
    &lt;mvc:resources location=&quot;/js/&quot; mapping=&quot;/js/**&quot;/&gt;

    &lt;!--配置异常处理器--&gt;
    &lt;bean id=&quot;sysExceptionResolver&quot; class=&quot;cn.itcast.exception.SysExceptionResolver&quot;/&gt;

    &lt;!-- 开启SpringMVC框架注解的支持 --&gt;
    &lt;mvc:annotation-driven /&gt;

&lt;/beans&gt;
</code></pre><hr>
<p>error.jsp</p>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/6
  Time: 9:35
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; isELIgnored=&quot;false&quot;%&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

    ${errorMsg}
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<p>success.jsp</p>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/5
  Time: 22:41
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h3&gt;测试成功&lt;/h3&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<pre><code>&lt;!DOCTYPE web-app PUBLIC
 &quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot;
 &quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot; &gt;

&lt;web-app&gt;
  &lt;display-name&gt;Archetype Created Web Application&lt;/display-name&gt;

  &lt;servlet&gt;
    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;
    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
      &lt;param-value&gt;classpath:springmvc.xml&lt;/param-value&gt;
    &lt;/init-param&gt;
    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
  &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;

  &lt;!--配置解决中文乱码的过滤器--&gt;
  &lt;filter&gt;
    &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;encoding&lt;/param-name&gt;
      &lt;param-value&gt;UTF-8&lt;/param-value&gt;
    &lt;/init-param&gt;
  &lt;/filter&gt;
  &lt;filter-mapping&gt;
    &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;/filter-mapping&gt;

&lt;/web-app&gt;
</code></pre><hr>
<p>index.jsp</p>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Administrator
  Date: 2018/5/5
  Time: 22:08
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

    &lt;h3&gt;异常处理&lt;/h3&gt;

    &lt;a href=&quot;user/testException&quot; &gt;异常处理&lt;/a&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<p>pom文件：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!--
  Licensed to the Apache Software Foundation (ASF) under one
  or more contributor license agreements.  See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License, Version 2.0 (the
  &quot;License&quot;); you may not use this file except in compliance
  with the License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing,
  software distributed under the License is distributed on an
  &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, either express or implied.  See the License for the
  specific language governing permissions and limitations
  under the License.
--&gt;
&lt;!-- $Id: pom.xml 642118 2008-03-28 08:04:16Z reinhard $ --&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;
    &lt;properties&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
        &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;
        &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;
        &lt;spring.version&gt;5.0.2.RELEASE&lt;/spring.version&gt;
    &lt;/properties&gt;


    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;packaging&gt;war&lt;/packaging&gt;

    &lt;name&gt;springmvc_day02_03_exception1&lt;/name&gt;
    &lt;artifactId&gt;springmvc_day02_03_exception1&lt;/artifactId&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.mortbay.jetty&lt;/groupId&gt;
                &lt;artifactId&gt;maven-jetty-plugin&lt;/artifactId&gt;
                &lt;version&gt;6.1.7&lt;/version&gt;
                &lt;configuration&gt;
                    &lt;connectors&gt;
                        &lt;connector implementation=&quot;org.mortbay.jetty.nio.SelectChannelConnector&quot;&gt;
                            &lt;port&gt;8888&lt;/port&gt;
                            &lt;maxIdleTime&gt;30000&lt;/maxIdleTime&gt;
                        &lt;/connector&gt;
                    &lt;/connectors&gt;
                    &lt;webAppSourceDirectory&gt;${project.build.directory}/${pom.artifactId}-${pom.version}
                    &lt;/webAppSourceDirectory&gt;
                    &lt;contextPath&gt;/&lt;/contextPath&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-web&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
            &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;
            &lt;version&gt;2.5&lt;/version&gt;
            &lt;scope&gt;provided&lt;/scope&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;javax.servlet.jsp&lt;/groupId&gt;
            &lt;artifactId&gt;jsp-api&lt;/artifactId&gt;
            &lt;version&gt;2.0&lt;/version&gt;
            &lt;scope&gt;provided&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

&lt;/project&gt;
</code></pre><hr>
<h2 id="SpringMVC中的拦截器"><a href="#SpringMVC中的拦截器" class="headerlink" title="SpringMVC中的拦截器"></a>SpringMVC中的拦截器</h2><p><img src="https://i.imgur.com/AJ9Uzzi.png" alt=""><br>拦截器只会拦截控制器中的方法，也就是Controller中的方法。JSP之类的资源不会拦截的。过滤器什么都可以拦截。也就是拦截器可以做的事情过滤器都可以做。但是过滤器可以做的事情拦截器不一定会做。<br><strong>拦截器完整代码</strong><br>注意Pom中的依赖使用那一些依赖：</p>
<p>先看一下目录；<br><img src="https://i.imgur.com/q7Ee3uo.png" alt=""></p>
<pre><code>package cn.itcast.controller.cn.itcast.interceptor;

import org.springframework.web.servlet.HandlerInterceptor;
import org.springframework.web.servlet.ModelAndView;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * 自定义拦截器
 */
public class MyInterceptor1 implements HandlerInterceptor{

    /**
     * 预处理，controller方法执行前
     * return true 放行，执行下一个拦截器，如果没有，执行controller中的方法
     * return false不放行
     * @param request
     * @param response
     * @param handler
     * @return
     * @throws Exception
     */
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {
        System.out.println(&quot;MyInterceptor1执行了...前1111&quot;);
        // request.getRequestDispatcher(&quot;/WEB-INF/pages/error.jsp&quot;).forward(request,response);
        return true;
    }

    /**
     * 后处理方法，controller方法执行后，success.jsp执行之前
     * @param request
     * @param response
     * @param handler
     * @param modelAndView
     * @throws Exception
     */
    @Override
    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception {
        System.out.println(&quot;MyInterceptor1执行了...后1111&quot;);
        // request.getRequestDispatcher(&quot;/WEB-INF/pages/error.jsp&quot;).forward(request,response);
    }

    /**
     * success.jsp页面执行后，该方法会执行
     * @param request
     * @param response
     * @param handler
     * @param ex
     * @throws Exception
     */
    @Override
    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception {
        System.out.println(&quot;MyInterceptor1执行了...最后1111&quot;);
    }
}
</code></pre><hr>
<pre><code>package cn.itcast.controller.cn.itcast.interceptor;

import org.springframework.web.servlet.HandlerInterceptor;
import org.springframework.web.servlet.ModelAndView;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * 自定义拦截器
 */
public class MyInterceptor2 implements HandlerInterceptor{

    /**
     * 预处理，controller方法执行前
     * return true 放行，执行下一个拦截器，如果没有，执行controller中的方法
     * return false不放行
     * @param request
     * @param response
     * @param handler
     * @return
     * @throws Exception
     */
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {
        System.out.println(&quot;MyInterceptor1执行了...前2222&quot;);
        // request.getRequestDispatcher(&quot;/WEB-INF/pages/error.jsp&quot;).forward(request,response);
        return true;
    }

    /**
     * 后处理方法，controller方法执行后，success.jsp执行之前
     * @param request
     * @param response
     * @param handler
     * @param modelAndView
     * @throws Exception
     */
    @Override
    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception {
        System.out.println(&quot;MyInterceptor1执行了...后2222&quot;);
        // request.getRequestDispatcher(&quot;/WEB-INF/pages/error.jsp&quot;).forward(request,response);
    }

    /**
     * success.jsp页面执行后，该方法会执行
     * @param request
     * @param response
     * @param handler
     * @param ex
     * @throws Exception
     */
    @Override
    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception {
        System.out.println(&quot;MyInterceptor1执行了...最后2222&quot;);
    }

}
</code></pre><hr>
<pre><code>package cn.itcast.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
@RequestMapping(&quot;/user&quot;)
public class UserController {

    @RequestMapping(&quot;/testInterceptor&quot;)
    public String testInterceptor(){
        System.out.println(&quot;testInterceptor执行了...&quot;);
        return &quot;success&quot;;
    }

}
</code></pre><hr>
<p>springmvc.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;
       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xsi:schemaLocation=&quot;
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;

    &lt;!-- 开启注解扫描 --&gt;
    &lt;context:component-scan base-package=&quot;cn.itcast&quot;/&gt;

    &lt;!-- 视图解析器对象 --&gt;
    &lt;bean id=&quot;internalResourceViewResolver&quot; class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;
        &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/pages/&quot;/&gt;
        &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt;
    &lt;/bean&gt;

    &lt;!--前端控制器，哪些静态资源不拦截--&gt;
    &lt;mvc:resources location=&quot;/css/&quot; mapping=&quot;/css/**&quot;/&gt;
    &lt;mvc:resources location=&quot;/images/&quot; mapping=&quot;/images/**&quot;/&gt;
    &lt;mvc:resources location=&quot;/js/&quot; mapping=&quot;/js/**&quot;/&gt;

    &lt;!--配置拦截器--&gt;
    &lt;mvc:interceptors&gt;
        &lt;!--配置拦截器--&gt;
        &lt;mvc:interceptor&gt;
            &lt;!--要拦截的具体的方法--&gt;
            &lt;mvc:mapping path=&quot;/user/*&quot;/&gt;
            &lt;!--不要拦截的方法
            &lt;mvc:exclude-mapping path=&quot;&quot;/&gt;
            --&gt;
            &lt;!--配置拦截器对象--&gt;
            &lt;bean class=&quot;cn.itcast.controller.cn.itcast.interceptor.MyInterceptor1&quot; /&gt;
        &lt;/mvc:interceptor&gt;

        &lt;!--配置第二个拦截器--&gt;
        &lt;mvc:interceptor&gt;
            &lt;!--要拦截的具体的方法--&gt;
            &lt;mvc:mapping path=&quot;/**&quot;/&gt;
            &lt;!--不要拦截的方法
            &lt;mvc:exclude-mapping path=&quot;&quot;/&gt;
            --&gt;
            &lt;!--配置拦截器对象--&gt;
            &lt;bean class=&quot;cn.itcast.controller.cn.itcast.interceptor.MyInterceptor2&quot; /&gt;
        &lt;/mvc:interceptor&gt;
    &lt;/mvc:interceptors&gt;

    &lt;!-- 开启SpringMVC框架注解的支持 --&gt;
    &lt;mvc:annotation-driven /&gt;

&lt;/beans&gt;
</code></pre><hr>
<p>error.jsp</p>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/6
  Time: 9:35
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; isELIgnored=&quot;false&quot;%&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

    ${errorMsg}
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<p>success.jsp</p>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/5
  Time: 22:41
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h3&gt;测试成功&lt;/h3&gt;

&lt;%--这个代表执行的Java脚本--%&gt;
&lt;% System.out.println(&quot;success.jsp成功执行了...  &quot;); %&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<p>web.xml</p>
<pre><code>&lt;!DOCTYPE web-app PUBLIC
        &quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot;
        &quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot; &gt;

&lt;web-app&gt;
  &lt;display-name&gt;Archetype Created Web Application&lt;/display-name&gt;

  &lt;servlet&gt;
    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;
    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
      &lt;param-value&gt;classpath:springmvc.xml&lt;/param-value&gt;
    &lt;/init-param&gt;
    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
  &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;

  &lt;!--配置解决中文乱码的过滤器--&gt;
  &lt;filter&gt;
    &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;encoding&lt;/param-name&gt;
      &lt;param-value&gt;UTF-8&lt;/param-value&gt;
    &lt;/init-param&gt;
  &lt;/filter&gt;
  &lt;filter-mapping&gt;
    &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;/filter-mapping&gt;

&lt;/web-app&gt;
</code></pre><hr>
<p>index.jsp</p>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Administrator
  Date: 2018/5/5
  Time: 22:08
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

    &lt;h3&gt;拦截器&lt;/h3&gt;

    &lt;a href=&quot;user/testInterceptor&quot; &gt;拦截器&lt;/a&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<p>pom.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;

&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

  &lt;groupId&gt;cn.itcast&lt;/groupId&gt;
  &lt;artifactId&gt;springmvc_day02_04_interceptor&lt;/artifactId&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;packaging&gt;war&lt;/packaging&gt;

  &lt;name&gt;springmvc_day02_04_interceptor Maven Webapp&lt;/name&gt;
  &lt;!-- FIXME change it to the project&apos;s website --&gt;
  &lt;url&gt;http://www.example.com&lt;/url&gt;

  &lt;properties&gt;
    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
    &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;
    &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;
    &lt;spring.version&gt;5.0.2.RELEASE&lt;/spring.version&gt;
  &lt;/properties&gt;

  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
      &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
      &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
      &lt;artifactId&gt;spring-web&lt;/artifactId&gt;
      &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
      &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
      &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
      &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
      &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;
      &lt;version&gt;2.5&lt;/version&gt;
      &lt;scope&gt;provided&lt;/scope&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
      &lt;groupId&gt;javax.servlet.jsp&lt;/groupId&gt;
      &lt;artifactId&gt;jsp-api&lt;/artifactId&gt;
      &lt;version&gt;2.0&lt;/version&gt;
      &lt;scope&gt;provided&lt;/scope&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;

  &lt;build&gt;
    &lt;finalName&gt;springmvc_day02_04_interceptor&lt;/finalName&gt;
    &lt;pluginManagement&gt;&lt;!-- lock down plugins versions to avoid using Maven defaults (may be moved to parent pom) --&gt;
      &lt;plugins&gt;
        &lt;plugin&gt;
          &lt;artifactId&gt;maven-clean-plugin&lt;/artifactId&gt;
          &lt;version&gt;3.0.0&lt;/version&gt;
        &lt;/plugin&gt;
        &lt;plugin&gt;
          &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt;
          &lt;version&gt;3.0.2&lt;/version&gt;
        &lt;/plugin&gt;
        &lt;plugin&gt;
          &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
          &lt;version&gt;3.7.0&lt;/version&gt;
        &lt;/plugin&gt;
        &lt;plugin&gt;
          &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
          &lt;version&gt;2.20.1&lt;/version&gt;
        &lt;/plugin&gt;
        &lt;plugin&gt;
          &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;
          &lt;version&gt;3.2.0&lt;/version&gt;
        &lt;/plugin&gt;
        &lt;plugin&gt;
          &lt;artifactId&gt;maven-install-plugin&lt;/artifactId&gt;
          &lt;version&gt;2.5.2&lt;/version&gt;
        &lt;/plugin&gt;
        &lt;plugin&gt;
          &lt;artifactId&gt;maven-deploy-plugin&lt;/artifactId&gt;
          &lt;version&gt;2.8.2&lt;/version&gt;
        &lt;/plugin&gt;
      &lt;/plugins&gt;
    &lt;/pluginManagement&gt;
  &lt;/build&gt;
&lt;/project&gt;
</code></pre><hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2019/10/24/SpringMVC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/24/SpringMVC/" itemprop="url">SpringMVC</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-24T20:57:21+08:00">
                2019-10-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="https://i.imgur.com/UvPSTxH.png" alt=""></p>
<p>构建SpringMVC工程：</p>
<p>首先解决工程添加木块过慢的问题，在添加工程的时候，添加如下的属性：</p>
<p><img src="https://i.imgur.com/LpwgIqJ.png" alt=""></p>
<p>然后因为开始工程目录不全，要添加一些目录：</p>
<p><img src="https://i.imgur.com/Kxm31KN.png" alt=""></p>
<p>需要把HelloController的类交给容器来处理，然后在这个方法上再添加一个注解@ResquestMapping。请求映射注解，也就是一发请求，这个方法就执行了，映射到前台的请求。需要添加一个请求的路径。path=/“hello”。然后服务器一旦启动，点击超链接，让点击超链接跳转到success.jsp界面即可。</p>
<p><img src="https://i.imgur.com/XsBaIY8.png" alt=""></p>
<p>下图是springmvc.xml文件配置文件头的讲解：<br><img src="https://i.imgur.com/J7ZJ0jx.png" alt=""></p>
<p>首先配置里面的开启注解扫描。然后加了这个之后，我们还要让SpringMVC加载这个Springmvc.xml这个配置文件。那么这是怎么加载的那？我们在WEB-INF文件里面的web.xml文件里面也就是前端控制器里面去加载。</p>
<p>前端控制器代码如下：</p>
<pre><code>&lt;!DOCTYPE web-app PUBLIC
 &quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot;
 &quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot; &gt;

&lt;web-app&gt;
  &lt;display-name&gt;Archetype Created Web Application&lt;/display-name&gt;

  &lt;!--配置前端控制器--&gt;
  &lt;servlet&gt;
    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;
    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
      &lt;param-value&gt;classpath:springmvc.xml&lt;/param-value&gt;
    &lt;/init-param&gt;
    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
  &lt;/servlet&gt;

  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;

  &lt;!--配置解决中文乱码的过滤器--&gt;
  &lt;filter&gt;
    &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;encoding&lt;/param-name&gt;
      &lt;param-value&gt;UTF-8&lt;/param-value&gt;
    &lt;/init-param&gt;
  &lt;/filter&gt;
  &lt;filter-mapping&gt;
    &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;/filter-mapping&gt;

&lt;/web-app&gt;
</code></pre><p>解释一下上面的代码通过org.springframework.web.servlet.DispatcherServlet这个类里面配置classpath:springmvc.xml属性就可以帮我们加载该配置文件</p>
<hr>
<p>下面是简单的入门案例的图解：<br><img src="https://i.imgur.com/wLI6qKd.jpg" alt=""></p>
<hr>
<p>前端发来请求/hello然后通过前端控制器映射到处理器映射器，然后controller里面的任何方法都会通过处理器适配器，然后在执行相对应的方法。就到了第5步执行，返回的是一个ModelAndView也就是返回的是哪个success.jsp的适配器页面</p>
<p><img src="https://i.imgur.com/lrTXHqi.png" alt=""></p>
<p>但是发现为什么只是在springmvc.xml文件中配置了前端控制器呢，因为在配置了springmvc的注解开启之后就默认配置了另外的着一些适配器映射器之类的。<br><img src="https://i.imgur.com/YhOJMgE.png" alt=""></p>
<hr>
<p>@RequestMapping用来和前端的请求实现配合。映射过来的。建立映射关联的。可以放到方法上，也可以放到当前类上</p>
<p>RequestMapping的属性： value和Path属性都是一样的，如果只有一个属性，那么也可以不写这个path和value这个</p>
<p><img src="https://i.imgur.com/iVu94S8.png" alt=""></p>
<p>例如：</p>
<p><img src="https://i.imgur.com/fsbMFI1.png" alt=""></p>
<hr>
<hr>
<hr>
<p>Springmvc02的视频由于未保存。尚且不理他。等有时间在去更新。</p>
<hr>
<hr>
<hr>
<p>首先是讲一下RequestParam注解：<br>先来一段例子：</p>
<p>anno.jsp类：</p>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/3
  Time: 16:55
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;

&lt;a href=&quot;anno/testRequestParam?username=haha&quot;&gt;RequestParam&lt;/a&gt;
&lt;body&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>paramController类：</p>
<pre><code>package cn.itcast.controller;

import cn.itcast.domain.Account;
import cn.itcast.domain.User;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;

/**
 * @Description TODO
 * @Author TT Hun
 * @Data 2019/11/2 20:34
 */
@Controller
@RequestMapping(&quot;/param&quot;)
public class ParamController {

    @RequestMapping(&quot;/hello&quot;)
    public String testParam(String username, String password) {
        System.out.println(&quot;执行了。。。&quot;);
        System.out.println(&quot;用户名:&quot; + username);
        System.out.println(&quot;密码:&quot; + password);
        return &quot;success&quot;;
    }

    /**
     * 把返回的数据封装到一个javabean的类当中
     *
     * @return
     */
    @RequestMapping(&quot;/saveAccount&quot;)
    public String saveAccount(Account account) {
        System.out.println(&quot;执行了。。。&quot;);
        System.out.println(account);
        return &quot;success&quot;;
    }

    @RequestMapping(&quot;/saveUser&quot;)
    public String saveUser(User user){
        System.out.println(&quot;执行了。。。&quot;);
        System.out.println(user);
        return &quot;success&quot;;
    }
}
</code></pre><hr>
<p>一旦上面的username换成了name就不能识别了</p>
<p><img src="https://i.imgur.com/sScDjjc.png" alt=""><br>所以在Controller类的方法里加上这么一个参数，就可以将name对应的值传递给String username了<br><img src="https://i.imgur.com/3SAMmd9.png" alt=""></p>
<p>但是以后在jsp中就必须是name=”哈哈”。了，一旦更改成别的就不行了。</p>
<hr>
<h2 id="RequestBody注解"><a href="#RequestBody注解" class="headerlink" title="RequestBody注解"></a>RequestBody注解</h2><p><img src="https://i.imgur.com/i1JA9t9.png" alt=""><br>这个就不能写超链接，只能写表单通过post的方式提交</p>
<pre><code>package cn.itcast.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;

/**
 * @Description 常用的注解
 * @Author TT Hun
 * @Data 2019/11/3 16:59
 */
@Controller
@RequestMapping(&quot;/anno&quot;)
public class AnnoController {

    @RequestMapping(&quot;/testRequestParam&quot;)
    public String  testRequestParam(String username){
        System.out.println(&quot;执行了。。。&quot;);
        System.out.println(username);
        return &quot;success&quot;;
    }

    @RequestMapping(&quot;/testRequestBody&quot;)
    public String  testRequestBody(@RequestBody String body){
        System.out.println(&quot;执行了。。。&quot;);
        System.out.println(body);
        return &quot;success&quot;;
    }


}
</code></pre><hr>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/2
  Time: 20:26
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;%--自定义类型转换器--%&gt;
    &lt;form action=&quot;param/testRequestBody&quot; method=&quot;post&quot;&gt;
        用户姓名：&lt;input type=&quot;text&quot; name=&quot;username&quot; /&gt;&lt;br/&gt;
        用户年龄：&lt;input type=&quot;text&quot; name=&quot;age&quot; /&gt;&lt;br/&gt;
        用户生日：&lt;input type=&quot;text&quot; name=&quot;date&quot; /&gt;&lt;br/&gt;
        &lt;input type=&quot;submit&quot; value=&quot;提交&quot; /&gt;
    &lt;/form&gt;

&lt;/form&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<h2 id="PathVariable注解"><a href="#PathVariable注解" class="headerlink" title="PathVariable注解"></a>PathVariable注解</h2><p><img src="https://i.imgur.com/Wkn5y2a.png" alt=""></p>
<p>Restful风格编程：<br>原来在Controller里写很多方法，在path里面写具体的路径，也就是一个方法有一个请求路径，如果是restful风格可以三个方法请求路径都是同一个。可以给不同的方法给固定的请求方式，也就是说可以根据不同的请求方式来执行。那么问题来了，查询一般都是get请求。同一个方法findall和findbyId都有可能 执行怎么办呢，可以通过占位符path=”user/{id}”通过一个id的占位符来区别。</p>
<p><img src="https://i.imgur.com/oendiQU.png" alt=""></p>
<p>PathVariable也就是取到的占位符的值。</p>
<p>代码如下：</p>
<pre><code>package cn.itcast.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;

/**
 * @Description 常用的注解
 * @Author TT Hun
 * @Data 2019/11/3 16:59
 */
@Controller
@RequestMapping(&quot;/anno&quot;)
public class AnnoController {

    /**
     * PathVariable注解示例
     * @return
     */
    @RequestMapping(&quot;/testPathVariable/{sid}&quot;)
    public String  testPathVariable(@PathVariable(name=&quot;sid&quot;)String id ){
        System.out.println(&quot;执行了。。。&quot;);
        System.out.println(id);
        return &quot;success&quot;;
    }
}
</code></pre><hr>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/3
  Time: 16:55
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;

&lt;a href=&quot;/anno/testPathVariable/10&quot;&gt;testPathVariable&lt;/a&gt;

&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<h2 id="基于HiddenHttpMethodFliter的过滤器"><a href="#基于HiddenHttpMethodFliter的过滤器" class="headerlink" title="基于HiddenHttpMethodFliter的过滤器"></a>基于HiddenHttpMethodFliter的过滤器</h2><p><img src="https://i.imgur.com/oE9J2tq.png" alt=""></p>
<p>了解一下即可，因为webservie有API可以配置请求方式，并且浏览器中可以装插件来配置请求方式</p>
<hr>
<h2 id="RequestHeader注解"><a href="#RequestHeader注解" class="headerlink" title="RequestHeader注解"></a>RequestHeader注解</h2><p><img src="https://i.imgur.com/GMkzdbE.png" alt=""><br>一般用处不大</p>
<p>package cn.itcast.controller;</p>
<p>import org.springframework.stereotype.Controller;<br>import org.springframework.web.bind.annotation.*;</p>
<p>/**</p>
<ul>
<li>@Description 常用的注解</li>
<li>@Author TT Hun</li>
<li><p>@Data 2019/11/3 16:59<br>*/<br>@Controller<br>@RequestMapping(“/anno”)<br>public class AnnoController {</p>
<p> /**</p>
<ul>
<li>获取请求头信息的值</li>
<li>@param header</li>
<li>@return<br>*/<br>@RequestMapping(“/testRequestHeader”)<br>public String  testRequestHeader(@RequestHeader(value=”Accept”) String header){<br> System.out.println(“执行了。。。”);<br> System.out.println(header);<br> return “success”;<br>}<br>}</li>
</ul>
</li>
</ul>
<hr>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/3
  Time: 16:55
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;

&lt;a href=&quot;/anno/testRequestHeader&quot;&gt;testRequestHeader&lt;/a&gt;


&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<h2 id="Cookie-Value注解"><a href="#Cookie-Value注解" class="headerlink" title="Cookie Value注解"></a>Cookie Value注解</h2><p><img src="https://i.imgur.com/l98bt3M.png" alt=""></p>
<p>package cn.itcast.controller;</p>
<p>import org.springframework.stereotype.Controller;<br>import org.springframework.web.bind.annotation.*;</p>
<p>/**</p>
<ul>
<li>@Description 常用的注解</li>
<li>@Author TT Hun</li>
<li><p>@Data 2019/11/3 16:59<br>*/<br>@Controller<br>@RequestMapping(“/anno”)<br>public class AnnoController {</p>
<p> /**</p>
<ul>
<li>测试CookieValue注解</li>
<li>@param cookieValue</li>
<li>@return<br>*/<br>@RequestMapping(“/testCookieValue”)<br>public String  testCookieValue(@CookieValue(value=”JSESSIONID”) String cookieValue){<br> System.out.println(“执行了。。。”);<br> System.out.println(cookieValue);<br> return “success”;<br>}</li>
</ul>
</li>
</ul>
<p>}</p>
<hr>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/3
  Time: 16:55
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;

&lt;a href=&quot;/anno/testCookieValue&quot;&gt;testCookieValue&lt;/a&gt;

&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<h2 id="ModelAttribute注解"><a href="#ModelAttribute注解" class="headerlink" title="ModelAttribute注解"></a>ModelAttribute注解</h2><p><img src="https://i.imgur.com/j1zGJPI.png" alt=""></p>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/3
  Time: 16:55
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;

&lt;form action=&quot;anno/testModelAttribute&quot; method=&quot;post&quot;&gt;
    用户姓名：&lt;input type=&quot;text&quot; name=&quot;username&quot; /&gt;&lt;br/&gt;
    用户年龄：&lt;input type=&quot;text&quot; name=&quot;age&quot; /&gt;&lt;br/&gt;
    &lt;input type=&quot;submit&quot; value=&quot;提交&quot; /&gt;
&lt;/form&gt;
&lt;br&gt;

&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<pre><code>package cn.itcast.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.*;

/**
 * @Description 常用的注解
 * @Author TT Hun
 * @Data 2019/11/3 16:59
 */
@Controller
@RequestMapping(&quot;/anno&quot;)
public class AnnoController {

    /**
     * testModelAttribute测试
     * @return
     */
    @RequestMapping(&quot;/testModelAttribute&quot;)
    public String  testModelAttribute(){
        System.out.println(&quot;testModelAttribute执行了。。。&quot;);
        return &quot;success&quot;;
    }

    @ModelAttribute
    public void showUser(){
        System.out.println(&quot;showUser方法执行了...&quot;);
    }
}
</code></pre><hr>
<p>然后打印结果：<br><img src="https://i.imgur.com/UZn18Sr.png" alt=""></p>
<p>当提交的缺少一个数据，但是想让这个数据从数据库中查询或者缓存中查询。下面是有返回值的情况：</p>
<pre><code>package cn.itcast.controller;

import cn.itcast.domain.User;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.*;

import java.util.Date;

/**
 * @Description 常用的注解
 * @Author TT Hun
 * @Data 2019/11/3 16:59
 */
@Controller
@RequestMapping(&quot;/anno&quot;)
public class AnnoController {

    /**
     * testModelAttribute测试
     * @return
     */
    @RequestMapping(&quot;/testModelAttribute&quot;)
    public String  testModelAttribute(User user){
        System.out.println(&quot;testModelAttribute执行了。。。&quot;);
        System.out.println(user);
        return &quot;success&quot;;
    }


    /**
     * 测试ModelAttribute注解的有返回值的情况，
     */
    @ModelAttribute
    public User showUser(String uname ,Integer age){
        System.out.println(&quot;showUser方法执行了...&quot;);
//        通过用户名查询数据库（模拟）
        User user = new User();
        user.setUname(uname);
        user.setAge(age);
        user.setDate(new Date());
        return user;
    }
}
</code></pre><hr>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/3
  Time: 16:55
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;

&lt;form action=&quot;anno/testModelAttribute&quot; method=&quot;post&quot;&gt;
    用户姓名：&lt;input type=&quot;text&quot; name=&quot;uname&quot; /&gt;&lt;br/&gt;
    用户年龄：&lt;input type=&quot;text&quot; name=&quot;age&quot; /&gt;&lt;br/&gt;
    &lt;input type=&quot;submit&quot; value=&quot;提交&quot; /&gt;
&lt;/form&gt;
&lt;br&gt;


&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<p>打印结果：<br><img src="https://i.imgur.com/Mrcg4Ui.png" alt=""></p>
<hr>
<p>下面是没有返回值的写法，可以写入一个Map集合<br>    package cn.itcast.controller;</p>
<pre><code>import cn.itcast.domain.User;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.*;

import java.util.Date;
import java.util.Map;

/**
 * @Description 常用的注解
 * @Author TT Hun
 * @Data 2019/11/3 16:59
 */
@Controller
@RequestMapping(&quot;/anno&quot;)
public class AnnoController {
</code></pre><p>   /**</p>
<pre><code> * 测试CookieValue注解
 * @param cookieValue
 * @return
 */
@RequestMapping(&quot;/testCookieValue&quot;)
public String  testCookieValue(@CookieValue(value=&quot;JSESSIONID&quot;) String cookieValue){
    System.out.println(&quot;执行了。。。&quot;);
    System.out.println(cookieValue);
    return &quot;success&quot;;
}

    /**
     * 测试没有返回值的ModelAttribute注解
     */
    @ModelAttribute
    public void showUser(String uname , Integer age, Map&lt;String,User&gt; map){
        System.out.println(&quot;showUser方法执行了...&quot;);
//      通过用户名查询数据库（模拟）
        User user = new User();
        user.setUname(uname);
        user.setAge(age);
        user.setDate(new Date());
//      查完数据之后存入一个Map集合当中
        map.put(&quot;abc&quot;,user);
    }
}
</code></pre><hr>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/3
  Time: 16:55
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;form action=&quot;anno/testModelAttribute&quot; method=&quot;post&quot;&gt;
    用户姓名：&lt;input type=&quot;text&quot; name=&quot;uname&quot; /&gt;&lt;br/&gt;
    用户年龄：&lt;input type=&quot;text&quot; name=&quot;age&quot; /&gt;&lt;br/&gt;
    &lt;input type=&quot;submit&quot; value=&quot;提交&quot; /&gt;
&lt;/form&gt;
&lt;br&gt;

&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<h2 id="SessionAttribute注解-这个是重点看"><a href="#SessionAttribute注解-这个是重点看" class="headerlink" title="SessionAttribute注解 这个是重点看"></a>SessionAttribute注解 这个是重点看</h2><p><img src="https://i.imgur.com/xt5GfpQ.png" alt=""></p>
<p>用于在request域里面添加内容，存储到域当中去，并且可以在以后jsp的界面中显示出来。</p>
<pre><code>package cn.itcast.controller;

import cn.itcast.domain.User;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.*;

import javax.servlet.http.HttpServletRequest;
import java.util.Date;
import java.util.Map;

/**
 * @Description 常用的注解
 * @Author TT Hun
 * @Data 2019/11/3 16:59
 */
@Controller
@RequestMapping(&quot;/anno&quot;)
public class AnnoController {

    /**
     * SessionAttributes的注解
     * @return
     */
    @RequestMapping(&quot;/testSessionAttributes&quot;)
    public String testSessionAttributes(Model model){
        System.out.println(&quot;testSessionAttributes方法执行了...&quot;);
//       向requestSession域里面存值，然后在success.jsp里面取出来,底层会存储到request域对象当中去
        model.addAttribute(&quot;msg&quot;,&quot;美美&quot;);
        return &quot;success&quot;;
    }
}
</code></pre><hr>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/3
  Time: 16:55
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;

&lt;a href=&quot;/anno/testSessionAttributes&quot;&gt;testSessionAttributes&lt;/a&gt;
&lt;br&gt;

&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/10/24
  Time: 22:35
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; isELIgnored=&quot;false&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
        &lt;h3&gt;入门成功了&lt;/h3&gt;
&lt;%--        表示request域的集合--%&gt;
    ${ requestScope }
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<p>SessionAttributes这个注解智能作用在类上，相当于存到Session这个域当中去，<br>然后使用model.addAttribute相当于把这个信息存储到requestSession这个域当中去。<br>在这个里面添加这个这个</p>
<p><img src="https://i.imgur.com/31aZ2iR.png" alt=""><br>然后<br><img src="https://i.imgur.com/ft78run.png" alt=""><br>就会显示：<br><img src="https://i.imgur.com/Jr4T50X.png" alt=""></p>
<hr>
<p>操作Session的内容进行增加删除查看</p>
<pre><code>package cn.itcast.controller;

import cn.itcast.domain.User;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.ui.ModelMap;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.bind.support.SessionStatus;

import javax.servlet.http.HttpServletRequest;
import java.util.Date;
import java.util.Map;

/**
 * @Description 常用的注解
 * @Author TT Hun
 * @Data 2019/11/3 16:59
 */
@Controller
@RequestMapping(&quot;/anno&quot;)
@SessionAttributes(value={&quot;msg&quot;})//把msg=“美美&quot;在存入到Session域里面一份
public class AnnoController {
    /**
     * 从Session域里面添加值
     * @return
     */
    @RequestMapping(&quot;/testSessionAttributes&quot;)
    public String testSessionAttributes(Model model){
        System.out.println(&quot;testSessionAttributes方法执行了...&quot;);
//       向requestSession域里面存值，然后在success.jsp里面取出来,底层会存储到request域对象当中去
        model.addAttribute(&quot;msg&quot;,&quot;美美&quot;);
        return &quot;success&quot;;
    }

    /**
     * 从Session域里面取值
     * @return
     */
    @RequestMapping(&quot;/getSessionAttributes&quot;)
    public String getSessionAttributes(ModelMap modelMap){
        System.out.println(&quot;testSessionAttributes方法执行了...&quot;);
//        从Session域里面取值。
        String msg = (String)modelMap.get(&quot;msg&quot;);
        System.out.println(msg);
        return &quot;success&quot;;
    }

    /**
     * 从Session域里面删除值
     * @return
     */
    @RequestMapping(&quot;/deleteSessionAttributes&quot;)
    public String deleteSessionAttributes(SessionStatus status){
        System.out.println(&quot;testSessionAttributes方法执行了...&quot;);
//       把Session里面的东西清除掉。
        status.setComplete();
        return &quot;success&quot;;
    }
}
</code></pre><hr>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/11/3
  Time: 16:55
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;

&lt;a href=&quot;/anno/testSessionAttributes&quot;&gt;testSessionAttributes&lt;/a&gt;
&lt;br&gt;
&lt;a href=&quot;/anno/getSessionAttributes&quot;&gt;getSessionAttributes&lt;/a&gt;
&lt;br&gt;
&lt;a href=&quot;/anno/deleteSessionAttributes&quot;&gt;deleteSessionAttributes&lt;/a&gt;
&lt;br&gt;

&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<pre><code>&lt;%--
  Created by IntelliJ IDEA.
  User: Hun
  Date: 2019/10/24
  Time: 22:35
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; isELIgnored=&quot;false&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
        &lt;h3&gt;入门成功了&lt;/h3&gt;
&lt;%--        表示request域的集合--%&gt;
    ${ requestScope.msg }
    ${sessionScope}
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2019/10/24/Spring第四天-基于纯注解事务控制-回顾部分注解例子/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/24/Spring第四天-基于纯注解事务控制-回顾部分注解例子/" itemprop="url">Spring第四天_基于纯注解事务控制+回顾部分注解例子</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-24T20:34:48+08:00">
                2019-10-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <pre><code>package com.itheima.dao;

import com.itheima.domain.Account;

/**
 * 账户的持久层接口
 */
public interface IAccountDao {

    /**
     * 根据Id查询账户
     * @param accountId
     * @return
     */
    Account findAccountById(Integer accountId);

    /**
     * 根据名称查询账户
     * @param accountName
     * @return
     */
    Account findAccountByName(String accountName);

    /**
     * 更新账户
     * @param account
     */
    void updateAccount(Account account);
}
</code></pre><hr>
<pre><code>package com.itheima.dao.impl;

import com.itheima.dao.IAccountDao;
import com.itheima.domain.Account;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.BeanPropertyRowMapper;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Repository;

import java.util.List;

/**
 * 账户的持久层实现类
 */
@Repository(&quot;accountDao&quot;)
public class AccountDaoImpl implements IAccountDao {

    @Autowired
    private JdbcTemplate jdbcTemplate;

    @Override
    public Account findAccountById(Integer accountId) {
        List&lt;Account&gt; accounts = jdbcTemplate.query(&quot;select * from account where id = ?&quot;,new BeanPropertyRowMapper&lt;Account&gt;(Account.class),accountId);
        return accounts.isEmpty()?null:accounts.get(0);
    }

    @Override
    public Account findAccountByName(String accountName) {
        List&lt;Account&gt; accounts = jdbcTemplate.query(&quot;select * from account where name = ?&quot;,new BeanPropertyRowMapper&lt;Account&gt;(Account.class),accountName);
        if(accounts.isEmpty()){
            return null;
        }
        if(accounts.size()&gt;1){
            throw new RuntimeException(&quot;结果集不唯一&quot;);
        }
        return accounts.get(0);
    }

    @Override
    public void updateAccount(Account account) {
        jdbcTemplate.update(&quot;update account set name=?,money=? where id=?&quot;,account.getName(),account.getMoney(),account.getId());
    }
}
</code></pre><hr>
<pre><code>package com.itheima.domain;

import java.io.Serializable;

/**
 * 账户的实体类
 */
public class Account implements Serializable {

    private Integer id;
    private String name;
    private Float money;

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Float getMoney() {
        return money;
    }

    public void setMoney(Float money) {
        this.money = money;
    }

    @Override
    public String toString() {
        return &quot;Account{&quot; +
                &quot;id=&quot; + id +
                &quot;, name=&apos;&quot; + name + &apos;\&apos;&apos; +
                &quot;, money=&quot; + money +
                &apos;}&apos;;
    }
}
</code></pre><hr>
<pre><code>package com.itheima.service;

import com.itheima.domain.Account;

/**
 * 账户的业务层接口
 */
public interface IAccountService {
    /**
     * 根据id查询账户信息
     * @param accountId
     * @return
     */
    Account findAccountById(Integer accountId);

    /**
     * 转账
     * @param sourceName    转成账户名称
     * @param targetName    转入账户名称
     * @param money         转账金额
     */
    void transfer(String sourceName, String targetName, Float money);
}
</code></pre><hr>
<pre><code>package com.itheima.service.impl;

import com.itheima.dao.IAccountDao;
import com.itheima.domain.Account;
import com.itheima.service.IAccountService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Propagation;
import org.springframework.transaction.annotation.Transactional;

/**
 * 账户的业务层实现类
 *
 * 事务控制应该都是在业务层
 */
@Service(&quot;accountService&quot;)
@Transactional(propagation= Propagation.SUPPORTS,readOnly=true)//只读型事务的配置
public class AccountServiceImpl implements IAccountService{

    @Autowired
    private IAccountDao accountDao;


    @Override
    public Account findAccountById(Integer accountId) {
        return accountDao.findAccountById(accountId);

    }


    //需要的是读写型事务配置
    @Transactional(propagation= Propagation.REQUIRED,readOnly=false)
    @Override
    public void transfer(String sourceName, String targetName, Float money) {
        System.out.println(&quot;transfer....&quot;);
            //2.1根据名称查询转出账户
            Account source = accountDao.findAccountByName(sourceName);
            //2.2根据名称查询转入账户
            Account target = accountDao.findAccountByName(targetName);
            //2.3转出账户减钱
            source.setMoney(source.getMoney()-money);
            //2.4转入账户加钱
            target.setMoney(target.getMoney()+money);
            //2.5更新转出账户
            accountDao.updateAccount(source);

//            int i=1/0;

            //2.6更新转入账户
            accountDao.updateAccount(target);
    }
}
</code></pre><hr>
<p>重点看下面Config文件夹下面几个类：</p>
<pre><code>package config;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.datasource.DriverManagerDataSource;

import javax.sql.DataSource;

/**
 * 和连接数据库相关的配置类
 */
public class JdbcConfig {

    @Value(&quot;${jdbc.driver}&quot;)
    private String driver;

    @Value(&quot;${jdbc.url}&quot;)
    private String url;

    @Value(&quot;${jdbc.username}&quot;)
    private String username;

    @Value(&quot;${jdbc.password}&quot;)
    private String password;

    /**
     * 创建JdbcTemplate
     * @param dataSource
     * @return
     */
    @Bean(name=&quot;jdbcTemplate&quot;)
    public JdbcTemplate createJdbcTemplate(DataSource dataSource){
        return new JdbcTemplate(dataSource);
    }

    /**
     * 创建数据源对象
     * @return
     */
    @Bean(name=&quot;dataSource&quot;)
    public DataSource createDataSource(){
        DriverManagerDataSource ds = new DriverManagerDataSource();
        ds.setDriverClassName(driver);
        ds.setUrl(url);
        ds.setUsername(username);
        ds.setPassword(password);
        return ds;
    }
}
</code></pre><hr>
<pre><code>package config;

import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import org.springframework.context.annotation.PropertySource;
import org.springframework.transaction.annotation.EnableTransactionManagement;

/**
 * spring的配置类，相当于bean.xml
 */
@Configuration
@ComponentScan(&quot;com.itheima&quot;)
@Import({JdbcConfig.class,TransactionConfig.class})
@PropertySource(&quot;jdbcConfig.properties&quot;)
@EnableTransactionManagement
public class SpringConfiguration {
}
</code></pre><hr>
<pre><code>package config;

import org.springframework.context.annotation.Bean;
import org.springframework.jdbc.datasource.DataSourceTransactionManager;
import org.springframework.transaction.PlatformTransactionManager;

import javax.sql.DataSource;

/**
 * 和事务相关的配置类
 */
public class TransactionConfig {

    /**
     * 用于创建事务管理器对象
     * @param dataSource
     * @return
     */
    @Bean(name=&quot;transactionManager&quot;)
    public PlatformTransactionManager createTransactionManager(DataSource dataSource){
        return new DataSourceTransactionManager(dataSource);
    }
}
</code></pre><hr>
<p>resource包下properties文件：</p>
<pre><code>jdbc.driver=com.mysql.jdbc.Driver
jdbc.url=jdbc:mysql://localhost:3306/eesy
jdbc.username=root
jdbc.password=1234
</code></pre><hr>
<pre><code>package com.itheima.test;

import com.itheima.service.IAccountService;
import config.SpringConfiguration;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

/**
 * 使用Junit单元测试：测试我们的配置
 */
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(classes= SpringConfiguration.class)
public class AccountServiceTest {

    @Autowired
    private  IAccountService as;

    @Test
    public  void testTransfer(){
        as.transfer(&quot;aaa&quot;,&quot;bbb&quot;,100f);

    }

}
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2019/10/23/Spring第四天-关于事务的控制通过XML和纯注解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/23/Spring第四天-关于事务的控制通过XML和纯注解/" itemprop="url">Spring第四天_关于事务的控制通过XML和纯注解</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-23T16:01:28+08:00">
                2019-10-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spring/" itemprop="url" rel="index">
                    <span itemprop="name">Spring</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h2 id="Spring控制的一组关于事务的"><a href="#Spring控制的一组关于事务的" class="headerlink" title="Spring控制的一组关于事务的"></a><strong>Spring控制的一组关于事务的</strong></h2><p><img src="https://i.imgur.com/wbPn7UK.png" alt=""></p>
<p><img src="https://i.imgur.com/tuVVVR8.png" alt=""></p>
<p><img src="https://i.imgur.com/r7PWC1h.png" alt=""></p>
<p><img src="https://i.imgur.com/2pWccm5.png" alt=""></p>
<p><img src="https://i.imgur.com/LatSmwW.png" alt=""></p>
<p><img src="https://i.imgur.com/QgRHylQ.png" alt=""><br><img src="https://i.imgur.com/LzhM2Vn.png" alt=""></p>
<h2 id="Spring基于XML的声明式事务控制（）"><a href="#Spring基于XML的声明式事务控制（）" class="headerlink" title="Spring基于XML的声明式事务控制（）"></a>Spring基于XML的声明式事务控制（）</h2><p>前面的处理还是按照以前银行例子的配置，这个地方重点看bean配置文件的配置。</p>
<pre><code>package com.itheima.dao;

import com.itheima.domain.Account;

/**
 * 账户的持久层接口
 */
public interface IAccountDao {

    /**
     * 根据Id查询账户
     * @param accountId
     * @return
     */
    Account findAccountById(Integer accountId);

    /**
     * 根据名称查询账户
     * @param accountName
     * @return
     */
    Account findAccountByName(String accountName);

    /**
     * 更新账户
     * @param account
     */
    void updateAccount(Account account);
}
</code></pre><hr>
<pre><code>package com.itheima.dao.impl;

import com.itheima.dao.IAccountDao;
import com.itheima.domain.Account;
import org.springframework.jdbc.core.BeanPropertyRowMapper;
import org.springframework.jdbc.core.support.JdbcDaoSupport;

import java.util.List;

/**
 * 账户的持久层实现类
 */
public class AccountDaoImpl extends JdbcDaoSupport implements IAccountDao {

    @Override
    public Account findAccountById(Integer accountId) {
        List&lt;Account&gt; accounts = super.getJdbcTemplate().query(&quot;select * from account where id = ?&quot;,new BeanPropertyRowMapper&lt;Account&gt;(Account.class),accountId);
        return accounts.isEmpty()?null:accounts.get(0);
    }

    @Override
    public Account findAccountByName(String accountName) {
        List&lt;Account&gt; accounts = super.getJdbcTemplate().query(&quot;select * from account where name = ?&quot;,new BeanPropertyRowMapper&lt;Account&gt;(Account.class),accountName);
        if(accounts.isEmpty()){
            return null;
        }
        if(accounts.size()&gt;1){
            throw new RuntimeException(&quot;结果集不唯一&quot;);
        }
        return accounts.get(0);
    }

    @Override
    public void updateAccount(Account account) {
        super.getJdbcTemplate().update(&quot;update account set name=?,money=? where id=?&quot;,account.getName(),account.getMoney(),account.getId());
    }
}
</code></pre><hr>
<pre><code>package com.itheima.domain;

import java.io.Serializable;

/**
 * 账户的实体类
 */
public class Account implements Serializable {

    private Integer id;
    private String name;
    private Float money;

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Float getMoney() {
        return money;
    }

    public void setMoney(Float money) {
        this.money = money;
    }

    @Override
    public String toString() {
        return &quot;Account{&quot; +
                &quot;id=&quot; + id +
                &quot;, name=&apos;&quot; + name + &apos;\&apos;&apos; +
                &quot;, money=&quot; + money +
                &apos;}&apos;;
    }
}
</code></pre><hr>
<pre><code>package com.itheima.service;

import com.itheima.domain.Account;

/**
 * 账户的业务层接口
 */
public interface IAccountService {
    /**
     * 根据id查询账户信息
     * @param accountId
     * @return
     */
    Account findAccountById(Integer accountId);

    /**
     * 转账
     * @param sourceName    转成账户名称
     * @param targetName    转入账户名称
     * @param money         转账金额
     */
    void transfer(String sourceName, String targetName, Float money);
}
</code></pre><hr>
<pre><code>package com.itheima.service.impl;

import com.itheima.dao.IAccountDao;
import com.itheima.domain.Account;
import com.itheima.service.IAccountService;

/**
 * 账户的业务层实现类
 *
 * 事务控制应该都是在业务层
 */
public class AccountServiceImpl implements IAccountService{

    private IAccountDao accountDao;

    public void setAccountDao(IAccountDao accountDao) {
        this.accountDao = accountDao;
    }

    @Override
    public Account findAccountById(Integer accountId) {
        return accountDao.findAccountById(accountId);

    }



    @Override
    public void transfer(String sourceName, String targetName, Float money) {
        System.out.println(&quot;transfer....&quot;);
            //2.1根据名称查询转出账户
            Account source = accountDao.findAccountByName(sourceName);
            //2.2根据名称查询转入账户
            Account target = accountDao.findAccountByName(targetName);
            //2.3转出账户减钱
            source.setMoney(source.getMoney()-money);
            //2.4转入账户加钱
            target.setMoney(target.getMoney()+money);
            //2.5更新转出账户
            accountDao.updateAccount(source);

            int i=1/0;

            //2.6更新转入账户
            accountDao.updateAccount(target);
    }
}
</code></pre><hr>
<h3 id="下面重点看："><a href="#下面重点看：" class="headerlink" title="下面重点看："></a>下面重点看：</h3><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;
       xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;
       xsi:schemaLocation=&quot;
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/tx
        http://www.springframework.org/schema/tx/spring-tx.xsd
        http://www.springframework.org/schema/aop
        http://www.springframework.org/schema/aop/spring-aop.xsd&quot;&gt;

    &lt;!-- 配置业务层--&gt;
    &lt;bean id=&quot;accountService&quot; class=&quot;com.itheima.service.impl.AccountServiceImpl&quot;&gt;
        &lt;property name=&quot;accountDao&quot; ref=&quot;accountDao&quot;&gt;&lt;/property&gt;
    &lt;/bean&gt;

    &lt;!-- 配置账户的持久层--&gt;
    &lt;bean id=&quot;accountDao&quot; class=&quot;com.itheima.dao.impl.AccountDaoImpl&quot;&gt;
        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;&gt;&lt;/property&gt;
    &lt;/bean&gt;


    &lt;!-- 配置数据源--&gt;
    &lt;bean id=&quot;dataSource&quot; class=&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;&gt;
        &lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.jdbc.Driver&quot;&gt;&lt;/property&gt;
        &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/eesy&quot;&gt;&lt;/property&gt;
        &lt;property name=&quot;username&quot; value=&quot;root&quot;&gt;&lt;/property&gt;
        &lt;property name=&quot;password&quot; value=&quot;1234&quot;&gt;&lt;/property&gt;
    &lt;/bean&gt;

    &lt;!-- spring中基于XML的声明式事务控制配置步骤
        1、配置事务管理器
        2、配置事务的通知
                此时我们需要导入事务的约束 tx名称空间和约束，同时也需要aop的
                使用tx:advice标签配置事务通知
                    属性：
                        id：给事务通知起一个唯一标识
                        transaction-manager：给事务通知提供一个事务管理器引用
        3、配置AOP中的通用切入点表达式
        4、建立事务通知和切入点表达式的对应关系
        5、配置事务的属性
               是在事务的通知tx:advice标签的内部

     --&gt;
    &lt;!-- 配置事务管理器 --&gt;
    &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;
        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;&gt;&lt;/property&gt;
    &lt;/bean&gt;

    &lt;!-- 配置事务的通知--&gt;
    &lt;tx:advice id=&quot;txAdvice&quot; transaction-manager=&quot;transactionManager&quot;&gt;
        &lt;!-- 配置事务的属性
                isolation：用于指定事务的隔离级别。默认值是DEFAULT，表示使用数据库的默认隔离级别。
                propagation：用于指定事务的传播行为。默认值是REQUIRED，表示一定会有事务，增删改的选择。查询方法可以选择SUPPORTS。
                read-only：用于指定事务是否只读。只有查询方法才能设置为true。默认值是false，表示读写。
                timeout：用于指定事务的超时时间，默认值是-1，表示永不超时。如果指定了数值，以秒为单位。
                rollback-for：用于指定一个异常，当产生该异常时，事务回滚，产生其他异常时，事务不回滚。没有默认值。表示任何异常都回滚。
                no-rollback-for：用于指定一个异常，当产生该异常时，事务不回滚，产生其他异常时事务回滚。没有默认值。表示任何异常都回滚。
        --&gt;
        &lt;tx:attributes&gt;
            &lt;tx:method name=&quot;*&quot; propagation=&quot;REQUIRED&quot; read-only=&quot;false&quot;/&gt;
            &lt;tx:method name=&quot;find*&quot; propagation=&quot;SUPPORTS&quot; read-only=&quot;true&quot;&gt;&lt;/tx:method&gt;
        &lt;/tx:attributes&gt;
    &lt;/tx:advice&gt;

    &lt;!-- 配置aop--&gt;
    &lt;aop:config&gt;
        &lt;!-- 配置切入点表达式--&gt;
        &lt;aop:pointcut id=&quot;pt1&quot; expression=&quot;execution(* com.itheima.service.impl.*.*(..))&quot;&gt;&lt;/aop:pointcut&gt;
        &lt;!--建立切入点表达式和事务通知的对应关系 --&gt;
        &lt;aop:advisor advice-ref=&quot;txAdvice&quot; pointcut-ref=&quot;pt1&quot;&gt;&lt;/aop:advisor&gt;
    &lt;/aop:config&gt;
&lt;/beans&gt;
</code></pre><hr>
<pre><code>package com.itheima.test;

import com.itheima.service.IAccountService;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

/**
 * 使用Junit单元测试：测试我们的配置
 */
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = &quot;classpath:bean.xml&quot;)
public class AccountServiceTest {

    @Autowired
    private  IAccountService as;

    @Test
    public  void testTransfer(){
        as.transfer(&quot;aaa&quot;,&quot;bbb&quot;,100f);

    }
}
</code></pre><hr>
<p>这个地方重点看的配置就是bean里面的配置：</p>
<hr>
<p>两种DAO的编写方式：（回顾一下DAO的实现方式）<br><img src="https://i.imgur.com/MZUtq3f.png" alt=""></p>
<p><img src="https://i.imgur.com/aFDLkTS.png" alt=""></p>
<hr>
<pre><code>package com.itheima.dao;

import com.itheima.domain.Account;

/**
 * 账户的持久层接口
 */
public interface IAccountDao {

    /**
     * 根据Id查询账户
     * @param accountId
     * @return
     */
    Account findAccountById(Integer accountId);

    /**
     * 根据名称查询账户
     * @param accountName
     * @return
     */
    Account findAccountByName(String accountName);

    /**
     * 更新账户
     * @param account
     */
    void updateAccount(Account account);
}
</code></pre><hr>
<pre><code>package com.itheima.dao.impl;

import com.itheima.dao.IAccountDao;
import com.itheima.domain.Account;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.BeanPropertyRowMapper;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Repository;

import java.util.List;

/**
 * 账户的持久层实现类
 */
@Repository(&quot;accountDao&quot;)
public class AccountDaoImpl implements IAccountDao {

    @Autowired
    private JdbcTemplate jdbcTemplate;

    @Override
    public Account findAccountById(Integer accountId) {
        List&lt;Account&gt; accounts = jdbcTemplate.query(&quot;select * from account where id = ?&quot;,new BeanPropertyRowMapper&lt;Account&gt;(Account.class),accountId);
        return accounts.isEmpty()?null:accounts.get(0);
    }

    @Override
    public Account findAccountByName(String accountName) {
        List&lt;Account&gt; accounts = jdbcTemplate.query(&quot;select * from account where name = ?&quot;,new BeanPropertyRowMapper&lt;Account&gt;(Account.class),accountName);
        if(accounts.isEmpty()){
            return null;
        }
        if(accounts.size()&gt;1){
            throw new RuntimeException(&quot;结果集不唯一&quot;);
        }
        return accounts.get(0);
    }

    @Override
    public void updateAccount(Account account) {
        jdbcTemplate.update(&quot;update account set name=?,money=? where id=?&quot;,account.getName(),account.getMoney(),account.getId());
    }
}
</code></pre><hr>
<pre><code>package com.itheima.domain;

import java.io.Serializable;

/**
 * 账户的实体类
 */
public class Account implements Serializable {

    private Integer id;
    private String name;
    private Float money;

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Float getMoney() {
        return money;
    }

    public void setMoney(Float money) {
        this.money = money;
    }

    @Override
    public String toString() {
        return &quot;Account{&quot; +
                &quot;id=&quot; + id +
                &quot;, name=&apos;&quot; + name + &apos;\&apos;&apos; +
                &quot;, money=&quot; + money +
                &apos;}&apos;;
    }
}
</code></pre><hr>
<pre><code>package com.itheima.service;

import com.itheima.domain.Account;

/**
 * 账户的业务层接口
 */
public interface IAccountService {
    /**
     * 根据id查询账户信息
     * @param accountId
     * @return
     */
    Account findAccountById(Integer accountId);

    /**
     * 转账
     * @param sourceName    转成账户名称
     * @param targetName    转入账户名称
     * @param money         转账金额
     */
    void transfer(String sourceName, String targetName, Float money);
}
</code></pre><hr>
<pre><code>package com.itheima.service.impl;

import com.itheima.dao.IAccountDao;
import com.itheima.domain.Account;
import com.itheima.service.IAccountService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Propagation;
import org.springframework.transaction.annotation.Transactional;

/**
 * 账户的业务层实现类
 *
 * 事务控制应该都是在业务层
 */
@Service(&quot;accountService&quot;)
@Transactional(propagation= Propagation.SUPPORTS,readOnly=true)//只读型事务的配置
public class AccountServiceImpl implements IAccountService{

    @Autowired
    private IAccountDao accountDao;


    @Override
    public Account findAccountById(Integer accountId) {
        return accountDao.findAccountById(accountId);

    }


    //需要的是读写型事务配置
    @Transactional(propagation= Propagation.REQUIRED,readOnly=false)
    @Override
    public void transfer(String sourceName, String targetName, Float money) {
        System.out.println(&quot;transfer....&quot;);
            //2.1根据名称查询转出账户
            Account source = accountDao.findAccountByName(sourceName);
            //2.2根据名称查询转入账户
            Account target = accountDao.findAccountByName(targetName);
            //2.3转出账户减钱
            source.setMoney(source.getMoney()-money);
            //2.4转入账户加钱
            target.setMoney(target.getMoney()+money);
            //2.5更新转出账户
            accountDao.updateAccount(source);

            int i=1/0;

            //2.6更新转入账户
            accountDao.updateAccount(target);
    }
}
</code></pre><hr>
<p>重点的bean配置文件：</p>
<hr>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;
       xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;
       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xsi:schemaLocation=&quot;
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/tx
        http://www.springframework.org/schema/tx/spring-tx.xsd
        http://www.springframework.org/schema/aop
        http://www.springframework.org/schema/aop/spring-aop.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;

    &lt;!-- 配置spring创建容器时要扫描的包--&gt;
    &lt;context:component-scan base-package=&quot;com.itheima&quot;&gt;&lt;/context:component-scan&gt;

    &lt;!-- 配置JdbcTemplate--&gt;
    &lt;bean id=&quot;jdbcTemplate&quot; class=&quot;org.springframework.jdbc.core.JdbcTemplate&quot;&gt;
        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;&gt;&lt;/property&gt;
    &lt;/bean&gt;



    &lt;!-- 配置数据源--&gt;
    &lt;bean id=&quot;dataSource&quot; class=&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;&gt;
        &lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.jdbc.Driver&quot;&gt;&lt;/property&gt;
        &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/eesy&quot;&gt;&lt;/property&gt;
        &lt;property name=&quot;username&quot; value=&quot;root&quot;&gt;&lt;/property&gt;
        &lt;property name=&quot;password&quot; value=&quot;1234&quot;&gt;&lt;/property&gt;
    &lt;/bean&gt;

    &lt;!-- spring中基于注解 的声明式事务控制配置步骤
        1、配置事务管理器
        2、开启spring对注解事务的支持
        3、在需要事务支持的地方使用@Transactional注解
     --&gt;
    &lt;!-- 配置事务管理器 --&gt;
    &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;
        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;&gt;&lt;/property&gt;
    &lt;/bean&gt;

    &lt;!-- 开启spring对注解事务的支持--&gt;
    &lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot;&gt;&lt;/tx:annotation-driven&gt;
&lt;/beans&gt;
</code></pre><hr>
<pre><code>package com.itheima.test;

import com.itheima.service.IAccountService;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

/**
 * 使用Junit单元测试：测试我们的配置
 */
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = &quot;classpath:bean.xml&quot;)
public class AccountServiceTest {

    @Autowired
    private  IAccountService as;

    @Test
    public  void testTransfer(){
        as.transfer(&quot;aaa&quot;,&quot;bbb&quot;,100f);

    }

}
</code></pre><hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://erichunn.github.io/2019/10/08/Spring第四天_Spring中事务控制-作业例子/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eric Hunn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无心是一首歌">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/08/Spring第四天_Spring中事务控制-作业例子/" itemprop="url">Spring第四天_Spring中事务控制-作业例子</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-08T22:53:37+08:00">
                2019-10-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spring/" itemprop="url" rel="index">
                    <span itemprop="name">Spring</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p><strong>这节主要讲解了从银行转账的一个基于XML配置文件的，一个是基于注解配置的两个案例。2个都是比较完整的代码，没有测试过，可能因为数据库8.0问题导致连接不上，但是代码应该没有问题。可以作为例子深入研究一下注解和XML文件配置。</strong></p>
</blockquote>
<p>首先，由注解开发的银行转账案例完整版作业：</p>
<pre><code>package com.itheima.dao;

import com.itheima.domain.Account;

import java.util.List;

/**
 * 账户的持久层接口
 */
public interface IAccountDao {

    /**
     * 查询所有
     * @return
     */
    List&lt;Account&gt; findAllAccount();

    /**
     * 查询一个
     * @return
     */
    Account findAccountById(Integer accountId);

    /**
     * 保存
     * @param account
     */
    void saveAccount(Account account);

    /**
     * 更新
     * @param account
     */
    void updateAccount(Account account);

    /**
     * 删除
     * @param acccountId
     */
    void deleteAccount(Integer acccountId);

    /**
     * 根据名称查账户
     * @param accountName   用户名称
     * @return      如果有唯一结果就返回，如果没有结果就返回Null,结果集超过一个返回异常
     */
    Account findAccountByName(String accountName);
}
</code></pre><hr>
<pre><code>package com.itheima.dao.impl;

import com.itheima.dao.IAccountDao;
import com.itheima.domain.Account;
import com.itheima.utils.ConnectionUtils;
import org.apache.commons.dbutils.QueryRunner;
import org.apache.commons.dbutils.handlers.BeanHandler;
import org.apache.commons.dbutils.handlers.BeanListHandler;

import java.util.List;

/**
 * 账户的持久层实现类
 */
public class AccountDaoImpl implements IAccountDao {

    private QueryRunner runner;
    private ConnectionUtils connectionUtils;

    public void setRunner(QueryRunner runner) {
        this.runner = runner;
    }

    public void setConnectionUtils(ConnectionUtils connectionUtils) {
        this.connectionUtils = connectionUtils;
    }

    public List&lt;Account&gt; findAllAccount() {
        try{
            return runner.query(connectionUtils.getThreadConnection(),&quot;select * from account&quot;,new BeanListHandler&lt;Account&gt;(Account.class));
        }catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    public Account findAccountById(Integer accountId) {
        try{
            return runner.query(connectionUtils.getThreadConnection(),&quot;select * from account where id = ? &quot;,new BeanHandler&lt;Account&gt;(Account.class),accountId);
        }catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    public void saveAccount(Account account) {
        try{
            runner.update(connectionUtils.getThreadConnection(),&quot;insert into account(name,money)values(?,?)&quot;,account.getName(),account.getMoney());
        }catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    public void updateAccount(Account account) {
        try{
            runner.update(connectionUtils.getThreadConnection(),&quot;update account set name=?,money=? where id=?&quot;,account.getName(),account.getMoney(),account.getId());
        }catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    public void deleteAccount(Integer accountId) {
        try{
            runner.update(connectionUtils.getThreadConnection(),&quot;delete from account where id=?&quot;,accountId);
        }catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    public Account findAccountByName(String accountName) {
        try{
            List&lt;Account&gt; accounts = runner.query(connectionUtils.getThreadConnection(),&quot;select * from account where name = ? &quot;,new BeanListHandler&lt;Account&gt;(Account.class),accountName);
            if(accounts == null || accounts.size() == 0){
                return null;
            }
            if(accounts.size() &gt; 1){
                throw new RuntimeException(&quot;结果集不唯一，数据有问题&quot;);
            }
            return accounts.get(0);
        }catch (Exception e) {
            throw new RuntimeException(e);
        }
    }
}
</code></pre><hr>
<pre><code>package com.itheima.domain;

import java.io.Serializable;

/**
 * 账户的实体类
 */
public class Account implements Serializable {

    private Integer id;
    private String name;
    private Float money;

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Float getMoney() {
        return money;
    }

    public void setMoney(Float money) {
        this.money = money;
    }

    @Override
    public String toString() {
        return &quot;Account{&quot; +
                &quot;id=&quot; + id +
                &quot;, name=&apos;&quot; + name + &apos;\&apos;&apos; +
                &quot;, money=&quot; + money +
                &apos;}&apos;;
    }
}
</code></pre><hr>
<pre><code>package com.itheima.service;

import com.itheima.domain.Account;

import java.util.List;

/**
 * 账户的业务层接口
 */
public interface IAccountService {

    /**
     * 查询所有
     * @return
     */
    List&lt;Account&gt; findAllAccount();

    /**
     * 查询一个
     * @return
     */
    Account findAccountById(Integer accountId);

    /**
     * 保存
     * @param account
     */
    void saveAccount(Account account);

    /**
     * 更新
     * @param account
     */
    void updateAccount(Account account);

    /**
     * 删除
     * @param acccountId
     */
    void deleteAccount(Integer acccountId);

    /**
     *
     * 转账方法
     * @param sourceName    转出账户名称
     * @param targetName    转入账户名称
     * @param money         转账金额
     */
    void transfer(String sourceName, String targetName, Float money);
}
</code></pre><hr>
<pre><code>package com.itheima.service.impl;

import com.itheima.dao.IAccountDao;
import com.itheima.domain.Account;
import com.itheima.service.IAccountService;
import com.itheima.utils.TransactionManager;

import java.util.List;

/**
 * 账户的业务层实现类
 *
 * 事务控制应该都是在业务层
 */
public class AccountServiceImpl implements IAccountService{

    private IAccountDao accountDao;
    private TransactionManager txManager;

    public void setTxManager(TransactionManager txManager) {
        this.txManager = txManager;
    }

    public void setAccountDao(IAccountDao accountDao) {
        this.accountDao = accountDao;
    }

    @Override
    public List&lt;Account&gt; findAllAccount() {
        try {
            //1.开启事务
            txManager.beginTransaction();
            //2.执行操作
            List&lt;Account&gt; accounts = accountDao.findAllAccount();
            //3.提交事务
            txManager.commit();
            //4.返回结果
            return accounts;
        }catch (Exception e){
            //5.回滚操作
            txManager.rollback();
            throw new RuntimeException(e);
        }finally {
            //6.释放连接
            txManager.release();
        }

    }

    @Override
    public Account findAccountById(Integer accountId) {
        try {
            //1.开启事务
            txManager.beginTransaction();
            //2.执行操作
            Account account = accountDao.findAccountById(accountId);
            //3.提交事务
            txManager.commit();
            //4.返回结果
            return account;
        }catch (Exception e){
            //5.回滚操作
            txManager.rollback();
            throw new RuntimeException(e);
        }finally {
            //6.释放连接
            txManager.release();
        }
    }

    @Override
    public void saveAccount(Account account) {
        try {
            //1.开启事务
            txManager.beginTransaction();
            //2.执行操作
            accountDao.saveAccount(account);
            //3.提交事务
            txManager.commit();
        }catch (Exception e){
            //4.回滚操作
            txManager.rollback();
        }finally {
            //5.释放连接
            txManager.release();
        }

    }

    @Override
    public void updateAccount(Account account) {
        try {
            //1.开启事务
            txManager.beginTransaction();
            //2.执行操作
            accountDao.updateAccount(account);
            //3.提交事务
            txManager.commit();
        }catch (Exception e){
            //4.回滚操作
            txManager.rollback();
        }finally {
            //5.释放连接
            txManager.release();
        }

    }

    @Override
    public void deleteAccount(Integer acccountId) {
        try {
            //1.开启事务
            txManager.beginTransaction();
            //2.执行操作
            accountDao.deleteAccount(acccountId);
            //3.提交事务
            txManager.commit();
        }catch (Exception e){
            //4.回滚操作
            txManager.rollback();
        }finally {
            //5.释放连接
            txManager.release();
        }

    }

    @Override
    public void transfer(String sourceName, String targetName, Float money) {
        try {
            //1.开启事务
            txManager.beginTransaction();
            //2.执行操作

            //2.1根据名称查询转出账户
            Account source = accountDao.findAccountByName(sourceName);
            //2.2根据名称查询转入账户
            Account target = accountDao.findAccountByName(targetName);
            //2.3转出账户减钱
            source.setMoney(source.getMoney()-money);
            //2.4转入账户加钱
            target.setMoney(target.getMoney()+money);
            //2.5更新转出账户
            accountDao.updateAccount(source);

            int i=1/0;

            //2.6更新转入账户
            accountDao.updateAccount(target);
            //3.提交事务
            txManager.commit();

        }catch (Exception e){
            //4.回滚操作
            txManager.rollback();
            e.printStackTrace();
        }finally {
            //5.释放连接
            txManager.release();
        }
    }
}
</code></pre><hr>
<pre><code>package com.itheima.utils;

import javax.sql.DataSource;
import java.sql.Connection;

/**
 * @Description 连接的工具类，用于从数据源中获取一个连接，并且实现和线程的绑定
 * @Author TT Hun
 * @Data 2019/10/3 11:22
 */
public class ConnectionUtils {

    private ThreadLocal&lt;Connection&gt; tl = new ThreadLocal&lt;Connection&gt;();
    private DataSource dataSource;


    public void setDataSource(DataSource dataSource) {
        this.dataSource = dataSource;
    }

    /**
     * 获取当前线程上的链接
     *
     * @return
     */
    public Connection getThreadConnection() {
//        1、先从ThreadLocal上获取
        Connection conn = tl.get();
//        2、判断当前线程上是否有链接
        try {
            if (conn == null) {
//        3、从数据源中获取一个连接，并且存入ThreadLocalz中
                conn = dataSource.getConnection();
                tl.set(conn);
            }
//        4、返回当前线程上的连接
            return conn;
        } catch (Exception e) {
            throw new RuntimeException(&quot;报错了&quot;);
        }
    }

    /**
     * 链接和线程解绑
     */
    public void removeConnection(){
        tl.remove();
    }
}
</code></pre><hr>
<pre><code>package com.itheima.utils;

/**
 * @Description 和事务管理相关的工具类，包含了开启事务，提交事务，回滚事务和释放连接的方法
 * @Author TT Hun
 * @Data 2019/10/3 11:35
 */
public class TransactionManager {

    private ConnectionUtils connectionUtils;

    public void setConnectionUtils(ConnectionUtils connectionUtils) {
        this.connectionUtils = connectionUtils;
    }

    /**
     * 开始事务
     */
    public void beginTransaction() {
        try {
            connectionUtils.getThreadConnection().setAutoCommit(false);
        } catch (Exception e) {
            e.printStackTrace();
        }

    }

    /**
     * 提交事务
     */
    public void commit() {
        try {
            connectionUtils.getThreadConnection().commit();
        } catch (Exception e) {
            e.printStackTrace();
        }

    }

    /**
     * 回滚事务
     */
    public void rollback() {
        try {
            connectionUtils.getThreadConnection().rollback();
        } catch (Exception e) {
            e.printStackTrace();
        }

    }

    /**
     * 释放连接事务
     */
    public void release() {
        try {
//            使用服务器也有一个线程池，当tomcat启动时候，会初始化一大堆线程放到一个容器中
//            每次访问都是线程池中拿出来一个线程给我们使用，调用close方法并不是真正的关闭而是将线程还给线程池
            connectionUtils.getThreadConnection().close();
//            所以想要连接和线程解绑，通过这个方法。
            connectionUtils.removeConnection();
        } catch (Exception e) {
            e.printStackTrace();
        }

    }
}
</code></pre><hr>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;
       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/aop
        http://www.springframework.org/schema/aop/spring-aop.xsd&quot;&gt;

    &lt;!-- 配置Service --&gt;
    &lt;bean id=&quot;accountService&quot; class=&quot;com.itheima.service.impl.AccountServiceImpl&quot;&gt;
        &lt;!-- 注入dao --&gt;
        &lt;property name=&quot;accountDao&quot; ref=&quot;accountDao&quot;&gt;&lt;/property&gt;
    &lt;/bean&gt;

    &lt;!--配置Dao对象--&gt;
    &lt;bean id=&quot;accountDao&quot; class=&quot;com.itheima.dao.impl.AccountDaoImpl&quot;&gt;
        &lt;!-- 注入QueryRunner --&gt;
        &lt;property name=&quot;runner&quot; ref=&quot;runner&quot;&gt;&lt;/property&gt;
&lt;!--        注入ConnectionUtils--&gt;
        &lt;property name=&quot;connectionUtils&quot; ref =&quot;connectionUtils&quot;&gt;&lt;/property&gt;
    &lt;/bean&gt;

    &lt;!--配置QueryRunner--&gt;
    &lt;bean id=&quot;runner&quot; class=&quot;org.apache.commons.dbutils.QueryRunner&quot; scope=&quot;prototype&quot;&gt;
    &lt;/bean&gt;

    &lt;!-- 配置数据源 --&gt;
    &lt;bean id=&quot;dataSource&quot; class=&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;&gt;
        &lt;!--连接数据库的必备信息--&gt;
        &lt;property name=&quot;driverClass&quot; value=&quot;com.mysql.cj.jdbc.Driver&quot;&gt;&lt;/property&gt;
        &lt;property name=&quot;jdbcUrl&quot; value=&quot;jdbc:mysql://localhost:3306/eesy?characterEncoding=utf8&amp;amp;serverTimezone=UTC&amp;amp;useSSL=false&quot;&gt;&lt;/property&gt;
        &lt;property name=&quot;user&quot; value=&quot;root&quot;&gt;&lt;/property&gt;
        &lt;property name=&quot;password&quot; value=&quot;root&quot;&gt;&lt;/property&gt;
    &lt;/bean&gt;

&lt;!--    配置Connection的工具类 ConnectionUtils--&gt;
    &lt;bean id =&quot;connectionUtils&quot; class =&quot;com.itheima.utils.ConnectionUtils&quot;&gt;
&lt;!--        注入数据源--&gt;
        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;&gt;&lt;/property&gt;
    &lt;/bean&gt;

&lt;!--    配置事务管理器--&gt;
    &lt;bean id=&quot;txManager&quot; class=&quot;com.itheima.utils.TransactionManager&quot;&gt;
&lt;!--        注入ConnectionUtils--&gt;
        &lt;property name=&quot;connectionUtils&quot; ref=&quot;connectionUtils&quot;&gt;&lt;/property&gt;
    &lt;/bean&gt;


&lt;!--    配置AOP--&gt;
    &lt;aop:config&gt;
&lt;!--        配置通用的切入点表达式--&gt;
        &lt;aop:pointcut id=&quot;pt1&quot; expression=&quot;execution(* com.itheima.service.impl.*.*(..)))&quot;&gt;&lt;/aop:pointcut&gt;
        &lt;aop:aspect id=&quot;txAdvice&quot; ref=&quot;txManager&quot;&gt;
&lt;!--            配置前置通知，开启事务--&gt;
        &lt;aop:before method=&quot;beginTransaction&quot; pointcut-ref=&quot;pt1&quot;&gt;&lt;/aop:before&gt;
&lt;!--            配置后置通知，提交事务--&gt;
            &lt;aop:after-returning method=&quot;commit&quot; pointcut-ref=&quot;pt1&quot;&gt;&lt;/aop:after-returning&gt;
&lt;!--            配置异常通知，回滚事务--&gt;
            &lt;aop:after-throwing method=&quot;rollback&quot; pointcut-ref=&quot;pt1&quot;&gt;&lt;/aop:after-throwing&gt;
&lt;!--            配置最终通知，释放连接--&gt;
            &lt;aop:after method=&quot;release&quot; pointcut-ref=&quot;pt1&quot;&gt;&lt;/aop:after&gt;
        &lt;/aop:aspect&gt;
    &lt;/aop:config&gt;
&lt;/beans&gt;
</code></pre><hr>
<pre><code>package com.itheima.test;

import com.itheima.domain.Account;
import com.itheima.service.IAccountService;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

import java.util.List;

/**
 * 使用Junit单元测试：测试我们的配置
 */
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = &quot;classpath:bean.xml&quot;)
public class AccountServiceTest {

    @Autowired
    private  IAccountService as;

    @Test
    public void testTransfer(){

        as.transfer(&quot;aaa&quot;,&quot;bbb&quot;,100f);
    }
}
</code></pre><hr>
<hr>
<hr>
<p>下面是基于注解的银行转行范例：</p>
<pre><code>package com.itheima.dao;

import com.itheima.domain.Account;

import java.util.List;

/**
 * 账户的持久层接口
 */
public interface IAccountDao {

    /**
     * 查询所有
     * @return
     */
    List&lt;Account&gt; findAllAccount();

    /**
     * 查询一个
     * @return
     */
    Account findAccountById(Integer accountId);

    /**
     * 保存
     * @param account
     */
    void saveAccount(Account account);

    /**
     * 更新
     * @param account
     */
    void updateAccount(Account account);

    /**
     * 删除
     * @param acccountId
     */
    void deleteAccount(Integer acccountId);

    /**
     * 根据名称查账户
     * @param accountName   用户名称
     * @return      如果有唯一结果就返回，如果没有结果就返回Null,结果集超过一个返回异常
     */
    Account findAccountByName(String accountName);
}
</code></pre><hr>
<pre><code>package com.itheima.dao.impl;

import com.itheima.dao.IAccountDao;
import com.itheima.domain.Account;
import com.itheima.utils.ConnectionUtils;
import org.apache.commons.dbutils.QueryRunner;
import org.apache.commons.dbutils.handlers.BeanHandler;
import org.apache.commons.dbutils.handlers.BeanListHandler;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;

import java.util.List;

/**
 * 账户的持久层实现类
 */
@Repository(&quot;accountDao&quot;)
public class AccountDaoImpl implements IAccountDao {

    @Autowired
    private QueryRunner runner;

    @Autowired
    private ConnectionUtils connectionUtils;


    public List&lt;Account&gt; findAllAccount() {
        try{
            return runner.query(connectionUtils.getThreadConnection(),&quot;select * from account&quot;,new BeanListHandler&lt;Account&gt;(Account.class));
        }catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    public Account findAccountById(Integer accountId) {
        try{
            return runner.query(connectionUtils.getThreadConnection(),&quot;select * from account where id = ? &quot;,new BeanHandler&lt;Account&gt;(Account.class),accountId);
        }catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    public void saveAccount(Account account) {
        try{
            runner.update(connectionUtils.getThreadConnection(),&quot;insert into account(name,money)values(?,?)&quot;,account.getName(),account.getMoney());
        }catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    public void updateAccount(Account account) {
        try{
            runner.update(connectionUtils.getThreadConnection(),&quot;update account set name=?,money=? where id=?&quot;,account.getName(),account.getMoney(),account.getId());
        }catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    public void deleteAccount(Integer accountId) {
        try{
            runner.update(connectionUtils.getThreadConnection(),&quot;delete from account where id=?&quot;,accountId);
        }catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    public Account findAccountByName(String accountName) {
        try{
            List&lt;Account&gt; accounts = runner.query(connectionUtils.getThreadConnection(),&quot;select * from account where name = ? &quot;,new BeanListHandler&lt;Account&gt;(Account.class),accountName);
            if(accounts == null || accounts.size() == 0){
                return null;
            }
            if(accounts.size() &gt; 1){
                throw new RuntimeException(&quot;结果集不唯一，数据有问题&quot;);
            }
            return accounts.get(0);
        }catch (Exception e) {
            throw new RuntimeException(e);
        }
    }
}
</code></pre><hr>
<pre><code>package com.itheima.domain;

import java.io.Serializable;

/**
 * 账户的实体类
 */
public class Account implements Serializable {

    private Integer id;
    private String name;
    private Float money;

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Float getMoney() {
        return money;
    }

    public void setMoney(Float money) {
        this.money = money;
    }

    @Override
    public String toString() {
        return &quot;Account{&quot; +
                &quot;id=&quot; + id +
                &quot;, name=&apos;&quot; + name + &apos;\&apos;&apos; +
                &quot;, money=&quot; + money +
                &apos;}&apos;;
    }
}
</code></pre><hr>
<pre><code>package com.itheima.service;

import com.itheima.domain.Account;

import java.util.List;

/**
 * 账户的业务层接口
 */
public interface IAccountService {

    /**
     * 查询所有
     * @return
     */
    List&lt;Account&gt; findAllAccount();

    /**
     * 查询一个
     * @return
     */
    Account findAccountById(Integer accountId);

    /**
     * 保存
     * @param account
     */
    void saveAccount(Account account);

    /**
     * 更新
     * @param account
     */
    void updateAccount(Account account);

    /**
     * 删除
     * @param acccountId
     */
    void deleteAccount(Integer acccountId);

    /**
     *
     * 转账方法
     * @param sourceName    转出账户名称
     * @param targetName    转入账户名称
     * @param money         转账金额
     */
    void transfer(String sourceName, String targetName, Float money);


}
</code></pre><hr>
<pre><code>package com.itheima.service.impl;

import com.itheima.dao.IAccountDao;
import com.itheima.domain.Account;
import com.itheima.service.IAccountService;
import com.itheima.utils.TransactionManager;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.List;

/**
 * 账户的业务层实现类
 *
 * 事务控制应该都是在业务层
 */
@Service(&quot;accountService&quot;)
public class AccountServiceImpl implements IAccountService{

    @Autowired//dao自动按照类型注入
    private IAccountDao accountDao;
    @Autowired
    private TransactionManager txManager;


    public List&lt;Account&gt; findAllAccount() {
        try {
            //1.开启事务
            txManager.beginTransaction();
            //2.执行操作
            List&lt;Account&gt; accounts = accountDao.findAllAccount();
            //3.提交事务
            txManager.commit();
            //4.返回结果
            return accounts;
        }catch (Exception e){
            //5.回滚操作
            txManager.rollback();
            throw new RuntimeException(e);
        }finally {
            //6.释放连接
            txManager.release();
        }

    }

    @Override
    public Account findAccountById(Integer accountId) {
        try {
            //1.开启事务
            txManager.beginTransaction();
            //2.执行操作
            Account account = accountDao.findAccountById(accountId);
            //3.提交事务
            txManager.commit();
            //4.返回结果
            return account;
        }catch (Exception e){
            //5.回滚操作
            txManager.rollback();
            throw new RuntimeException(e);
        }finally {
            //6.释放连接
            txManager.release();
        }
    }

    @Override
    public void saveAccount(Account account) {
        try {
            //1.开启事务
            txManager.beginTransaction();
            //2.执行操作
            accountDao.saveAccount(account);
            //3.提交事务
            txManager.commit();
        }catch (Exception e){
            //4.回滚操作
            txManager.rollback();
        }finally {
            //5.释放连接
            txManager.release();
        }

    }

    @Override
    public void updateAccount(Account account) {
        try {
            //1.开启事务
            txManager.beginTransaction();
            //2.执行操作
            accountDao.updateAccount(account);
            //3.提交事务
            txManager.commit();
        }catch (Exception e){
            //4.回滚操作
            txManager.rollback();
        }finally {
            //5.释放连接
            txManager.release();
        }

    }

    @Override
    public void deleteAccount(Integer acccountId) {
        try {
            //1.开启事务
            txManager.beginTransaction();
            //2.执行操作
            accountDao.deleteAccount(acccountId);
            //3.提交事务
            txManager.commit();
        }catch (Exception e){
            //4.回滚操作
            txManager.rollback();
        }finally {
            //5.释放连接
            txManager.release();
        }

    }

    @Override
    public void transfer(String sourceName, String targetName, Float money) {
        try {
            //1.开启事务
            txManager.beginTransaction();
            //2.执行操作

            //2.1根据名称查询转出账户
            Account source = accountDao.findAccountByName(sourceName);
            //2.2根据名称查询转入账户
            Account target = accountDao.findAccountByName(targetName);
            //2.3转出账户减钱
            source.setMoney(source.getMoney()-money);
            //2.4转入账户加钱
            target.setMoney(target.getMoney()+money);
            //2.5更新转出账户
            accountDao.updateAccount(source);

//            int i=1/0;

            //2.6更新转入账户
            accountDao.updateAccount(target);
            //3.提交事务
            txManager.commit();

        }catch (Exception e){
            //4.回滚操作
            txManager.rollback();
            e.printStackTrace();
        }finally {
            //5.释放连接
            txManager.release();
        }


    }
}
</code></pre><hr>
<pre><code>package com.itheima.utils;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import javax.sql.DataSource;
import java.sql.Connection;

/**
 * @Description 连接的工具类，用于从数据源中获取一个连接，并且实现和线程的绑定
 * @Author TT Hun
 * @Data 2019/10/3 11:22
 */

@Component(&quot;connectionUtils&quot;)
public class ConnectionUtils {
    private ThreadLocal&lt;Connection&gt; tl = new ThreadLocal&lt;Connection&gt;();
    @Autowired
    private DataSource dataSource;



    public void setDataSource(DataSource dataSource) {
        this.dataSource = dataSource;
    }

    /**
     * 获取当前线程上的链接
     *
     * @return
     */
    public Connection getThreadConnection() {
//        1、先从ThreadLocal上获取
        Connection conn = tl.get();
//        2、判断当前线程上是否有链接
        try {
            if (conn == null) {
//        3、从数据源中获取一个连接，并且存入ThreadLocalz中
                conn = dataSource.getConnection();
                tl.set(conn);
            }
//        4、返回当前线程上的连接
            return conn;
        } catch (Exception e) {
            throw new RuntimeException(&quot;报错了&quot;);
        }
    }

    /**
     * 链接和线程解绑
     */
    public void removeConnection() {
        tl.remove();
    }
}
</code></pre><hr>
<pre><code>package com.itheima.utils;

import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.*;
import org.junit.AfterClass;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import javax.management.relation.RoleUnresolved;

/**
 * @Description 和事务管理相关的工具类，包含了开启事务，提交事务，回滚事务和释放连接的方法
 * @Author TT Hun
 * @Data 2019/10/3 11:35
 */
@Component(&quot;txManager&quot;)
@Aspect//配置切面，表示当前类是一个切面类
public class TransactionManager {

    @Autowired
    private ConnectionUtils connectionUtils;

    @Pointcut(&quot;execution(* com.itheima.service.impl.*.*(..))&quot;)//切入点表达式
    private void pt1(){}
    /**
     * 开始事务
     */
//    @Before(&quot;pt1()&quot;)不写这个因为配置注解开发会导致首先出发before然后出发release最后出发commit
    public void beginTransaction() {
        try {
            connectionUtils.getThreadConnection().setAutoCommit(false);
        } catch (Exception e) {
            e.printStackTrace();
        }

    }

    /**
     * 提交事务
     */
//    @AfterReturning(&quot;pt1()&quot;)不写这个因为配置注解开发会导致首先出发before然后出发release最后出发commit
    public void commit() {
        try {
            connectionUtils.getThreadConnection().commit();
        } catch (Exception e) {
            e.printStackTrace();
        }

    }

    /**
     * 回滚事务
     */
//    @AfterReturning(&quot;pt1()&quot;)不写这个因为配置注解开发会导致首先出发before然后出发release最后出发commit
    public void rollback() {
        try {
            connectionUtils.getThreadConnection().rollback();
        } catch (Exception e) {
            e.printStackTrace();
        }

    }

    /**
     * 释放连接事务
     */
//    @After(&quot;pt1()&quot;)不写这个因为配置注解开发会导致首先出发before然后出发release最后出发commit
    public void release() {
        try {
//            使用服务器也有一个线程池，当tomcat启动时候，会初始化一大堆线程放到一个容器中
//            每次访问都是线程池中拿出来一个线程给我们使用，调用close方法并不是真正的关闭而是将线程还给线程池
            connectionUtils.getThreadConnection().close();
//            所以想要连接和线程解绑，通过这个方法。
            connectionUtils.removeConnection();
        } catch (Exception e) {
            e.printStackTrace();
        }

    }

    @Around(&quot;pt1()&quot;)
    public Object aroundAdvice(ProceedingJoinPoint pjp){
        Object rtValue = null;
        try{
//           1、获取参数
           Object[] args = pjp.getArgs();
//           2、开启事务
            this.beginTransaction();
//           3、执行方法
            rtValue = pjp.proceed(args);
//            4、提交事务
            this.commit();
//            5、返回结果
            return rtValue;
        }catch(Throwable e){
//            回滚事务
            this.rollback();
            throw new RuntimeException(e);
        }
        finally{
//           释放资源
            this.release();

        }
    }
}
</code></pre><hr>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;
       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/aop
        http://www.springframework.org/schema/aop/spring-aop.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;


&lt;!--    配置Spring创建容器时需要扫描的包--&gt;
    &lt;context:component-scan base-package=&quot;com.itheima&quot;&gt;&lt;/context:component-scan&gt;

    &lt;!--配置QueryRunner--&gt;
    &lt;bean id=&quot;runner&quot; class=&quot;org.apache.commons.dbutils.QueryRunner&quot; scope=&quot;prototype&quot;&gt;
    &lt;/bean&gt;

    &lt;!-- 配置数据源 --&gt;
    &lt;bean id=&quot;dataSource&quot; class=&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;&gt;
        &lt;!--连接数据库的必备信息--&gt;
        &lt;property name=&quot;driverClass&quot; value=&quot;com.mysql.cj.jdbc.Driver&quot;&gt;&lt;/property&gt;
        &lt;property name=&quot;jdbcUrl&quot; value=&quot;jdbc:mysql://localhost:3306/eesy?characterEncoding=utf8&amp;amp;serverTimezone=UTC&amp;amp;useSSL=false&quot;&gt;&lt;/property&gt;
        &lt;property name=&quot;user&quot; value=&quot;root&quot;&gt;&lt;/property&gt;
        &lt;property name=&quot;password&quot; value=&quot;root&quot;&gt;&lt;/property&gt;
    &lt;/bean&gt;

&lt;!--开启Spring对注解AOP的支持--&gt;
    &lt;aop:aspectj-autoproxy&gt;&lt;/aop:aspectj-autoproxy&gt;
&lt;/beans&gt;
</code></pre><hr>
<pre><code>package com.itheima.test;

        import com.itheima.domain.Account;
        import com.itheima.service.IAccountService;
        import org.junit.Test;
        import org.junit.runner.RunWith;
        import org.springframework.beans.factory.annotation.Autowired;
        import org.springframework.beans.factory.annotation.Qualifier;
        import org.springframework.test.context.ContextConfiguration;
        import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

        import java.util.List;

/**
 * 使用Junit单元测试：测试我们的配置
 */
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = &quot;classpath:bean.xml&quot;)
public class AccountServiceTest {

    @Autowired
    private  IAccountService as;

    @Test
    public void testTransfer(){

        as.transfer(&quot;aaa&quot;,&quot;bbb&quot;,100f);
    }
}
</code></pre><hr>
<hr>
<hr>
<p>在注解配置银行案例的情况下，有一个小问题就是Spring容器自己配置事务的时候会有一个BUG，就是他会首先执行1、connect 2、release3、提交。所以通过配置环绕注解来解决这个问题，环绕注解也就是注解都是自己配置的。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/touxiang.jpg"
                alt="Eric Hunn" />
            
              <p class="site-author-name" itemprop="name">Eric Hunn</p>
              <p class="site-description motion-element" itemprop="description">大数据|动漫迷|科技控</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">82</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">17</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">116</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/erichunn" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:erichunn.me@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/u/2944687303/home?wvr=5" target="_blank" title="Webibo">
                      
                        <i class="fa fa-fw fa-weibo"></i>Webibo</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://github.com/drakeet/" title="Drakeet" target="_blank">Drakeet</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      
	  
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1311545319&auto=1&height=66"></iframe>

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Eric Hunn</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
